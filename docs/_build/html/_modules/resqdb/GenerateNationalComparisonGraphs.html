
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>resqdb.GenerateNationalComparisonGraphs &#8212; RES-Q package January, 2019 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for resqdb.GenerateNationalComparisonGraphs</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">File name: GenerateNationalComparisonGraphs.py</span>
<span class="sd">Package: resq</span>
<span class="sd">Written by: Marie Jankujova - jankujova.marie@fnusa.cz on 02-2019</span>
<span class="sd">Version: v1.0</span>
<span class="sd">Version comment: The first version of script which create national comaprison reports. </span>
<span class="sd">Description: This script is used to call class GenerateGraphs and produce graphs into presentation. </span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">date</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>

<span class="kn">from</span> <span class="nn">resqdb.GenerateGraphs</span> <span class="k">import</span> <span class="n">GenerateGraphs</span>
<span class="kn">from</span> <span class="nn">resqdb.GenerateComparisonPresentation</span> <span class="k">import</span> <span class="n">GenerateYearsCompGraphs</span>

<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="kn">from</span> <span class="nn">pptx</span> <span class="k">import</span> <span class="n">Presentation</span>
<span class="kn">from</span> <span class="nn">pptx.util</span> <span class="k">import</span> <span class="n">Cm</span><span class="p">,</span> <span class="n">Pt</span><span class="p">,</span> <span class="n">Inches</span>
<span class="kn">from</span> <span class="nn">pptx.dml.color</span> <span class="k">import</span> <span class="n">RGBColor</span>

<span class="kn">import</span> <span class="nn">pytz</span>


<div class="viewcode-block" id="GenerateNationalComparisonGraphs"><a class="viewcode-back" href="../../source/resqdb.html#resqdb.GenerateNationalComparisonGraphs.GenerateNationalComparisonGraphs">[docs]</a><span class="k">class</span> <span class="nc">GenerateNationalComparisonGraphs</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; The class generating the presentation with graphs for national comparison reports. </span>

<span class="sd">    :param df: the dataframe with calculated statistic for the period of time</span>
<span class="sd">    :type df: pandas dataframe</span>
<span class="sd">    :param fdf: the dataframe with calculated comparison statistics eg. 2016, 2017, 2018, etc.</span>
<span class="sd">    :type fdf: pandas dataframe</span>
<span class="sd">    :param outcome: the dataframe with outcome results (default: None)</span>
<span class="sd">    :type outcome: pandas dataframe</span>
<span class="sd">    :param country: `True` if country should be included in the results as site</span>
<span class="sd">    :type country: bool</span>
<span class="sd">    :param country_code: the country code (default: None)</span>
<span class="sd">    :type country_code: str</span>
<span class="sd">    :param split_sites: `True` if graphs for each site should be generated seperately</span>
<span class="sd">    :type split_sites: bool</span>
<span class="sd">    :param site: the site ID</span>
<span class="sd">    :type site: str</span>
<span class="sd">    :param report: the type of the report eg. quarter</span>
<span class="sd">    :type report: str</span>
<span class="sd">    :param quarter: the type of the period eg. Q1_2019</span>
<span class="sd">    :type quarter: str</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">fdf</span><span class="p">,</span> <span class="n">outcome</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">country_code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">split_sites</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quarter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fdf</span> <span class="o">=</span> <span class="n">fdf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">country_code</span> <span class="o">=</span> <span class="n">country_code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">=</span> <span class="n">report</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="o">=</span> <span class="n">quarter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outcome</span> <span class="o">=</span> <span class="n">outcome</span>

        <span class="c1"># Get absolute path to the database.</span>
        <span class="n">script_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>

        <span class="n">master_pptx</span> <span class="o">=</span> <span class="s2">&quot;master.pptx&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_dir</span><span class="p">,</span> <span class="s2">&quot;backgrounds&quot;</span><span class="p">,</span> <span class="n">master_pptx</span><span class="p">))</span>

        <span class="c1"># Connect to database and get country name according to country code.</span>
        <span class="k">def</span> <span class="nf">select_country</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; The function obtaining the name of country from the package pytz based on the country code. </span>

<span class="sd">            :param value: the country code</span>
<span class="sd">            :type value: str</span>
<span class="sd">            :returns: the country name</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">country_name</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">country_names</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">country_name</span>

        <span class="c1"># If country is used as site, the country name is selected from countries dictionary by country code. :) </span>
        <span class="k">if</span> <span class="p">(</span><span class="n">country</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span> <span class="o">=</span> <span class="n">select_country</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">country_code</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># If split_sites is True, then go through dataframe and generate graphs for each site (the country will be included as site in each file).</span>
        <span class="n">site_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Site ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="c1"># Delete country name from side ids list.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">site_ids</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        
        <span class="k">if</span> <span class="n">site</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Site ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">site</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">])]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_generate_graphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">site_code</span><span class="o">=</span><span class="n">site</span><span class="p">)</span>

        <span class="c1"># Generate formatted statistics for all sites individualy + country as site is included</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">split_sites</span><span class="p">)</span> <span class="ow">and</span> <span class="n">site</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">site_ids</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Site ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">])]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_generate_graphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">site_code</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    
        <span class="c1"># Produce formatted statistics for all sites + country as site</span>
        <span class="k">if</span> <span class="n">site</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">outcome</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_generate_graphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">fdf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fdf</span><span class="p">,</span> <span class="n">outcome</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">outcome</span><span class="p">,</span> <span class="n">site_code</span><span class="o">=</span><span class="n">country_code</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_generate_graphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">fdf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fdf</span><span class="p">,</span> <span class="n">site_code</span><span class="o">=</span><span class="n">country_code</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_generate_graphs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">fdf</span><span class="p">,</span> <span class="n">outcome</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">site_code</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The function generating the graph in the presentation. </span>
<span class="sd">        </span>
<span class="sd">        :param df: the dataframe containing the general statistics for country</span>
<span class="sd">        :type df: pandas dataframe</span>
<span class="sd">        :param fdf: the dataframe containing the general statistics for country through period in each year</span>
<span class="sd">        :type fdf: pandas dataframe</span>
<span class="sd">        :param outcome: the outcome dataframe containing outcome information for the given period</span>
<span class="sd">        :type outcome: pandas dataframe</span>
<span class="sd">        :param site_code: the site ID</span>
<span class="sd">        :type site_code: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">prs</span> <span class="o">=</span> <span class="n">Presentation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>

        <span class="n">first_slide</span> <span class="o">=</span> <span class="n">prs</span><span class="o">.</span><span class="n">slides</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">first_slide</span><span class="o">.</span><span class="n">shapes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">text_frame</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">text_frame</span>

        <span class="c1">#first_slide_text = self.country_name + &quot;\nData Summary&quot;</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>   
            <span class="n">first_slide_text</span> <span class="o">=</span> <span class="s2">&quot;Přehled dat</span><span class="se">\n</span><span class="s2">Česká republika</span><span class="se">\n</span><span class="s2">2019&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">first_slide_text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Summary&quot;</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">run</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
        <span class="n">run</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">first_slide_text</span>

        <span class="n">font</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">font</span>
        <span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Century Gothic&#39;</span>
        <span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span>
        <span class="n">font</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span><span class="mi">250</span><span class="p">,</span><span class="mi">250</span><span class="p">)</span>

        <span class="c1"># if (self.country_name in [&#39;Ukraine&#39;, &#39;Poland&#39;] and len(df) &gt; 2):</span>
        <span class="c1">#     main_col = &#39;Site ID&#39;</span>
        <span class="c1"># else:</span>
        <span class="n">main_col</span> <span class="o">=</span> <span class="s1">&#39;Site Name&#39;</span>

        <span class="n">years</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdf</span><span class="p">[</span><span class="n">main_col</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">comp_title</span> <span class="o">=</span> <span class="s2">&quot;Dočasné trendy - </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">comp_title</span> <span class="o">=</span> <span class="s2">&quot;Temporal trends - </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>

        <span class="c1">########################</span>
        <span class="c1">#### TOTAL PATIENTS ####</span>
        <span class="c1">########################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Total Patients&#39;</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">country_patients</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">tmp_df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Celkový počet pacientů (n = </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">country_patients</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;TOTAL PATIENTS (n = </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">country_patients</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tmp_df</span><span class="p">[</span><span class="n">main_col</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">]</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">##########################</span>
        <span class="c1">### MEDIAN PATIENT AGE ###</span>
        <span class="c1">##########################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median patient age&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Věk pacientů - medián&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MEDIAN PATIENT AGE&quot;</span>
        

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">###################</span>
        <span class="c1">## OUTCOME table ##</span>
        <span class="c1">###################</span>
        <span class="k">if</span> <span class="n">outcome</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">slide</span> <span class="o">=</span> <span class="n">prs</span><span class="o">.</span><span class="n">slides</span><span class="o">.</span><span class="n">add_slide</span><span class="p">(</span><span class="n">prs</span><span class="o">.</span><span class="n">slide_layouts</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span>
            <span class="n">title_placeholders</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">title</span>
            <span class="n">title_placeholders</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;VÝSLEDKY PODLE SKUPIN PACIENTŮ&quot;</span>

            <span class="c1"># table_placeholder = slide.shapes[1]</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">Inches</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Inches</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Inches</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">Inches</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">)</span>
            <span class="n">table</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span>

            <span class="c1"># table = shape.table</span>
            <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">outcome</span><span class="p">[[</span><span class="s1">&#39;Patient Group&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;Median discharge mRS&#39;</span><span class="p">]]</span>


            <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Patient Group&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;Median discharge mRS&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)):</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)):</span>
                    <span class="n">cell</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>


        <span class="c1">#######################################</span>
        <span class="c1">#### Outcome for group of patients ####</span>
        <span class="c1">#######################################</span>
        <span class="k">if</span> <span class="n">outcome</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">graph_types</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
                <span class="c1">#title = &quot;VÝSLEDKY PODLE SKUPIN TYPU LÉČBY&quot;</span>
                <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;VÝSLEDKY PODLE SKUPIN TYPU PACIENTŮ&quot;</span>
                <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;domů&#39;</span><span class="p">,</span> <span class="s1">&#39;překlad v rámci stejného zdravotnického zařízení (ZZ)&#39;</span><span class="p">,</span> <span class="s1">&#39;překlad do jiného zdravotnického zařízení (ZZ)&#39;</span><span class="p">,</span> <span class="s1">&#39;zařízení sociální péče&#39;</span><span class="p">,</span> <span class="s1">&#39;zemřel/a&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Results for outcome groups&quot;</span>
                <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">% ho</span><span class="s1">me&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred within the same centre&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred to another centre&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">ocial care facility&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ead&#39;</span><span class="p">]</span>
            <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
            <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;stacked&quot;</span><span class="p">)</span>

            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            tmp = outcome.loc[outcome[&#39;Patient Group&#39;].isin([&#39;IV tPA&#39;, &#39;IV tPA + TBY&#39;, &#39;TBY&#39;])]</span>
<span class="sd">            df1 = tmp[[&#39;Patient Group&#39;, &#39;% home&#39;, &#39;% transferred within the same centre&#39;, &#39;% transferred to another centre&#39;, &#39;% social care facility&#39;, &#39;% dead&#39;]]</span>

<span class="sd">            GenerateYearsCompGraphs(df=df1, presentation=prs, title=title, titles=[&quot;&quot;], graph_types=graph_types, legends=legends, outcome=True)</span>

<span class="sd">            titles = []</span>
<span class="sd">            graph_types = []</span>
<span class="sd">            legends = []</span>
<span class="sd">            </span>
<span class="sd">            </span>
<span class="sd">            if site_code == &#39;CZ&#39;:</span>
<span class="sd">                title = &quot;VÝSLEDKY PODLE SKUPIN TYPU CMP&quot;</span>
<span class="sd">                legend = [&#39;domů&#39;, &#39;překlad v rámci stejného zdravotnického zařízení (ZZ)&#39;, &#39;překlad do jiného zdravotnického zařízení (ZZ)&#39;, &#39;zařízení sociální péče&#39;, &#39;zemřel/a&#39;]</span>
<span class="sd">            else:</span>
<span class="sd">                title = &quot;Results for outcome gruops&quot;</span>
<span class="sd">                legend = [&#39;% home&#39;, &#39;% transferred within the same centre&#39;, &#39;% transferred to another centre&#39;, &#39;% social care facility&#39;, &#39;% dead&#39;]</span>
<span class="sd">            legends.append(legend)</span>
<span class="sd">            graph_types.append(&quot;stacked&quot;)</span>

<span class="sd">            tmp = outcome.loc[outcome[&#39;Patient Group&#39;].isin([&#39;iCMP&#39;, &#39;ICH&#39;, &#39;SAK&#39;])]</span>
<span class="sd">            df1 = tmp[[&#39;Patient Group&#39;, &#39;% home&#39;, &#39;% transferred within the same centre&#39;, &#39;% transferred to another centre&#39;, &#39;% social care facility&#39;, &#39;% dead&#39;]]</span>

<span class="sd">            GenerateYearsCompGraphs(df=df1, presentation=prs, title=title, titles=[&quot;&quot;], graph_types=graph_types, legends=legends, outcome=True)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">outcome_df</span> <span class="o">=</span> <span class="n">outcome</span><span class="p">[[</span><span class="s1">&#39;Patient Group&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% ho</span><span class="s1">me&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred within the same centre&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred to another centre&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">ocial care facility&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ead&#39;</span><span class="p">]]</span>
            <span class="n">GenerateYearsCompGraphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">outcome_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">],</span> <span class="n">graph_types</span><span class="o">=</span><span class="n">graph_types</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="n">legends</span><span class="p">,</span> <span class="n">outcome</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


        <span class="c1">####################################</span>
        <span class="c1">#### Outcome per patients group ####</span>
        <span class="c1">####################################</span>
        
        <span class="c1">#### Comparison graphs for trends per years - total patients and median patient age</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">graph_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Total patients and median age graphst)</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Total Patients&#39;</span>
        <span class="n">df1</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Celkem pacientů&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Total Patients&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median patient age&#39;</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Věk pacientů - medián&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Median patient age&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>
        
        <span class="n">GenerateYearsCompGraphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">df1</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">comp_title</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="n">titles</span><span class="p">,</span> <span class="n">graph_types</span><span class="o">=</span><span class="n">graph_types</span><span class="p">)</span>

        <span class="c1">###########################</span>
        <span class="c1">### GENDER DISTRIBUTION ###</span>
        <span class="c1">###########################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients female&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Žena&#39;</span><span class="p">,</span> <span class="s1">&#39;Muž&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% patients female&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients male&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Rozdělení podle pohlaví&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;GENDER DISTRIBUTION&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">#######################</span>
        <span class="c1">### DEPARTMENT TYPE ###</span>
        <span class="c1">#######################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - neurology&#39;</span>
        
        <span class="c1">#</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - neurology&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - neurosurgery&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - anesthesiology/resuscitation/critical care&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - internal medicine&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - geriatrics&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - Other&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;ODDĚLENÍ, KDE BYL PACIENT HOSPITALIZOVÁN (%)&#39;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;neurologie&#39;</span><span class="p">,</span> <span class="s1">&#39;neurochirurgie&#39;</span><span class="p">,</span> <span class="s1">&#39;ARO&#39;</span><span class="p">,</span> <span class="s1">&#39;interna&#39;</span><span class="p">,</span> <span class="s1">&#39;geriatrie&#39;</span><span class="p">,</span> <span class="s1">&#39;ostatní&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% DEPARTMENT TYPE ALLOCATION out of all cases&quot;</span> 
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;neurology&#39;</span><span class="p">,</span> <span class="s1">&#39;neurosurgery&#39;</span><span class="p">,</span> <span class="s1">&#39;anesthesiology resuscitation critical care&#39;</span><span class="p">,</span> <span class="s1">&#39;internal medicine&#39;</span><span class="p">,</span> <span class="s1">&#39;geriatrics&#39;</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">]</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>


        <span class="c1">###################################</span>
        <span class="c1">### HOSPITALIZATION DESTINATION ###</span>
        <span class="c1">###################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients hospitalized in stroke unit / ICU&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in stroke unit / ICU&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in monitored bed with telemetry&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in standard bed&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;TYP LŮŽKA, NA KTERÉM BYL PACIENT HOSPITALIZOVÁN (%)&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;JIP &#39;</span><span class="p">,</span> <span class="s1">&#39;jiné monitorované lůžko (telemetrie)&#39;</span><span class="p">,</span> <span class="s1">&#39;standardní lůžko&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% HOSPITALIZATION DESTINATION out of all cases&quot;</span> 
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;stroke unit&#39;</span><span class="p">,</span> <span class="s1">&#39;monitored bed with telemetry&#39;</span><span class="p">,</span> <span class="s1">&#39;standard bed&#39;</span><span class="p">]</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">################</span>
        <span class="c1"># COMPARISON ###</span>
        <span class="c1">################</span>
        <span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">graph_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">### DEPARTMENT TYPE ###</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Typ oddělení (%)&quot;</span><span class="p">)</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;neurologie&#39;</span><span class="p">,</span> <span class="s1">&#39;neurochirurgie&#39;</span><span class="p">,</span> <span class="s1">&#39;ARO&#39;</span><span class="p">,</span> <span class="s1">&#39;interna&#39;</span><span class="p">,</span> <span class="s1">&#39;geriatrie&#39;</span><span class="p">,</span> <span class="s1">&#39;ostatní&#39;</span><span class="p">]</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Department type (%)&quot;</span><span class="p">)</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;neurology&#39;</span><span class="p">,</span> <span class="s1">&#39;neurosurgery&#39;</span><span class="p">,</span> <span class="s1">&#39;anesthesiology resuscitation critical care&#39;</span><span class="p">,</span> <span class="s1">&#39;internal medicine&#39;</span><span class="p">,</span> <span class="s1">&#39;geriatrics&#39;</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;stacked&quot;</span><span class="p">)</span>

        <span class="n">df1</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - neurology&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - neurosurgery&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - anesthesiology/resuscitation/critical care&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - internal medicine&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - geriatrics&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - Other&#39;</span><span class="p">]]</span>

        <span class="c1">### HOSPITALIZATION DESTINATION ###</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Typ hospitalizace (%)&quot;</span><span class="p">)</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;JIP &#39;</span><span class="p">,</span> <span class="s1">&#39;jiné monitorované lůžko (telemetrie)&#39;</span><span class="p">,</span> <span class="s1">&#39;standardní lůžko&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Hospitalization type (%)&quot;</span><span class="p">)</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;stroke unit&#39;</span><span class="p">,</span> <span class="s1">&#39;monitored bed with telemetry&#39;</span><span class="p">,</span> <span class="s1">&#39;standard bed&#39;</span><span class="p">]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;stacked&quot;</span><span class="p">)</span>

        <span class="n">df2</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in stroke unit / ICU&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in monitored bed with telemetry&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in standard bed&#39;</span><span class="p">]]</span>
   
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        ### REHABILIATION ###</span>
<span class="sd">        column_name = &#39;% patients assessed for rehabilitation - Yes&#39;</span>
<span class="sd">        df3 = fdf[[main_col, column_name]]</span>
<span class="sd">        legend = []</span>
<span class="sd">        legends.append(legend)</span>
<span class="sd">        if site_code == &#39;CZ&#39;:</span>
<span class="sd">            titles.append(&quot;Vyšetřena fyzioterapeutem (%)&quot;)</span>
<span class="sd">        else:</span>
<span class="sd">            titles.append(&quot;Assessed for rehabilitation (%)&quot;)</span>
<span class="sd">        graph_types.append(&quot;normal&quot;)</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">GenerateYearsCompGraphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">df1</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">comp_title</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="n">titles</span><span class="p">,</span> <span class="n">graph_types</span><span class="o">=</span><span class="n">graph_types</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="n">legends</span><span class="p">)</span>

        <span class="c1">###############</span>
        <span class="c1"># STROKE TYPE #</span>
        <span class="c1">###############</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - ischemic stroke&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - ischemic stroke&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - transient ischemic attack&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - intracerebral hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - subarrachnoid hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - cerebral venous thrombosis&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - undetermined stroke&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;TYP CMP ze všech případů (%)&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ischemická CMP&#39;</span><span class="p">,</span> <span class="s1">&#39;tranzitorní ischemická ataka - TIA&#39;</span><span class="p">,</span> <span class="s1">&#39;intracerebrální krvácení&#39;</span><span class="p">,</span> <span class="s1">&#39;subarachnoidální krvácení&#39;</span><span class="p">,</span> <span class="s1">&#39;mozková žilní trombóza&#39;</span><span class="p">,</span> <span class="s1">&#39;neurčená&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% STROKE TYPE out of all cases&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ischemic&#39;</span><span class="p">,</span> <span class="s1">&#39;transient ischemic attack&#39;</span><span class="p">,</span> <span class="s1">&#39;intracerebral hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;subarrachnoid hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;cerebral venous thrombosis&#39;</span><span class="p">,</span> <span class="s1">&#39;undetermined&#39;</span><span class="p">]</span>


        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">######################</span>
        <span class="c1"># CONSIOUSNESS LEVEL #</span>
        <span class="c1">######################</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        column_name = &#39;alert_all_perc&#39;</span>
<span class="sd">        legend = [&#39;alert&#39;, &#39;drowsy&#39;, &#39;comatose&#39;]</span>

<span class="sd">        tmp_df = df[[main_col, &#39;alert_all_perc&#39;, &#39;drowsy_all_perc&#39;, &#39;comatose_all_perc&#39;]]</span>
<span class="sd">        tmp_df = tmp_df.sort_values([column_name], ascending = True)</span>

<span class="sd">        if site_code == &#39;CZ&#39;:</span>
<span class="sd">            title = &quot;% STUPEŇ VĚDOMÍ u iCMP, ICH, CVT, SAK&quot;</span>
<span class="sd">        else:</span>
<span class="sd">            title = &quot;% CONSCIOUSNESS LEVEL for IS, ICH, CVT, SAH&quot;</span>

<span class="sd">        GenerateGraphs(dataframe=tmp_df, presentation=prs, title=title, column_name=column_name, country=self.country_name, legend=legend, number_of_series=len(legend), graph_type=&#39;stacked&#39;)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1">###################</span>
        <span class="c1"># NIHSS PERFORMED #</span>
        <span class="c1">###################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% NIHSS - Performed&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="c1">#title = &quot;% pacientů s iCMP, ICH nebo CVT, u nichž bylo provedeno NIHSS&quot;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% pacientů s iCMP nebo ICH, u nichž bylo provedeno NIHSS&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% NIHSS PERFORMED for IS, ICH, CVT&quot;</span>
            
            

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">######################</span>
        <span class="c1"># NIHSS MEDIAN SCORE #</span>
        <span class="c1">######################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;NIHSS median score&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;NIHSS SKÓRE - medián&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;NIHSS median score&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">####################</span>
        <span class="c1"># CT/MRI performed #</span>
        <span class="c1">####################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% CT/MRI - performed&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% pacientů s iCMP, ICH, CVT nebo TIA, kterým bylo provedeno CT/MRI&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% CT/MRI PERFORMED for IS, ICH, CVT, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">##################################</span>
        <span class="c1"># CT/MRI PERFORMED WITHIN 1 HOUR #</span>
        <span class="c1">##################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% CT/MRI - Performed within 1 hour after admission&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% CT/MRI provedených DO HODINY OD PŘIJETÍ u iCMP, ICH, CVT nebo TIA &quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% CT/MRI PERFORMED WITHIN 1 HOUR AFTER ADMISSION for IS, ICH, CVT, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">####################</span>
        <span class="c1"># VASCULAR IMAGING #</span>
        <span class="c1">####################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;vascular_imaging_cta_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vascular_imaging_mra_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vascular_imaging_dsa_norm&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;vascular_imaging_cta_norm&#39;</span>
        <span class="c1">#legend = [&#39;CTA&#39;, &#39;MRA&#39;, &#39;DSA&#39;, &#39;none&#39;]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CTA&#39;</span><span class="p">,</span> <span class="s1">&#39;MRA&#39;</span><span class="p">,</span> <span class="s1">&#39;DSA&#39;</span><span class="p">]</span>

        <span class="c1">#tmp_df = df[[main_col, &#39;vascular_imaging_cta_norm&#39;, &#39;vascular_imaging_mra_norm&#39;, &#39;vascular_imaging_dsa_norm&#39;, &#39;vascular_imaging_none_norm&#39;]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;vascular_imaging_cta_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vascular_imaging_mra_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vascular_imaging_dsa_norm&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% VASKULÁRNÍCH ZOBRAZOVÁNÍ provedených u ICH nebo SAK&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% VASCULAR IMAGING PERFORMED for ICH, SAH&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">############################</span>
        <span class="c1"># RECANALIZATION TREATMENT #</span>
        <span class="c1">############################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa&#39;</span>
        
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% patients recanalized&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Endovascular treatment alone&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + referred to another centre for endovascular treatment&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;% patients recanalized&#39;</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% všech REKANALIZAČNÍCH VÝKONŮ u iCMP&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IV tPA – IC / KCC&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPA + endovaskulární výkon – KCC&#39;</span><span class="p">,</span> <span class="s1">&#39;pouze endovaskulární výkon – KCC&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPA + odeslán do jiného centra k endovaskulárnímu výkonu – IC&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% RECANALIZATION PROCEDURES for IS&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IV tPa&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPa + another centre for endovascular treatment&#39;</span><span class="p">]</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">############################</span>
        <span class="c1"># RECANALIZATION TREATMENT #</span>
        <span class="c1">############################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa&#39;</span>
        

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + referred to another centre for endovascular treatment&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PACIENTŮ LÉČENÝCH IV tPa u iCMP&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IV tPA – IC / KCC&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPA + endovaskulární výkon – KCC&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPA + odeslán do jiného centra k endovaskulárnímu výkonu – IC&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% IV tPa for IS&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IV tPA – IC / KCC&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPa + another centre for endovascular treatment&#39;</span><span class="p">]</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">####################################################</span>
        <span class="c1"># RECANALIZATION TREATMENT IN COMPREHENSIVE CENTRE #</span>
        <span class="c1">####################################################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Endovascular treatment alone&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + endovascular treatment&#39;</span>
        

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Endovascular treatment alone&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">% E</span><span class="s2">NDOVASKULÁRNÍCH VÝKONŮ V KOMPLEXNÍCH CENTRECH u iCMP&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IV tPA + endovaskulární výkon – KCC&#39;</span><span class="p">,</span> <span class="s1">&#39;pouze endovaskulární výkon – KCC&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% RECANALIZATION PROCEDURES IN COMPREHENSIVE CENTRES for IS&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;endovascular treatment&#39;</span><span class="p">]</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">##########################################################</span>
        <span class="c1"># RECANALIZATION TREATMENT IN REFFERED TO ANOTHER CENTRE #</span>
        <span class="c1">##########################################################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + referred to another centre for endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Referred to another centre for endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Referred to another centre for endovascular treatment and hospitalization continues at the referred to centre&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Referred for endovascular treatment and patient is returned to the initial centre&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + referred to another centre for endovascular treatment&#39;</span>
        

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + referred to another centre for endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Referred to another centre for endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Referred to another centre for endovascular treatment and hospitalization continues at the referred to centre&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Referred for endovascular treatment and patient is returned to the initial centre&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PACIENTŮ PŘELOŽENÝCH K ENDOVASKULÁRNÍMU VÝKONU DO JINÉHO CENTRA Z PRIMÁRNÍHO CENTRA u iCMP&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IV tPA + odeslán do jiného centra k endovaskulárnímu výkonu – IC&#39;</span><span class="p">,</span> <span class="s1">&#39;pouze odeslán do jiného centra k endovaskulárnímu výkonu – IC&#39;</span><span class="p">,</span> <span class="s1">&#39;pouze odeslán k endovaskulárnímu výkonu a hospitalizace pokračuje – KCC&#39;</span><span class="p">,</span> <span class="s1">&#39;pouze odeslán k endovaskulárnímu výkonu a pacient přeložen zpět do jiného centra – KCC&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PATIENTS TRANSFERRED TO ANOTHER CENTRE FOR RECANALIZATION PROCEDURES FROM PRIMARY CENTRE for IS&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IV tPa + another centre for endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;another centre for endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;another centre for endovascular treatment and hospitalization continues&#39;</span><span class="p">,</span> <span class="s1">&#39;another centre for endovascular treatment and returned to the initial centre&#39;</span><span class="p">]</span>
            

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">#### Stroke types ####</span>

        <span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">graph_types</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># STROKE TYPE #</span>
        
        
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Typ CMP (%)&quot;</span><span class="p">)</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ischemická CMP&#39;</span><span class="p">,</span> <span class="s1">&#39;tranzitorní ischemická ataka - TIA&#39;</span><span class="p">,</span> <span class="s1">&#39;intracerebrální krvácení&#39;</span><span class="p">,</span> <span class="s1">&#39;subarachnoidální krvácení&#39;</span><span class="p">,</span> <span class="s1">&#39;mozková žilní trombóza&#39;</span><span class="p">,</span> <span class="s1">&#39;neurčená&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Stroke type (%)&quot;</span><span class="p">)</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ischemic&#39;</span><span class="p">,</span> <span class="s1">&#39;transient ischemic attack&#39;</span><span class="p">,</span> <span class="s1">&#39;intracerebral hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;subarrachnoid hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;cerebral venous thrombosis&#39;</span><span class="p">,</span> <span class="s1">&#39;undetermined&#39;</span><span class="p">]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;stacked&quot;</span><span class="p">)</span>

        <span class="n">df1</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - ischemic stroke&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - transient ischemic attack&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - intracerebral hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - subarrachnoid hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - cerebral venous thrombosis&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - undetermined stroke&#39;</span><span class="p">]]</span>

        <span class="c1"># CT/MRI performed #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% CT/MRI - performed&#39;</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CT/MRI (%)&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="c1"># patients recanalized</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients recanalized&#39;</span>
        <span class="n">df3</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">% r</span><span class="s2">ekanalizovaných pacientů&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% patients recanalized&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="n">GenerateYearsCompGraphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">df1</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">df2</span><span class="o">=</span><span class="n">df3</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">comp_title</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="n">titles</span><span class="p">,</span> <span class="n">graph_types</span><span class="o">=</span><span class="n">graph_types</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="n">legends</span><span class="p">)</span>


        <span class="c1">################</span>
        <span class="c1"># % median DTN #</span>
        <span class="c1">################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median DTN (minutes)&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MEDIÁN DOOR-TO-NEEDLE TIME (v minutách) u trombolyzovaných pacientů&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MEDIAN DOOR-TO-NEEDLE TIME (minutes) for thrombolyzed patients&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">###############</span>
        <span class="c1">#  median DTG #</span>
        <span class="c1">###############</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median DTG (minutes)&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MEDIÁN DOOR-TO-GROIN TIME (v minutách) u pacientů, kteří podstoupili endovaskulární zákrok v komplexním centru&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MEDIAN DOOR-TO-GROIN TIME (minutes) for patients receiving endovascular treatment in a comprehensive centre&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">####################</span>
        <span class="c1">#  median TBY DIDO #</span>
        <span class="c1">####################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median TBY DIDO (minutes)&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MEDIÁN DOOR-IN-DOOR-OUT TIME (v minutách) u pacientů transportovaných z primárního centra do jiného centra k rekanalizační terapii&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MEDIAN DOOR-IN-DOOR-OUT TIME (minutes) for patients referred from a primary centre to another centre for recanalization therapy&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>


        <span class="c1">##################</span>
        <span class="c1">### COMPARISON ###</span>
        <span class="c1">##################</span>
        <span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">graph_types</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># RECANALIZATION PROCEDURES #</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Rekanalizační výkony (%)&quot;</span><span class="p">)</span>
            <span class="n">legend</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;IV tPA – IC / KCC&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPA + endovaskulární výkon – KCC&#39;</span><span class="p">,</span> <span class="s1">&#39;pouze endovaskulární výkon – KCC&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPA + odeslán do jiného centra k endovaskulárnímu výkonu – IC&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Recanalization procedures (%)&quot;</span><span class="p">)</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IV tPa&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPa + another centre for endovascular treatment&#39;</span><span class="p">]</span>

        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        
        <span class="n">df1</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Endovascular treatment alone&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + referred to another centre for endovascular treatment&#39;</span><span class="p">]]</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;stacked&quot;</span><span class="p">)</span>

        <span class="c1"># MEDIAN DTN #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median DTN (minutes)&#39;</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="c1">#titles.append(&quot;Medián DTN (v minutách)&quot;)</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Medián Door-To-Needle time (v minutách)&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Median DTN (minutes)&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="c1"># MEDIAN DTN #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median DTG (minutes)&#39;</span>
        <span class="n">df3</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="c1">#titles.append(&quot;Medián DTG (v minutách)&quot;)</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Medián Door-To-Groin time (v minutách)&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Median DTG (minutes)&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="n">GenerateYearsCompGraphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">df1</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">df2</span><span class="o">=</span><span class="n">df3</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">comp_title</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="n">titles</span><span class="p">,</span> <span class="n">graph_types</span><span class="o">=</span><span class="n">graph_types</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="n">legends</span><span class="p">)</span>

        <span class="c1">#######################</span>
        <span class="c1"># dysphagia screening #</span>
        <span class="c1">#######################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Guss test&#39;</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Guss test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Other test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Another centre&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Guss test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Other test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Another centre&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">column_names</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="c1">#title = &quot;% SCREENINGŮ DYSFAGIE provedených u iCMP, ICH nebo CVT&quot;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% SCREENINGŮ DYSFAGIE provedených u iCMP nebo ICH&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GUSS test&#39;</span><span class="p">,</span> <span class="s1">&#39;Jiný test&#39;</span><span class="p">,</span> <span class="s1">&#39;Jiné pracoviště&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% DYSPHAGIA SCREENING PERFORMED for IS, ICH, CVT&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GUSS test&#39;</span><span class="p">,</span> <span class="s1">&#39;Other test&#39;</span><span class="p">,</span> <span class="s1">&#39;Another centre&#39;</span><span class="p">]</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">######################################</span>
        <span class="c1">#  dypshagia screening within 1 hour #</span>
        <span class="c1">######################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening time - Within first 24 hours&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% SCREENINGŮ DYSFAGIE BĚHEM 24 HODIN OD PŘIJETÍ&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% DYSPHAGIA SCREENING TIME WITHIN FIRST 24 HOURS AFTER ADMISSION&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        
        <span class="c1">###########################</span>
        <span class="c1"># PUT ON VENTILATOR - YES #</span>
        <span class="c1">###########################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients put on ventilator - Yes&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="c1">#title = &quot;% PACIENTŮ NA UPV u iCMP, ICH nebo CVT&quot;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PACIENTŮ NA UPV u iCMP nebo ICH&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PATIENTS PUT ON VENTILATOR for IS, ICH, CVT&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">###################</span>
        <span class="c1"># HEMICRANEOCTOMY #</span>
        <span class="c1">###################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% he</span><span class="s1">micraniectomy - Yes&#39;</span>
        

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% he</span><span class="s1">micraniectomy - Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% he</span><span class="s1">micraniectomy - Referred to another centre&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% HEMIKRANIEKTOMIÍ provedených u iCMP&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Ano&#39;</span><span class="p">,</span> <span class="s1">&#39;Odeslán/a do jiného centra&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% HEMICRANIECTOMY PERFORMED for IS&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;Referred to another centre&#39;</span><span class="p">]</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        ################</span>
<span class="sd">        # NEUROSURGERY #</span>
<span class="sd">        ################</span>
<span class="sd">        column_name = &#39;% neurosurgery - Yes&#39;</span>

<span class="sd">        tmp_df = df[[main_col, column_name]]</span>
<span class="sd">        tmp_df = tmp_df.sort_values([column_name], ascending = True)</span>

<span class="sd">        if site_code == &quot;CZ&quot;:</span>
<span class="sd">            title = &quot;% NEUROCHIRURGICKÝCH ZÁKROKŮ U PACIENTŮ S ICH&quot;</span>
<span class="sd">        else:</span>
<span class="sd">            title = &quot;% NEUROSURGERY PERFORMED for ICH&quot;</span>

<span class="sd">        GenerateGraphs(dataframe=tmp_df, presentation=prs, title=title, column_name=column_name, country=self.country_name) </span>

<span class="sd">        #######################################</span>
<span class="sd">        # NEUROSURGERY TYPE (FIRST 3 OPTIONS) #</span>
<span class="sd">        #######################################</span>
<span class="sd">        sorted_by = [&#39;% neurosurgery type - intracranial hematoma evacuation&#39;, &#39;% neurosurgery type - external ventricular drainage&#39;, &#39;% neurosurgery type - decompressive craniectomy&#39;]</span>
<span class="sd">        column_name = &#39;% neurosurgery type - intracranial hematoma evacuation&#39;</span>
<span class="sd">        legend = [&#39;intracranial hematoma evacuation&#39;, &#39;external ventricular drainage&#39;, &#39;decompressive craniectomy&#39;]</span>

<span class="sd">        tmp_df = df[[main_col, &#39;% neurosurgery type - intracranial hematoma evacuation&#39;, &#39;% neurosurgery type - external ventricular drainage&#39;, &#39;% neurosurgery type - decompressive craniectomy&#39;]]</span>
<span class="sd">        tmp_df = tmp_df.sort_values(sorted_by, ascending = True)</span>

<span class="sd">        if site_code == &quot;CZ&quot;:</span>
<span class="sd">            title = &quot;% TYPŮ NEUROCHIRURGICKÉHO ZÁKROKU u PACIENTŮ s ICH v komplexních centrech&quot;</span>
<span class="sd">        else:</span>
<span class="sd">            title = &quot;% NEUROSURGERY TYPE PERFORMED for ICH in comprehensive centres&quot;</span>

<span class="sd">        GenerateGraphs(dataframe=tmp_df, presentation=prs, title=title, column_name=column_name, country=self.country_name, legend=legend, number_of_series=len(legend), graph_type=&#39;stacked&#39;)</span>

<span class="sd">        </span>
<span class="sd">        ###################################</span>
<span class="sd">        # NEUROSURGERY TYPE (LAST OPTION) #</span>
<span class="sd">        ###################################</span>
<span class="sd">        column_name = &#39;% neurosurgery type - Referred to another centre&#39;</span>

<span class="sd">        tmp_df = df[[main_col, column_name]]</span>
<span class="sd">        tmp_df = tmp_df.sort_values([column_name], ascending = True)</span>

<span class="sd">        if site_code == &quot;CZ&quot;:</span>
<span class="sd">            title = &quot;% PACIENTŮ ODESLANÝCH DO JINÉHO CENTRA K NEUROCHIRURGICKÉMU ZÁKROKU&quot;</span>
<span class="sd">        else:</span>
<span class="sd">            title = &quot;% PATIENTS REFERRED TO ANOTHER CENTRE FOR NEUROSURGERY&quot;</span>

<span class="sd">        GenerateGraphs(dataframe=tmp_df, presentation=prs, title=title, column_name=column_name, country=self.country_name)&#39;&#39;&#39;</span>

        <span class="c1">###################</span>
        <span class="c1"># BLEEDING REASON #</span>
        <span class="c1">###################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bleeding_arterial_hypertension_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_aneurysm_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_arterio_venous_malformation_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_anticoagulation_therapy_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_amyloid_angiopathy_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_other_perc_norm&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;bleeding_arterial_hypertension_perc_norm&#39;</span>
        

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;bleeding_arterial_hypertension_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_aneurysm_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_arterio_venous_malformation_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_anticoagulation_therapy_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_amyloid_angiopathy_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_other_perc_norm&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PŘÍČINY KRVÁCENÍ u ICH&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39; arteriální hypertenze&#39;</span><span class="p">,</span> <span class="s1">&#39;aneurysma&#39;</span><span class="p">,</span> <span class="s1">&#39;arteriovenózní malformace&#39;</span><span class="p">,</span> <span class="s1">&#39;antikoagulační terapie&#39;</span><span class="p">,</span> <span class="s1">&#39;amyloidní angiopatie&#39;</span><span class="p">,</span> <span class="s1">&#39;jiné / neznámé&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% BLEEDING REASON for ICH&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;arterial hypertension&#39;</span><span class="p">,</span> <span class="s1">&#39;aneurysm&#39;</span><span class="p">,</span> <span class="s1">&#39;arterio-venous malformation&#39;</span><span class="p">,</span> <span class="s1">&#39;anticoagulation therapy&#39;</span><span class="p">,</span> <span class="s1">&#39;amyloid angiopathy&#39;</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">]</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">##########################</span>
        <span class="c1"># INTERVENTION PERFORMED #</span>
        <span class="c1">##########################</span>
        <span class="c1">#sorted_by = [&#39;intervention_endovascular_perc_norm&#39;, &#39;intervention_neurosurgical_perc_norm&#39;, &#39;intervention_other_perc_norm&#39;, &#39;intervention_referred_perc_norm&#39;, &#39;intervention_none_perc_norm&#39;]</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;intervention_endovascular_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_neurosurgical_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_other_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_referred_perc_norm&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;intervention_endovascular_perc_norm&#39;</span>
        

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;intervention_endovascular_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_neurosurgical_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_other_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_referred_perc_norm&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% INTERVENCÍ PROVEDENÝCH u SAK&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Endovaskulární (coiling)&#39;</span><span class="p">,</span> <span class="s1">&#39;Neurochirurgická (clipping)&#39;</span><span class="p">,</span> <span class="s1">&#39;Jiný neurochirurgický výkon&#39;</span><span class="p">,</span> <span class="s1">&#39;Odeslán k intervenci do jiného centra&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% INTERVENTION PERFORMED for SAH&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Endovascular (coiling)&#39;</span><span class="p">,</span> <span class="s1">&#39;Neurosurgical (clipping)&#39;</span><span class="p">,</span> <span class="s1">&#39;Other neurosurgical treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;Patient referred to another centre&#39;</span><span class="p">]</span>


        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        ###############################</span>
<span class="sd">        # VENOUS THROMBOSIS TREATMENT #</span>
<span class="sd">        ###############################</span>
<span class="sd">        sorted_by = [&#39;vt_treatment_anticoagulation_perc_norm&#39;, &#39;vt_treatment_thrombectomy_perc_norm&#39;, &#39;vt_treatment_local_thrombolysis_perc_norm&#39;, &#39;vt_treatment_local_neurological_treatment_perc_norm&#39;]</span>
<span class="sd">        column_name = &#39;vt_treatment_anticoagulation_perc_norm&#39;</span>
<span class="sd">        legend = [&#39;anticoagulation&#39;, &#39;thrombectomy&#39;, &#39;local thrombolysis&#39;, &#39;neurosurgical treatment&#39;]</span>

<span class="sd">        tmp_df = df[[main_col, &#39;vt_treatment_anticoagulation_perc_norm&#39;, &#39;vt_treatment_thrombectomy_perc_norm&#39;, &#39;vt_treatment_local_thrombolysis_perc_norm&#39;, &#39;vt_treatment_local_neurological_treatment_perc_norm&#39;]]</span>
<span class="sd">        tmp_df = tmp_df.sort_values(sorted_by, ascending = True)</span>

<span class="sd">        if site_code == &quot;CZ&quot;:</span>
<span class="sd">            title = &quot;% TYPŮ LÉČBY VENÓZNÍ TROMBÓZY U CVT&quot;</span>
<span class="sd">        else:</span>
<span class="sd">            title = &quot;% VENOUS THROMBOSIS TREATMENT for CVT&quot;</span>

<span class="sd">        GenerateGraphs(dataframe=tmp_df, presentation=prs, title=title, column_name=column_name, country=self.country_name, legend=legend, number_of_series=len(legend), graph_type=&#39;stacked&#39;)</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1">##########################################</span>
        <span class="c1"># % PATIENTS ASSESSED FOR REHABILITATION #</span>
        <span class="c1">##########################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients assessed for rehabilitation - Yes&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% VYŠETŘENÍ FYZIOTERAPEUTEM ze všech případů&quot;</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% REHABILITATION ASSESSMENT out of all cases&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">################################</span>
        <span class="c1"># ATRIAL FIBRILLATION DETECTED #</span>
        <span class="c1">################################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;% afib/flutter - Detected during hospitalization&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib/flutter - Newly-detected at admission&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib/flutter - Known&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% afib/flutter - Detected during hospitalization&#39;</span>
        

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% afib/flutter - Detected during hospitalization&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib/flutter - Newly-detected at admission&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib/flutter - Known&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">% F</span><span class="s2">IBRILACÍ SÍNÍ DETEKOVANÝCH  u iCMP nebo TIA&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;zjištěná během hospitalizace&#39;</span><span class="p">,</span> <span class="s1">&#39;nově zjištěná při přijetí&#39;</span><span class="p">,</span> <span class="s1">&#39;známá FS&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% ATRIAL FIBRILLATION DETECTED for IS, TIA&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;detected during hospitalization&#39;</span><span class="p">,</span> <span class="s1">&#39;newly-detected at admission&#39;</span><span class="p">,</span> <span class="s1">&#39;known aFib&#39;</span><span class="p">]</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">########################################</span>
        <span class="c1"># ATRIAL FIBRILLATION DETECTION METHOD #</span>
        <span class="c1">########################################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;% afib detection method - Telemetry with monitor allowing automatic detection of aFib&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - Telemetry without monitor allowing automatic detection of aFib&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - Holter-type monitoring&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - EKG monitoring in an ICU bed with automatic detection of aFib&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - EKG monitoring in an ICU bed without automatic detection of aFib&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% afib detection method - Telemetry with monitor allowing automatic detection of aFib&#39;</span>
        

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - Telemetry with monitor allowing automatic detection of aFib&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - Telemetry without monitor allowing automatic detection of aFib&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - Holter-type monitoring&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - EKG monitoring in an ICU bed with automatic detection of aFib&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - EKG monitoring in an ICU bed without automatic detection of aFib&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s1">&#39;CZ&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% METOD DETEKCE FIBRILACÍ SÍNÍ&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Telemetrie s automatickou detekci FS&#39;</span><span class="p">,</span> <span class="s1">&#39;Telemetrie bez automatické detekce FS&#39;</span><span class="p">,</span> <span class="s1">&#39;Holterovo monitorování&#39;</span><span class="p">,</span> <span class="s1">&#39;EKG monitorace na JIP lůžku s automatickou detekcí FS&#39;</span><span class="p">,</span> <span class="s1">&#39;EKG monitorace na JIP lůžku bez automatické detekce FS&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% ATRIAL FIBRILLATION DETECTION METHOD&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Telemetry with monitoring&#39;</span><span class="p">,</span> <span class="s1">&#39;Telemetry without monitoring&#39;</span><span class="p">,</span> <span class="s1">&#39;Holter-type monitoring&#39;</span><span class="p">,</span> <span class="s1">&#39;EKG monitoring in an ICU bed with automatic detection of aFib&#39;</span><span class="p">,</span> <span class="s1">&#39;EKG monitoring in an ICU bed without automatic detection of aFib&#39;</span><span class="p">]</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">#######################################</span>
        <span class="c1"># AMBULATORY HEART RHYTHM RECOMMENDED #</span>
        <span class="c1">#######################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% o</span><span class="s1">ther afib detection method - Yes&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="c1">#title = &quot;% DOPORUČENÉ AMBULANTNÍ MONITORACE SRDEČNÍHO RYTMU u iCMP nebo TIA bez detekované fibrilace&quot;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% pacientů s iCMP nebo TIA DOPORUČENÝCH NA AMBULANTNÍ MONITORACI SRDEČNÍHO RYTMU, u kterých nebyla detekována fibrilace síní&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% AMBULATORY HEART RHYTHM RECOMMENDED for IS, TIA without AFib detection&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">##################################</span>
        <span class="c1"># CAROTID ARTERIES IMAGING - YES #</span>
        <span class="c1">##################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid arteries imaging - Yes&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PROVEDENÉHO ZOBRAZOVÁNÍ KAROTID u iCMP, TIA&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% CAROTID ARTERIES IMAGING PERFORMED for IS, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">##############</span>
        <span class="c1"># COMPARISON #</span>
        <span class="c1">##############</span>
        <span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">graph_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># DYSPHAGIA SCREENING #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Guss test&#39;</span>
        
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Screening dysfagie (%)&quot;</span><span class="p">)</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GUSS test&#39;</span><span class="p">,</span> <span class="s1">&#39;Jiný test&#39;</span><span class="p">,</span> <span class="s1">&#39;Jiné pracoviště&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Dysphagia screening (%)&quot;</span><span class="p">)</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GUSS test&#39;</span><span class="p">,</span> <span class="s1">&#39;Other test&#39;</span><span class="p">,</span> <span class="s1">&#39;Another centre&#39;</span><span class="p">]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;stacked&quot;</span><span class="p">)</span>

        <span class="n">df1</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Guss test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Other test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Another centre&#39;</span><span class="p">]]</span>

        <span class="c1"># CAROTID ARTERIES IMAGING #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid arteries imaging - Yes&#39;</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Zobrazení karotid (%)&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Carotid arteries imaging (%)&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="c1"># % RECOMMENDED TO A CEREBROVASCULAR EXPERT - RECOMMENDED #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecommended to a cerebrovascular expert - Recommended&#39;</span>
        <span class="n">df3</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">% d</span><span class="s2">oporučených k vyšetření cerebrovaskulárním odborníkem&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Recommended to a cerebrovascular </span><span class="se">\n</span><span class="s2">expert (%)&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="n">GenerateYearsCompGraphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">df1</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">df2</span><span class="o">=</span><span class="n">df3</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">comp_title</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="n">titles</span><span class="p">,</span> <span class="n">graph_types</span><span class="o">=</span><span class="n">graph_types</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="n">legends</span><span class="p">)</span>
   
        <span class="c1">##################################################</span>
        <span class="c1"># % PATIENTS PRESCRIBED ANTICOAGULANTS WITH AFIB #</span>
        <span class="c1">##################################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed anticoagulants with aFib&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="c1">#title = &quot;% PACIENTŮ S FIBRILACÍ SÍNÍ A PŘEDEPSANÝMI ANTIKOAGULANTY U iCMP, TIA&quot;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;POUŽITÍ ANTIKOAGULAČNÍ LÉČBY U PACIENTŮ S FIBRILACÍ SÍNÍ a iCMP nebo TIA (%)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PATIENTS WITH AFIB, PRESCRIBED ANTICOAGULANTS for IS, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">##############################</span>
        <span class="c1"># ANTICOAGULANTS PRESCRIBED  #</span>
        <span class="c1">##############################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients receiving Vit. K antagonist&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Vitamin K&#39;</span><span class="p">,</span> <span class="s1">&#39;Dabigatran&#39;</span><span class="p">,</span> <span class="s1">&#39;Rivaroxaban&#39;</span><span class="p">,</span> <span class="s1">&#39;Apixaban&#39;</span><span class="p">,</span> <span class="s1">&#39;Edoxaban&#39;</span><span class="p">,</span> <span class="s1">&#39;LMWH, heparin - profylaktická dávka&#39;</span><span class="p">,</span> <span class="s1">&#39;LMWH, heparin - antikoagulační, terapeutická dávka&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% patients prescribed anticoagulants with aFib&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving Vit. K antagonist&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving dabigatran&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving rivaroxaban&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving apixaban&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving edoxaban&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving LMWH or heparin in prophylactic dose&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving LMWH or heparin in full anticoagulant dose&#39;</span><span class="p">]]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;% patients prescribed anticoagulants with aFib&#39;</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;POUŽITÍ ANTIKOAGULAČNÍ LÉČBY U PACIENTŮ S FIBRILACÍ SÍNÍ a iCMP nebo TIA (%)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PATIENTS WITH AFIB, PRESCRIBED ANTICOAGULANTS for IS, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">#########################################################</span>
        <span class="c1"># % PATIENTS PRESCRIBED ANTICOAGULANTS WITH AFIB (HOME) #</span>
        <span class="c1">#########################################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% afib patients discharged home with anticoagulants&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="c1">#title = &quot;% PACIENTŮ PROPUŠTĚNÝCH DOMŮ, S FIBRILACÍ SÍNÍ A PŘEDEPSANÝMI ANTIKOAGULANTY u iCMP, TIA&quot;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% pacientů s PŘEDEPSANÝMI ANTIKOAGULANTY u iCMP nebo TIA pro FIBRILACI SÍNÍ, pokud byli PROPUŠTĚNI DOMŮ&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PATIENTS DISCHARGED HOME WITH AFIB, PRESCRIBED ANTICOAGULANTS </span><span class="se">\n</span><span class="s2">for IS, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">##################################################</span>
        <span class="c1"># PATIENTS PRESCRIBED ANTIPLATELETS WITHOUT AFIB #</span>
        <span class="c1">##################################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed antiplatelets without aFib&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
           <span class="c1"># title = &quot;% PACIENTŮ BEZ FIBRILACÍ SÍNÍ A PŘEDEPSANOU ANTOAGREGACÍ u iCMP, TIA&quot;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% pacientů LÉČENÝCH PROTIDESTIČKOVÝMI LÉKY pro iCMP nebo TIA, pokud neměli FIBRILACI SÍNÍ&quot;</span>
           <span class="c1"># title = &quot;% PACIENTŮ LÉČENÝCH PROTIDESTIČKOVÝMI LÉKY bez FIBRILACE SÍNÍ u iCMP nebo TIA&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PATIENTS WITHOUT AFIB, PRESCRIBED ANTIPLATELETS for IS, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="sd">&#39;&#39;&#39;        </span>
<span class="sd">        ###################################</span>
<span class="sd">        # NOT PRESCRIBED, BUT RECOMMENDED #</span>
<span class="sd">        ###################################</span>
<span class="sd">        column_name = &#39;% patients not prescribed antithrombotics, but recommended&#39;</span>

<span class="sd">        tmp_df = df[[main_col, column_name]]</span>
<span class="sd">        tmp_df = tmp_df.sort_values([column_name], ascending = True)</span>

<span class="sd">        if site_code == &quot;CZ&quot;:</span>
<span class="sd">            title = &quot;% PACIENTŮ BEZ PŘEDEPSANÝCH, ALE S DOPORUČENÝMI ANTITROMBOTIKY u iCMP, TIA&quot;</span>
<span class="sd">        else:</span>
<span class="sd">            title = &quot;% PATIENTS NOT PRESCRIBED, BUT RECOMMENDED ANTITHROMBOTICS for IS, TIA&quot;</span>

<span class="sd">        GenerateGraphs(dataframe=tmp_df, presentation=prs, title=title, column_name=column_name, country=self.country_name)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        ############</span>
<span class="sd">        # WITH CVT #</span>
<span class="sd">        ############</span>
<span class="sd">        ##############################</span>
<span class="sd">        # ANTITHROMBOTICS PRESCRIBED #</span>
<span class="sd">        ##############################</span>
<span class="sd">        column_name = &#39;% patients receiving antiplatelets with CVT&#39;</span>
<span class="sd">        legend = [&#39;Antiplatelets&#39;, &#39;Vitamin K&#39;, &#39;Dabigatran&#39;, &#39;Rivaroxaban&#39;, &#39;Apixaban&#39;, &#39;Edoxaban&#39;, &#39;LMWH or heparin in prophylactic dose&#39;, &#39;LMWH or heparin in anticoagulant dose&#39;]</span>

<span class="sd">        tmp_df = df[[main_col, &#39;% patients prescribed antithrombotics with CVT&#39;, &#39;% patients receiving antiplatelets with CVT&#39;, &#39;% patients receiving Vit. K antagonist with CVT&#39;, &#39;% patients receiving dabigatran with CVT&#39;, &#39;% patients receiving rivaroxaban with CVT&#39;, &#39;% patients receiving apixaban with CVT&#39;, &#39;% patients receiving edoxaban with CVT&#39;, &#39;% patients receiving LMWH or heparin in prophylactic dose with CVT&#39;, &#39;% patients receiving LMWH or heparin in full anticoagulant dose with CVT&#39;]]</span>

<span class="sd">        tmp_df = tmp_df.sort_values([&#39;% patients prescribed antithrombotics with CVT&#39;], ascending = True)</span>

<span class="sd">        if site_code == &quot;CZ&quot;:</span>
<span class="sd">            title = &quot;% PŘEDEPSANÉ ANTITROMBOTICKÉ LÉČBY u iCMP, TIA, CVT&quot;</span>
<span class="sd">        else:</span>
<span class="sd">            title = &quot;% ANTITHROMBOTICS PRESCRIBED for IS, TIA, CVT&quot;</span>

<span class="sd">        GenerateGraphs(dataframe=tmp_df, presentation=prs, title=title, column_name=column_name, country=self.country_name, legend=legend, number_of_series=len(legend), graph_type=&#39;stacked&#39;)</span>

<span class="sd">        ##################################################</span>
<span class="sd">        # % PATIENTS PRESCRIBED ANTICOAGULANTS WITH AFIB #</span>
<span class="sd">        ##################################################</span>
<span class="sd">        column_name = &#39;% patients prescribed anticoagulants with aFib with CVT&#39;</span>

<span class="sd">        tmp_df = df[[main_col, column_name]]</span>
<span class="sd">        tmp_df = tmp_df.sort_values([column_name], ascending = True)</span>

<span class="sd">        if site_code == &quot;CZ&quot;:</span>
<span class="sd">            title = &quot;% PACIENTŮ S FIBRILACÍ SÍNÍ A PŘEDEPSANÝMI ANTIKOAGULANTY u iCMP, TIA, CVT&quot;</span>
<span class="sd">        else:</span>
<span class="sd">            title = &quot;% PATIENTS WITH AFIB, PRESCRIBED ANTICOAGULANTS for IS, TIA, CVT&quot;</span>

<span class="sd">        GenerateGraphs(dataframe=tmp_df, presentation=prs, title=title, column_name=column_name, country=self.country_name)</span>

<span class="sd">        ##################################################</span>
<span class="sd">        # PATIENTS PRESCRIBED ANTIPLATELETS WITHOUT AFIB #</span>
<span class="sd">        ##################################################</span>
<span class="sd">        column_name = &#39;% patients prescribed antiplatelets without aFib with CVT&#39;</span>

<span class="sd">        tmp_df = df[[main_col, column_name]]</span>
<span class="sd">        tmp_df = tmp_df.sort_values([column_name], ascending = True)</span>

<span class="sd">        if site_code == &quot;CZ&quot;:</span>
<span class="sd">            title = &quot;% PACIENTŮ BEZ FIBRILACE SÍNÍ, S PŘEDEPSANOU ANTIAGREGACÍ u iCMP, TIA, CVT&quot;</span>
<span class="sd">        else:</span>
<span class="sd">            title = &quot;% PATIENTS WITHOUT AFIB, PRESCRIBED ANTIPLATELETS for IS, TIA, CVT&quot;</span>

<span class="sd">        GenerateGraphs(dataframe=tmp_df, presentation=prs, title=title, column_name=column_name, country=self.country_name)</span>

<span class="sd">        </span>
<span class="sd">        ###################################</span>
<span class="sd">        # NOT PRESCRIBED, BUT RECOMMENDED #</span>
<span class="sd">        ###################################</span>
<span class="sd">        column_name = &#39;% patients not prescribed antithrombotics, but recommended with CVT&#39;</span>

<span class="sd">        tmp_df = df[[main_col, column_name]]</span>
<span class="sd">        tmp_df = tmp_df.sort_values([column_name], ascending = True)</span>

<span class="sd">        if site_code == &quot;CZ&quot;:</span>
<span class="sd">            title = &quot;% PACIENTŮ S POUZE DOPORUČENOU LÉČBOU ANTITROMBOTIKY u iCMP, TIA, CVT&quot;</span>
<span class="sd">        else:</span>
<span class="sd">            title = &quot;% PATIENTS NOT PRESCRIBED, BUT RECOMMENDED ANTITHROMBOTICS \nfor IS, TIA, CVT&quot;</span>

<span class="sd">        GenerateGraphs(dataframe=tmp_df, presentation=prs, title=title, column_name=column_name, country=self.country_name)</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1">################</span>
        <span class="c1"># COMPARISON ###</span>
        <span class="c1">################</span>
        <span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">graph_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># PRESCRIBED ANTIPLATELETS #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed antiplatelets without aFib&#39;</span>
        <span class="n">df1</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% pacientů s antiagregací bez fibrilace síní&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% patients prescribed antiplatelets without aFib&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="c1"># % PATIENTS PRESCRIBED ANTICOAGULANTS WITH AFIB #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed anticoagulants with aFib&#39;</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% pacientů s předepsanými antikoagulanty a s fibrilací síní&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% patients prescribed anticoagulants with aFib&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="c1">#  % PATIENTS PRESCRIBED ANTITHROMBOTICS WITH AFIB  #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed antithrombotics with aFib&#39;</span>
        <span class="n">df3</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% pacientů s předepsanými antitrombotiky a  s fibrilací síní&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% patients prescribed antithrombotics with aFib&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="c1"># % PATIENTS PRESCRIBED ANTICOAGULANTS WITH AFIB (HOME) #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% afib patients discharged home with anticoagulants&#39;</span>
        <span class="n">df4</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% pacientů s fibrilací síní propuštěných domů s antikoagulanty&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% aFib patients discharged home with anticoagulants&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="n">GenerateYearsCompGraphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">df1</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">df2</span><span class="o">=</span><span class="n">df3</span><span class="p">,</span> <span class="n">df3</span><span class="o">=</span><span class="n">df4</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">comp_title</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="n">titles</span><span class="p">,</span> <span class="n">graph_types</span><span class="o">=</span><span class="n">graph_types</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="n">legends</span><span class="p">)</span>

        <span class="c1">##########################</span>
        <span class="c1"># DISCHARGE WITH STATINS #</span>
        <span class="c1">##########################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed statins - Yes&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="c1">#title = &quot;% PROPUŠTĚNÝCH PACIENTŮ SE STATINY u iCMP nebo TIA&quot;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% pacientů LÉČENÝCH STATINY u iCMP nebo TIA, pokud byli PROPUŠTĚNI DOMŮ&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% DISCHARGED WITH STATINS for IS, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">#############################</span>
        <span class="c1"># CAROTID STENOSIS DETECTED #</span>
        <span class="c1">#############################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid stenosis - &gt;70%&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% STENÓZY KAROTID NAD 70</span><span class="si">% u</span><span class="s2"> iCMP nebo TIA&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% CAROTID STENOSIS OF OVER 70 PERCENT for IS, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">##################################################</span>
        <span class="c1"># % CAROTID STENOSIS FOLLOWUP - YES, BUT PLANNED #</span>
        <span class="c1">##################################################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid stenosis followup - Yes, but planned&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid stenosis followup - Referred to another centre&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid stenosis followup - Yes, but planned&#39;</span>
        

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid stenosis followup - Yes, but planned&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid stenosis followup - Referred to another centre&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">% E</span><span class="s2">NDARTEREKTOMIÍ NEBO ANGIOPLASTIK / STENTINGŮ PROVEDENÝCH NEBO PLÁNOVANÝCH u iCMP, TIA s ICA STENÓZOU &gt; 70%&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Ano nebo plánováno&#39;</span><span class="p">,</span> <span class="s1">&#39;Odeslán/a do jiného centra&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">% E</span><span class="s2">NDARTERECTOMY OR ANGIOPLASTY / STENTING DONE OR PLANNED for IS, TIA with ICA STENOSIS &gt; 70%&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Yes or planned&#39;</span><span class="p">,</span> <span class="s1">&#39;Referred to another centre&#39;</span><span class="p">]</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">#############################################################</span>
        <span class="c1"># % ANTIHYPERTENSIVE MEDICATION PRESCRIBED out of all cases #</span>
        <span class="c1">#############################################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% prescribed antihypertensives - Yes&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PŘEDEPSANÉ ANTIHYPERTENZNÍ LÉČBY ze všech případů&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% ANTIHYPERTENSIVE MEDICATION PRESCRIBED out of all cases&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">##############</span>
        <span class="c1"># COMPARISON #</span>
        <span class="c1">##############</span>
        <span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">graph_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># DISCHARGE WITH STATINS #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed statins - Yes&#39;</span>
        <span class="n">df1</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% pacientů s předepsanými statiny&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% patients prescribed statins&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="c1"># % PATIENTS PRESCRIBED ANTICOAGULANTS WITH AFIB #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% prescribed antihypertensives - Yes&#39;</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">fdf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% pacientů s předepsanými antihypertenzívy&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% patients prescribed antihypertensives&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="n">GenerateYearsCompGraphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">df1</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">comp_title</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="n">titles</span><span class="p">,</span> <span class="n">graph_types</span><span class="o">=</span><span class="n">graph_types</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="n">legends</span><span class="p">)</span>

        <span class="c1">######################################################</span>
        <span class="c1"># % RECOMMENDED TO A SMOKING CESSATION PROGRAM - YES #</span>
        <span class="c1">######################################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecommended to a smoking cessation program - Yes&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% KUŘÁKŮ, JIMŽ BYL DOPORUČEN PROGRAM K ODVYKÁNÍ KOUŘENÍ&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% RECOMMENDED TO A SMOKING CESSATION PROGRAM out of smokers&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">###########################################################</span>
        <span class="c1"># % RECOMMENDED TO A CEREBROVASCULAR EXPERT - RECOMMENDED #</span>
        <span class="c1">###########################################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecommended to a cerebrovascular expert - Recommended&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PACIENTŮ ODESLANÝCH K CEREBROVASKULÁRNÍMU ODBORNÍKOVI ze všech případů&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% RECOMMENDED TO A CEREBROVASCULAR EXPERT out of all cases&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">#########################</span>
        <span class="c1"># DISCHARGE DESTINATION #</span>
        <span class="c1">#########################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Home&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Transferred within the same centre&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Transferred to another centre&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Social care facility&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Dead&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Home&#39;</span>
        

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Home&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Transferred within the same centre&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Transferred to another centre&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Social care facility&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Dead&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% MÍSTO URČENÍ U PROPUŠTĚNÍ / PŘEKLADU - DISCHARGE DESTINATION&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;domů&#39;</span><span class="p">,</span> <span class="s1">&#39;překlad v rámci stejného zdravotnického zařízení (ZZ)&#39;</span><span class="p">,</span> <span class="s1">&#39;překlad do jiného zdravotnického zařízení (ZZ)&#39;</span><span class="p">,</span> <span class="s1">&#39;zařízení sociální péče&#39;</span><span class="p">,</span> <span class="s1">&#39;zemřel/a&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% DISCHARGE DESTINATION&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;home&#39;</span><span class="p">,</span> <span class="s1">&#39;transferred within the same centre&#39;</span><span class="p">,</span> <span class="s1">&#39;transferred to another centre&#39;</span><span class="p">,</span> <span class="s1">&#39;social care facility&#39;</span><span class="p">,</span> <span class="s1">&#39;dead&#39;</span><span class="p">]</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">############################################################################</span>
        <span class="c1"># DISCHARGE DESTINATION - DEPARTMENT TRANSFERRED TO WITHIN THE SAME CENTRE #</span>
        <span class="c1">############################################################################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;% transferred within the same centre - Acute rehabilitation&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred within the same centre - Post-care bed&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred within the same centre - Another department&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% transferred within the same centre - Acute rehabilitation&#39;</span>
        

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% transferred within the same centre - Acute rehabilitation&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred within the same centre - Post-care bed&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred within the same centre - Another department&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PACIENTŮ PŘELOŽENÝCH V RÁMCI STEJNÉHO CENTRA&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Oddělení akutní rehabilitace&#39;</span><span class="p">,</span> <span class="s1">&#39;Lůžko následné péče&#39;</span><span class="p">,</span> <span class="s1">&#39;Jiné oddělení&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% DISCHARGE DESTINATION - PATIENT TRANSFERRED WITHIN THE SAME CENTRE&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Acute rehabilitation&#39;</span><span class="p">,</span> <span class="s1">&#39;Post-care bed&#39;</span><span class="p">,</span> <span class="s1">&#39;Another department&#39;</span><span class="p">]</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">####################################################</span>
        <span class="c1"># % DISCHARGE DESTINATION - CENTRE TRANSFERRED TO  #</span>
        <span class="c1">####################################################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;% transferred to another centre - Stroke centre&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred to another centre - Comprehensive stroke centre&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred to another centre - Another hospital&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% transferred to another centre - Stroke centre&#39;</span>
        

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% transferred to another centre - Stroke centre&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred to another centre - Comprehensive stroke centre&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred to another centre - Another hospital&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PACIENTŮ PŘELOŽENÝCH DO JINÉHO CENTRA&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Iktové centrum&#39;</span><span class="p">,</span> <span class="s1">&#39;Komplexní cerebrovaskulární centrum&#39;</span><span class="p">,</span> <span class="s1">&#39;Jiná nemocnice&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% DISCHARGE DESTINATION - PATIENT TRANSFERRED TO ANOTHER CENTRE&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Stroke centre&#39;</span><span class="p">,</span> <span class="s1">&#39;Comprehensive stroke centre&#39;</span><span class="p">,</span> <span class="s1">&#39;Another hospital&#39;</span><span class="p">]</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">#################################################################################</span>
        <span class="c1"># % DISCHARGE DESTINATION - DEPARTMENT TRANSFERRED TO WITHIN TO ANOTHER CENTRE  #</span>
        <span class="c1">#################################################################################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Acute rehabilitation&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Post-care bed&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Neurology&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Another department&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Acute rehabilitation&#39;</span>
        

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Acute rehabilitation&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Post-care bed&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Neurology&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Another department&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PACIENTŮ PŘELOŽENÝCH DO JINÉHO CENTRA PODLE TYPU CÍLOVÉHO ODDĚLENÍ&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Oddělení akutní rehabilitace&#39;</span><span class="p">,</span> <span class="s1">&#39;Lůžko následné péče&#39;</span><span class="p">,</span> <span class="s1">&#39;Neurologie&#39;</span><span class="p">,</span> <span class="s1">&#39;Jiné oddělení&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% DISCHARGE DESTINATION - PATIENT TRANSFERRED TO ANOTHER CENTRE (DEPARTMENT)&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Acute rehabilitation&#39;</span><span class="p">,</span> <span class="s1">&#39;Post-care bed&#39;</span><span class="p">,</span> <span class="s1">&#39;Neurology&#39;</span><span class="p">,</span> <span class="s1">&#39;Another department&#39;</span><span class="p">]</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">########################</span>
        <span class="c1"># MEDIAN DISCHARGE mRS #</span>
        <span class="c1">########################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median discharge mRS&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MEDIÁN mRS U PROPUŠTĚNÍ&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MEDIAN DISCHARGE MRS&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">###############################</span>
        <span class="c1"># MEDIAN HOSPITAL STAY (DAYS) #</span>
        <span class="c1">###############################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median hospital stay (days)&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_code</span> <span class="o">==</span> <span class="s2">&quot;CZ&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;DÉLKA POBYTU V NEMOCNICI (VE DNECH)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MEDIAN HOSPITAL STAY (DAYS)&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1"># set pptx output name (for cz it&#39;ll be presentation_CZ.pptx)</span>
        <span class="n">working_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="n">pptx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">site_code</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="o">+</span> <span class="s2">&quot;_national_comparison.pptx&quot;</span>
        <span class="n">presentation_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span> <span class="n">pptx</span><span class="p">))</span>

        <span class="n">prs</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">presentation_path</span><span class="p">)</span></div>


        


</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">RES-Q package</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Marie Jankujova.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
    </div>

    

    
  </body>
</html>