
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>resqdb.FormatData &#8212; RES-Q package January, 2019 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for resqdb.FormatData</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">File name: FormatData.py</span>
<span class="sd">Package: resq</span>
<span class="sd">Written by: Marie Jankujova - jankujova.marie@fnusa.cz on 03/2019</span>
<span class="sd">Version: v1.0</span>
<span class="sd">Version comment: This script is used to generate formatted preprocessed data, presentations or excel files. </span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># Import default packages</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">date</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>
<span class="kn">from</span> <span class="nn">xlsxwriter.utility</span> <span class="k">import</span> <span class="n">xl_rowcol_to_cell</span><span class="p">,</span> <span class="n">xl_col_to_name</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">defaultdict</span>
<span class="kn">import</span> <span class="nn">pytz</span>

<div class="viewcode-block" id="GeneratePreprocessedData"><a class="viewcode-back" href="../../source/resqdb.html#resqdb.FormatData.GeneratePreprocessedData">[docs]</a><span class="k">class</span> <span class="nc">GeneratePreprocessedData</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate preprocessed data as table. One sheet are preprocessed data, 2nd sheet are legend data.    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">split_sites</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quarter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">country_code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">csv</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create object of preprocessed data. </span>

<span class="sd">        Args:</span>
<span class="sd">            df: preprocessed data in datafraem</span>
<span class="sd">            split_sites: True if preprocessed data has to be generated per site (default: False)</span>
<span class="sd">            site: Protocol ID of site (default: None)</span>
<span class="sd">            country_code: country code (default: None)</span>
<span class="sd">            report: type of the report, eg. quarter (default: None)</span>
<span class="sd">            period: type of the period, eg. H1_2018 (default: None)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create log file in the working folder</span>
        <span class="n">log_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;debug.log&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">log_file</span><span class="p">,</span>
                            <span class="n">filemode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span>
                            <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1">,</span><span class="si">%(msecs)d</span><span class="s1"> </span><span class="si">%(name)s</span><span class="s1"> </span><span class="si">%(levelname)s</span><span class="s1"> </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
                            <span class="n">datefmt</span><span class="o">=</span><span class="s1">&#39;%H:%M:%S&#39;</span><span class="p">,</span>
                            <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">split_sites</span> <span class="o">=</span> <span class="n">split_sites</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">=</span> <span class="n">report</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="o">=</span> <span class="n">quarter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">country_code</span> <span class="o">=</span> <span class="n">country_code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">csv</span> <span class="o">=</span> <span class="n">csv</span>

        <span class="c1"># If Site is not None, filter dataset according to site code</span>
        <span class="k">if</span> <span class="n">site</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">country_code</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Protocol ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">site</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">]</span>
            <span class="c1"># Generate preprocessed data for site</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_generate_preprocessed_data</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">site_code</span><span class="o">=</span><span class="n">site</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Preprocessed data: The preprocessed data were generated for site </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site</span><span class="p">))</span>
        
        <span class="c1"># Generate formatted statistics per site + country as site is included</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">split_sites</span><span class="p">)</span> <span class="ow">and</span> <span class="n">site</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Preprocessed data: Generate preprocessed data per site.&#39;</span><span class="p">)</span>
            <span class="c1"># Get set of all site ids</span>
            <span class="n">site_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Protocol ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
            <span class="c1">#site_ids = set(site_ids)  </span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">site_ids</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Protocol ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_generate_preprocessed_data</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">site_code</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Preprocessed data: The preprocessed data were generated for site </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_generate_preprocessed_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">site_code</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Preprocessed data: The preprocessed data were generate for all data.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_generate_preprocessed_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">site_code</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate preprocessed data with legend. </span>

<span class="sd">        Keyword arguments: </span>
<span class="sd">            df = filtered dataframe</span>
<span class="sd">            site_code = code of site included in the dataframe</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">site_code</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">site_code</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="o">+</span> <span class="s2">&quot;_preprocessed_data.xlsx&quot;</span>
        <span class="k">elif</span> <span class="n">site_code</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_code</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="s2">&quot;preprocessed_data.xlsx&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_code</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="o">+</span> <span class="s2">&quot;_preprocessed_data.xlsx&quot;</span>
        
        <span class="c1">#output_file = &quot;preprocessed_data.xlsx&quot;</span>
        
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        
        <span class="c1"># Convert dates to strings</span>
        <span class="n">dateformat</span> <span class="o">=</span> <span class="s2">&quot;%m/</span><span class="si">%d</span><span class="s2">/%Y&quot;</span>
        <span class="n">timeformat</span> <span class="o">=</span> <span class="s2">&quot;%H:%M&quot;</span>
        <span class="k">def</span> <span class="nf">convert_to_string</span><span class="p">(</span><span class="n">datetime</span><span class="p">,</span> <span class="nb">format</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">datetime</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">datetime</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">datetime</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="n">csv</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">csv</span><span class="p">:</span>
            <span class="c1">#if df[&#39;VISIT_DATE&#39;].dtype != np.object:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;VISIT_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;VISIT_DATE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;VISIT_DATE&#39;</span><span class="p">],</span> <span class="n">dateformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># if df[&#39;VISIT_DATE_OLD&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;VISIT_DATE_OLD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;VISIT_DATE_OLD&#39;</span><span class="p">],</span> <span class="n">dateformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1">#if df[&#39;VISIT_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;VISIT_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;VISIT_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;HOSPITAL_DATE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;HOSPITAL_DATE&#39;</span><span class="p">],</span> <span class="n">dateformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1">#if df[&#39;HOSPITAL_DATE_OLD&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;HOSPITAL_DATE_OLD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;HOSPITAL_DATE_OLD&#39;</span><span class="p">],</span> <span class="n">dateformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1">#if df[&#39;HOSPITAL_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;HOSPITAL_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;HOSPITAL_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;DISCHARGE_DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DISCHARGE_DATE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;DISCHARGE_DATE&#39;</span><span class="p">],</span> <span class="n">dateformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1">#if df[&#39;DISCHARGE_DATE_OLD&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DISCHARGE_DATE_OLD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;DISCHARGE_DATE_OLD&#39;</span><span class="p">],</span> <span class="n">dateformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1">#if df[&#39;IVT_ONLY_ADMISSION_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;IVT_ONLY_ADMISSION_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;IVT_ONLY_ADMISSION_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1">#if df[&#39;IVT_ONLY_BOLUS_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;IVT_ONLY_BOLUS_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;IVT_ONLY_BOLUS_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1">#if df[&#39;IVT_TBY_ADMISSION_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;IVT_TBY_ADMISSION_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;IVT_TBY_ADMISSION_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1">#if df[&#39;IVT_TBY_BOLUS_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;IVT_TBY_BOLUS_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;IVT_TBY_BOLUS_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># if df[&#39;IVT_TBY_GROIN_PUNCTURE_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;IVT_TBY_GROIN_PUNCTURE_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;IVT_TBY_GROIN_PUNCTURE_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1">#if df[&#39;TBY_ONLY_ADMISSION_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;TBY_ONLY_ADMISSION_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;TBY_ONLY_ADMISSION_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1">#if df[&#39;TBY_ONLY_PUNCTURE_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;TBY_ONLY_PUNCTURE_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;TBY_ONLY_PUNCTURE_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1">#if df[&#39;IVT_TBY_REFER_ADMISSION_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;IVT_TBY_REFER_ADMISSION_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;IVT_TBY_REFER_ADMISSION_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1">#  if df[&#39;IVT_TBY_REFER_BOLUS_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;IVT_TBY_REFER_BOLUS_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;IVT_TBY_REFER_BOLUS_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1">#  if df[&#39;IVT_TBY_REFER_DISCHARGE_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;IVT_TBY_REFER_DISCHARGE_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;IVT_TBY_REFER_DISCHARGE_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># if df[&#39;TBY_REFER_DISCHARGE_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;TBY_REFER_DISCHARGE_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;TBY_REFER_DISCHARGE_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># if df[&#39;TBY_REFER_DISCHARGE_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;TBY_REFER_ADMISSION_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;TBY_REFER_ADMISSION_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
             <span class="c1"># if df[&#39;TBY_REFER_ALL_DISCHARGE_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;TBY_REFER_ALL_DISCHARGE_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;TBY_REFER_ALL_DISCHARGE_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1">#if df[&#39;TBY_REFER_ALL_ADMISSION_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;TBY_REFER_ALL_ADMISSION_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;TBY_REFER_ALL_ADMISSION_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1">#if df[&#39;TBY_REFER_LIM_DISCHARGE_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;TBY_REFER_LIM_DISCHARGE_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;TBY_REFER_LIM_DISCHARGE_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># if df[&#39;TBY_REFER_LIM_ADMISSION_TIME&#39;].dtype != np.object:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;TBY_REFER_LIM_ADMISSION_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;TBY_REFER_LIM_ADMISSION_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;CT_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;CT_TIME&#39;</span><span class="p">],</span> <span class="n">timeformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;HOSPITAL_DATE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;HOSPITAL_DATE&#39;</span><span class="p">],</span> <span class="n">dateformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DISCHARGE_DATE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;DISCHARGE_DATE&#39;</span><span class="p">],</span> <span class="n">dateformat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Replace NAN values with 0</span>
        <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Create workbook</span>
        <span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Preprocessed data: The workbook was created.&#39;</span><span class="p">)</span>
        <span class="c1"># Create worksheets</span>
        <span class="n">preprocessed_data_sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Preprocessed_raw_data&#39;</span><span class="p">)</span>
        <span class="n">legend_sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Legend_v2.0&#39;</span><span class="p">)</span>
        <span class="n">additional_desc_sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Additional_description&#39;</span><span class="p">)</span>

        <span class="c1">### PREPROCESSED DATA</span>
        <span class="n">preprocessed_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="c1"># Set width of columns</span>
        <span class="n">preprocessed_data_sheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
        <span class="c1"># Number of columns/rows</span>
        <span class="n">ncol</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">nrow</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="c1"># Create header</span>
        <span class="n">col</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">col</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

        <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">preprocessed_data</span><span class="p">,</span>
                   <span class="s1">&#39;header_row&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                   <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span>
                   <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;Table Style Light 1&#39;</span>
                   <span class="p">}</span>
        <span class="n">preprocessed_data_sheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Preprocessed data: The sheet &quot;Preprocessed data&quot; was added.&#39;</span><span class="p">)</span>

        <span class="c1">### LEGEND</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;tmp&#39;</span><span class="p">,</span> <span class="s1">&#39;legend.csv&#39;</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">legend_list</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Variable Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">,</span> <span class="s1">&#39;UNITS&#39;</span><span class="p">,</span> <span class="s1">&#39;Response Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Response Options - text&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Response Options - value&#39;</span><span class="p">]</span>

        <span class="n">legend_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">legend_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
        
        <span class="c1"># set width of columns</span>
        <span class="n">legend_sheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
        <span class="c1"># number of columns</span>
        <span class="c1"># add table into worksheet</span>
        <span class="n">ncol</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">legend_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">nrow</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">legend_df</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">legend_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="n">k</span><span class="p">]</span>
            <span class="c1"># if (i &gt;= 2):</span>
            <span class="c1">#    tmp[&#39;total_function&#39;: &#39;sum&#39;]</span>
            <span class="n">col</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

        <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">legend_list</span><span class="p">,</span>
                   <span class="s1">&#39;header_row&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                   <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span>
                   <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;Table Style Light 1&#39;</span>
                   <span class="p">}</span>
        <span class="n">legend_sheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Preprocessed data: The sheet &quot;Legend&quot; was added.&#39;</span><span class="p">)</span>

        <span class="c1">### ADDITIONAL INFO</span>
        <span class="c1"># Add table with changed column names and description</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Column names after preprocessing&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">]</span>
        <span class="n">addition_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="s1">&#39;VISIT_DATE_OLD&#39;</span><span class="p">,</span> <span class="s1">&#39;The original visit date.&#39;</span><span class="p">],</span> 
            <span class="p">[</span><span class="s1">&#39;HOSPITAL_DATE_OLD&#39;</span><span class="p">,</span> <span class="s1">&#39;The original hospital date.&#39;</span><span class="p">],</span> 
            <span class="p">[</span><span class="s1">&#39;DISCHARGE_DATE_OLD&#39;</span><span class="p">,</span> <span class="s1">&#39;The original discharge date.&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;HOSPITAL_DAYS_OLD&#39;</span><span class="p">,</span> <span class="s1">&#39;The hospital days calculated from original hospital and discharge date.&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;VISIT_DATE&#39;</span><span class="p">,</span> <span class="s1">&#39;The fixed visit date.&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;HOSPITAL_DATE&#39;</span><span class="p">,</span> <span class="s1">&#39;The fixed hospital date (fixed in the case that hospital days were negative or greater than 300 days).&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;DISCHARGE_DATE&#39;</span><span class="p">,</span> <span class="s1">&#39;The fixed discharge date (fixed in the case that hospital days were negative or greater than 300 days).&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;HOSPITAL_DAYS&#39;</span><span class="p">,</span> <span class="s1">&#39;The hospital days calculated from fixed hospital and discharge dates.&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;HOSPITAL_DAYS_FIXED&#39;</span><span class="p">,</span> <span class="s1">&#39;TRUE for fixed dates, FALSE for original dates.&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;IVT_ONLY_NEEDLE_TIME_MIN&#39;</span><span class="p">,</span> <span class="s1">&#39;The column which contains needle time in minutes (bolus time - admission time).&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;IVT_ONLY_NEEDLE_TIME_CHANGED&#39;</span><span class="p">,</span> <span class="s1">&#39;TRUE for changed times (if difference was &gt; 400, FALSE for unchanged values.&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;IVT_TBY_NEEDLE_TIME_MIN&#39;</span><span class="p">,</span> <span class="s1">&#39;The column which contains needle time in minutes (bolus time - admission time).&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;IVT_TBY_NEEDLE_TIME_CHANGED&#39;</span><span class="p">,</span> <span class="s1">&#39;TRUE for changed times (if difference was &gt; 400, FALSE for unchanged values.&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;IVT_TBY_REFER_NEEDLE_TIME_MIN&#39;</span><span class="p">,</span> <span class="s1">&#39;The column which contains needle time in minutes (bolus time - admission time).&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;IVT_TBY_REFER_NEEDLE_TIME_CHANGED&#39;</span><span class="p">,</span> <span class="s1">&#39;TRUE for changed times (if difference was &gt; 400, FALSE for unchanged values.&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;TBY_ONLY_GROIN_TIME_MIN&#39;</span><span class="p">,</span> <span class="s1">&#39;The column which contains groin time in minutes (groin time - admission time).&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;TBY_ONLY_GROIN_TIME_CHANGED&#39;</span><span class="p">,</span> <span class="s1">&#39;TRUE for changed times (if difference was &gt; 700, FALSE for unchanged values.&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;IVT_TBY_GROIN_TIME_MIN&#39;</span><span class="p">,</span> <span class="s1">&#39;The column which contains groin time in minutes (groin time - admission time).&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;IVT_TBY_GROIN_TIME_CHANGED&#39;</span><span class="p">,</span> <span class="s1">&#39;TRUE for changed times (if difference was &gt; 700, FALSE for unchanged values.&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;IVT_TBY_REFER_DIDO_TIME_MIN&#39;</span><span class="p">,</span> <span class="s1">&#39;The column which contains DIDO time in minutes (discharge time - admission time).&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;IVT_TBY_REFER_DIDO_TIME_CHANGED&#39;</span><span class="p">,</span> <span class="s1">&#39;TRUE for changed times (if difference was &gt; 700, FALSE for unchanged values.&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;TBY_REFER_DIDO_TIME_MIN&#39;</span><span class="p">,</span> <span class="s1">&#39;The column which contains DIDO time in minutes (discharge time - admission time).&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;TBY_REFER_DIDO_TIME_CHANGED&#39;</span><span class="p">,</span> <span class="s1">&#39;TRUE for changed times (if difference was &gt; 700, FALSE for unchanged values.&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;TBY_REFER_ALL_DIDO_TIME_MIN&#39;</span><span class="p">,</span> <span class="s1">&#39;The column which contains DIDO time in minutes (discharge time - admission time).&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;TBY_REFER_ALL_DIDO_TIME_CHANGED&#39;</span><span class="p">,</span> <span class="s1">&#39;TRUE for changed times (if difference was &gt; 700, FALSE for unchanged values.&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;TBY_REFER_LIM_DIDO_TIME_MIN&#39;</span><span class="p">,</span> <span class="s1">&#39;The column which contains DIDO time in minutes (discharge time - admission time).&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;TBY_REFER_LIM_DIDO_TIME_CHANGED&#39;</span><span class="p">,</span> <span class="s1">&#39;TRUE for changed times (if difference was &gt; 700, FALSE for unchanged values.&#39;</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="c1"># set width of columns</span>
        <span class="n">additional_desc_sheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>

        <span class="n">addition_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">addition_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
        <span class="n">ncol</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">addition_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">nrow</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">addition_df</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">addition_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="n">k</span><span class="p">]</span>
            <span class="c1"># if (i &gt;= 2):</span>
            <span class="c1">#    tmp[&#39;total_function&#39;: &#39;sum&#39;]</span>
            <span class="n">col</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

        <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">addition_list</span><span class="p">,</span>
                   <span class="s1">&#39;header_row&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                   <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span>
                   <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;Table Style Light 1&#39;</span>
                   <span class="p">}</span>

        <span class="n">additional_desc_sheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Preprocessed data: The sheet &quot;Additional info&quot; was added.&#39;</span><span class="p">)</span>
    
        <span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="GenerateFormattedAngelsAwards"><a class="viewcode-back" href="../../source/resqdb.html#resqdb.FormatData.GenerateFormattedAngelsAwards">[docs]</a><span class="k">class</span> <span class="nc">GenerateFormattedAngelsAwards</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class generate formatted statistics only for angels awards. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quarter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minimum_patients</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">=</span> <span class="n">report</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="o">=</span> <span class="n">quarter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minimum_patients</span> <span class="o">=</span> <span class="n">minimum_patients</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">formate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>

<div class="viewcode-block" id="GenerateFormattedAngelsAwards.formate"><a class="viewcode-back" href="../../source/resqdb.html#resqdb.FormatData.GenerateFormattedAngelsAwards.formate">[docs]</a>    <span class="k">def</span> <span class="nf">formate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="s2">&quot;angels_awards.xslx&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="o">+</span> <span class="s2">&quot;_angels_awards.xlsx&quot;</span>
            

        <span class="n">workbook1</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;strings_to_numbers&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
        <span class="c1"># create worksheet</span>
        <span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

        <span class="c1"># set width of columns</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>

        <span class="n">ncol</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">nrow</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>

        <span class="n">col</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span> <span class="o">=</span><span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">col</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

        <span class="n">statistics</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;angel_awards&quot;</span><span class="p">:</span> <span class="s2">&quot;#B87333&quot;</span><span class="p">,</span>
            <span class="s2">&quot;angel_resq_awards&quot;</span><span class="p">:</span> <span class="s2">&quot;#341885&quot;</span><span class="p">,</span>
            <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="s2">&quot;#3378B8&quot;</span><span class="p">,</span>
            <span class="s2">&quot;green&quot;</span><span class="p">:</span> <span class="s2">&quot;#A1CCA1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;orange&quot;</span><span class="p">:</span> <span class="s2">&quot;#DF7401&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gold&quot;</span><span class="p">:</span> <span class="s2">&quot;#FFDF00&quot;</span><span class="p">,</span>
            <span class="s2">&quot;platinum&quot;</span><span class="p">:</span> <span class="s2">&quot;#c0c0c0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;black&quot;</span><span class="p">:</span> <span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span>
            <span class="s2">&quot;red&quot;</span><span class="p">:</span> <span class="s2">&quot;#F45D5D&quot;</span>
        <span class="p">}</span>

        <span class="c1">################</span>
        <span class="c1"># angel awards #</span>
        <span class="c1">################</span>
        <span class="n">awards</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;angel_awards&quot;</span><span class="p">)})</span>

        <span class="n">awards_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;angel_awards&quot;</span><span class="p">)})</span>

        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ncol</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;ESO ANGELS AWARDS&#39;</span><span class="p">,</span> <span class="n">awards</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">awards_color</span><span class="p">)</span>

        <span class="c1"># format for green color</span>
        <span class="n">green</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;green&quot;</span><span class="p">)})</span>

        <span class="c1"># format for gold color</span>
        <span class="n">gold</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gold&quot;</span><span class="p">)})</span>

        <span class="c1"># format for platinum color</span>
        <span class="n">plat</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;platinum&quot;</span><span class="p">)})</span>

        <span class="c1"># format for gold black</span>
        <span class="n">black</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#000000&#39;</span><span class="p">,</span>
            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;black&quot;</span><span class="p">)})</span>

        <span class="c1"># format for red color</span>
        <span class="n">red</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">)})</span>


        <span class="c1"># add table into worksheet</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">statistics</span><span class="p">,</span>
                   <span class="s1">&#39;header_row&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                   <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span>
                   <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;Table Style Light 8&#39;</span>
                   <span class="p">}</span>

        <span class="n">first_col</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">last_col</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">ncol</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="n">first_col</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_col</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

        <span class="c1"># total number of rows</span>
        <span class="n">number_of_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">statistics</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">total_patients_column</span> <span class="o">=</span> <span class="s1">&#39;# total patients &gt;= </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minimum_patients</span><span class="p">)</span>
        <span class="c1"># if cell contain TRUE in column &gt; 30 patients (DR) it will be colored to green</span>
        <span class="n">awards</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">nrow</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_patients_column</span><span class="p">)</span>
            <span class="n">cell_n</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;containing&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;TRUE&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">green</span><span class="p">})</span>
            <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


        <span class="k">def</span> <span class="nf">angels_awards_ivt_60</span><span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">coln</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Add conditional formatting to angels awards for ivt &lt; 60.&quot;&quot;&quot;</span>
            <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                                                    <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mf">74.99</span><span class="p">,</span>
                                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">gold</span><span class="p">})</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span>
                                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">black</span><span class="p">})</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients treated with door to thrombolysis &lt; 60 minutes&#39;</span><span class="p">)</span>
        <span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">angels_awards_ivt_60</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients treated with door to thrombectomy &lt; 90 minutes&#39;</span><span class="p">)</span>
        <span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">angels_awards_ivt_60</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

        <span class="c1"># angels_awards_ivt_60(&#39;D&#39;)</span>


        <span class="k">def</span> <span class="nf">angels_awards_ivt_45</span><span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">coln</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Add conditional formatting to angels awards for ivt &lt; 45.&quot;&quot;&quot;</span>
            <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">49.99</span><span class="p">,</span>
                                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">plat</span><span class="p">})</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">black</span><span class="p">})</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients treated with door to thrombolysis &lt; 45 minutes&#39;</span><span class="p">)</span>
        <span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">angels_awards_ivt_45</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients treated with door to thrombectomy &lt; 60 minutes&#39;</span><span class="p">)</span>
        <span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">angels_awards_ivt_45</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

        <span class="c1"># setting colors of cells according to their values</span>
        <span class="k">def</span> <span class="nf">angels_awards_recan</span><span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">coln</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Add conditional formatting to angels awards for recaalization procedures.&quot;&quot;&quot;</span>
            <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                                                    <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mf">14.99</span><span class="p">,</span>
                                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">gold</span><span class="p">})</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                                                    <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mf">24.99</span><span class="p">,</span>
                                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">plat</span><span class="p">})</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
                                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">black</span><span class="p">})</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization rate out of total ischemic incidence&#39;</span><span class="p">)</span>
        <span class="n">angels_awards_recan</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">),</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
        <span class="c1">#angels_awards_recan(&#39;F&#39;)</span>


        <span class="k">def</span> <span class="nf">angels_awards_processes</span><span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">coln</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Add conditional formatting to angels awards for processes.&quot;&quot;&quot;</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">count</span>
            <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
                                                    <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mf">84.99</span><span class="p">,</span>
                                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">gold</span><span class="p">})</span>

                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">85</span><span class="p">,</span>
                                                    <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mf">89.99</span><span class="p">,</span>
                                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">plat</span><span class="p">})</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span>
                                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">black</span><span class="p">})</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% s</span><span class="s1">uspected stroke patients undergoing CT/MRI&#39;</span><span class="p">)</span>
        <span class="n">angels_awards_processes</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">),</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% all stroke patients undergoing dysphagia screening&#39;</span><span class="p">)</span>
        <span class="n">angels_awards_processes</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">),</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% i</span><span class="s1">schemic stroke patients discharged (home) with antiplatelets&#39;</span><span class="p">)</span>
        <span class="n">angels_awards_processes</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">),</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% afib patients discharged (home) with anticoagulants&#39;</span><span class="p">)</span>
        <span class="n">angels_awards_processes</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">),</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

        <span class="c1">#angels_awards_processes(&#39;G&#39;, 4)</span>
        <span class="c1">#angels_awards_processes(&#39;H&#39;, 5)</span>
        <span class="c1">#angels_awards_processes(&#39;I&#39;, 6)</span>
        <span class="c1">#angels_awards_processes(&#39;J&#39;, 7)</span>

        <span class="c1"># setting colors of cells according to their values</span>
        <span class="k">def</span> <span class="nf">angels_awards_hosp</span><span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">coln</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Add conditional formatting to angels awards for hospitalization.&quot;&quot;&quot;</span>
            <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">plat</span><span class="p">})</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">0.99</span><span class="p">,</span>
                                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">black</span><span class="p">})</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

        
        <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke patients treated in a dedicated stroke unit / ICU&#39;</span><span class="p">)</span>
        <span class="n">angels_awards_hosp</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">),</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

        
        <span class="c1"># set color for proposed angel award</span>
        <span class="k">def</span> <span class="nf">proposed_award</span><span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">coln</span><span class="p">):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">nrow</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;containing&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;NONE&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">green</span><span class="p">})</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">nrow</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;containing&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;GOLD&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">gold</span><span class="p">})</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">nrow</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;containing&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;PLATINUM&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">plat</span><span class="p">})</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">nrow</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;containing&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;DIAMOND&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">black</span><span class="p">})</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Proposed Award&#39;</span><span class="p">)</span>
        <span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">proposed_award</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
        <span class="c1">#worksheet.write_column(3, index, awards)</span>

        <span class="n">workbook1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="GenerateFormattedStats"><a class="viewcode-back" href="../../source/resqdb.html#resqdb.FormatData.GenerateFormattedStats">[docs]</a><span class="k">class</span> <span class="nc">GenerateFormattedStats</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class generate formatted statistics in .xslx file. For angel awards are set colored conditions. </span>
<span class="sd">    </span>
<span class="sd">    Keyword arguments:</span>
<span class="sd">        df: the dataframe with statistcs</span>
<span class="sd">        country: True if country should be included as site (default: False)</span>
<span class="sd">        country_code: the code of country (default: None)</span>
<span class="sd">        split_sites: True if you want to generate individual file fo each site (default: False)</span>
<span class="sd">        site: the site code (default: None)</span>
<span class="sd">        report: the report name (default: None)</span>
<span class="sd">        quarter: the quarter name (default: None)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">country_code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">split_sites</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quarter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">minimum_patients</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">df_unformatted</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">country_code</span> <span class="o">=</span> <span class="n">country_code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">=</span> <span class="n">report</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="o">=</span> <span class="n">quarter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comp</span> <span class="o">=</span> <span class="n">comp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minimum_patients</span> <span class="o">=</span> <span class="n">minimum_patients</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_patients_column</span> <span class="o">=</span> <span class="s1">&#39;# total patients &gt;= </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minimum_patients</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">delete_columns</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="n">i</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># Drop tmp column </span>
        <span class="n">delete_columns</span><span class="p">([</span><span class="s1">&#39;isch_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;is_ich_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;is_ich_tia_cvt_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;is_ich_cvt_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;is_tia_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;is_ich_sah_cvt_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;is_tia_cvt_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;cvt_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;ich_sah_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;ich_patients&#39;</span><span class="p">,</span>  <span class="s1">&#39;sah_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;discharge_subset_patients&#39;</span><span class="p">,</span><span class="s1">&#39;discharge_subset_alive_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;neurosurgery_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;not_reffered_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;reffered_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;afib_detected_during_hospitalization_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;afib_not_detected_or_not_known_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;antithrombotics_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;ischemic_transient_dead_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;afib_flutter_not_detected_or_not_known_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;afib_flutter_not_detected_or_not_known_dead_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;prescribed_antiplatelets_no_afib_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;prescribed_antiplatelets_no_afib_dead_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;afib_flutter_detected_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;anticoagulants_recommended_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;afib_flutter_detected_dead_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;recommended_antithrombotics_with_afib_alive_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;discharge_subset_same_centre_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;discharge_subset_another_centre_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;patients_eligible_recanalization&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients having stroke in the hospital - No&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients having stroke in the hospital - No&#39;</span><span class="p">,</span> <span class="s1">&#39;# recurrent stroke - No&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecurrent stroke - No&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients assessed for rehabilitation - Not known&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients assessed for rehabilitation - Not known&#39;</span><span class="p">,</span> <span class="s1">&#39;# level of consciousness - not known&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% le</span><span class="s1">vel of consciousness - not known&#39;</span><span class="p">,</span> <span class="s1">&#39;# CT/MRI - Performed later than 1 hour after admission&#39;</span><span class="p">,</span> <span class="s1">&#39;% CT/MRI - Performed later than 1 hour after admission&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients put on ventilator - Not known&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients put on ventilator - Not known&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients put on ventilator - No&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients put on ventilator - No&#39;</span><span class="p">,</span> <span class="s1">&#39;# IV tPa&#39;</span><span class="p">,</span> <span class="s1">&#39;% IV tPa&#39;</span><span class="p">,</span> <span class="s1">&#39;# TBY&#39;</span><span class="p">,</span> <span class="s1">&#39;% TBY&#39;</span><span class="p">,</span> <span class="s1">&#39;# DIDO TBY&#39;</span><span class="p">,</span> <span class="s1">&#39;# dysphagia screening - not known&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - not known&#39;</span><span class="p">,</span> <span class="s1">&#39;# dysphagia screening time - After first 24 hours&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening time - After first 24 hours&#39;</span><span class="p">,</span> <span class="s1">&#39;# other afib detection method - Not detected or not known&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% o</span><span class="s1">ther afib detection method - Not detected or not known&#39;</span><span class="p">,</span> <span class="s1">&#39;# carotid arteries imaging - Not known&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid arteries imaging - Not known&#39;</span><span class="p">,</span> <span class="s1">&#39;# carotid arteries imaging - No&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid arteries imaging - No&#39;</span><span class="p">,</span> <span class="s1">&#39;vascular_imaging_cta_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vascular_imaging_mra_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vascular_imaging_dsa_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vascular_imaging_none_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_arterial_hypertension_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_aneurysm_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_arterio_venous_malformation_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_anticoagulation_therapy_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_amyloid_angiopathy_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_other_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_endovascular_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_neurosurgical_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_other_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_referred_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_none_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vt_treatment_anticoagulation_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vt_treatment_thrombectomy_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vt_treatment_local_thrombolysis_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vt_treatment_local_neurological_treatment_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;except_recommended_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;afib_detected_discharged_home_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening done&#39;</span><span class="p">,</span> <span class="s1">&#39;# dysphagia screening done&#39;</span><span class="p">,</span> <span class="s1">&#39;alert_all&#39;</span><span class="p">,</span> <span class="s1">&#39;alert_all_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;drowsy_all&#39;</span><span class="p">,</span> <span class="s1">&#39;drowsy_all_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;comatose_all&#39;</span><span class="p">,</span> <span class="s1">&#39;comatose_all_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;antithrombotics_patients_with_cvt&#39;</span><span class="p">,</span> <span class="s1">&#39;ischemic_transient_cerebral_dead_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients receiving antiplatelets with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving antiplatelets with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients receiving Vit. K antagonist with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving Vit. K antagonist with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients receiving dabigatran with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving dabigatran with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients receiving rivaroxaban with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving rivaroxaban with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients receiving apixaban with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving apixaban with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients receiving edoxaban with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving edoxaban with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients receiving LMWH or heparin in prophylactic dose with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving LMWH or heparin in prophylactic dose with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients receiving LMWH or heparin in full anticoagulant dose with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving LMWH or heparin in full anticoagulant dose with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients not prescribed antithrombotics, but recommended with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients not prescribed antithrombotics, but recommended with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients neither receiving antithrombotics nor recommended with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients neither receiving antithrombotics nor recommended with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients prescribed antithrombotics with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients prescribed antithrombotics with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients prescribed or recommended antithrombotics with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients prescribed or recommended antithrombotics with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;afib_flutter_not_detected_or_not_known_patients_with_cvt&#39;</span><span class="p">,</span> <span class="s1">&#39;afib_flutter_not_detected_or_not_known_dead_patients_with_cvt&#39;</span><span class="p">,</span> <span class="s1">&#39;prescribed_antiplatelets_no_afib_patients_with_cvt&#39;</span><span class="p">,</span> <span class="s1">&#39;prescribed_antiplatelets_no_afib_dead_patients_with_cvt&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients prescribed antiplatelets without aFib with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients prescribed antiplatelets without aFib with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;afib_flutter_detected_patients_with_cvt&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients prescribed anticoagulants with aFib with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;anticoagulants_recommended_patients_with_cvt&#39;</span><span class="p">,</span> <span class="s1">&#39;afib_flutter_detected_dead_patients_with_cvt&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients prescribed anticoagulants with aFib with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients prescribed antithrombotics with aFib with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;recommended_antithrombotics_with_afib_alive_patients_with_cvt&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients prescribed antithrombotics with aFib with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;afib_flutter_detected_patients_not_dead&#39;</span><span class="p">,</span> <span class="s1">&#39;except_recommended_discharged_home_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;afib_detected_discharged_patients&#39;</span><span class="p">,</span> <span class="s1">&#39;ischemic_transient_dead_patients_prescribed&#39;</span><span class="p">,</span> <span class="s1">&#39;is_tia_discharged_home_patients&#39;</span><span class="p">])</span>

        <span class="c1"># Connect to database and get country name according to country code.</span>
        <span class="k">def</span> <span class="nf">select_country</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="n">country_name</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">country_names</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">country_name</span>

        <span class="c1"># If country is used as site, the country name is selected from countries dictionary by country code. :) </span>
        <span class="k">if</span> <span class="p">(</span><span class="n">country</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_code</span> <span class="o">==</span> <span class="s1">&#39;UZB&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">country_code</span> <span class="o">=</span> <span class="s1">&#39;UZ&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span> <span class="o">=</span> <span class="n">select_country</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">country_code</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># If split_sites is True, then go through dataframe and generate graphs for each site (the country will be included as site in each file).</span>
        <span class="n">site_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Site ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="c1"># Delete country name from side ids list.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">site_ids</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
       
        <span class="k">if</span> <span class="n">site</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Site ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">site</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">])]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">df_unformatted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_unformatted</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df_unformatted</span><span class="p">[</span><span class="s1">&#39;Site ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">site</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">])]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_generate_formatted_statistics</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">df_tmp</span><span class="o">=</span><span class="n">df_unformatted</span><span class="p">,</span> <span class="n">site_code</span><span class="o">=</span><span class="n">site</span><span class="p">)</span>

        <span class="c1"># Generate formatted statistics for all sites individualy + country as site is included</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">split_sites</span><span class="p">)</span> <span class="ow">and</span> <span class="n">site</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">site_ids</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Site ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">])]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">df_unformatted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_unformatted</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df_unformatted</span><span class="p">[</span><span class="s1">&#39;Site ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">])]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_generate_formatted_statistics</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">df_tmp</span><span class="o">=</span><span class="n">df_unformatted</span><span class="p">,</span> <span class="n">site_code</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    
        <span class="c1"># Produce formatted statistics for all sites + country as site</span>
        <span class="k">if</span> <span class="n">site</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_generate_formatted_statistics</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">df_tmp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df_unformatted</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_generate_formatted_statistics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">df_tmp</span><span class="p">,</span> <span class="n">site_code</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate formatted statistics in xlsx file.</span>
<span class="sd">        </span>
<span class="sd">        Keyword arguments:</span>
<span class="sd">            df: the dataframe with statistics containing only necessary columns</span>
<span class="sd">            df_tmp: the dataframe with statistics containing all calculation</span>
<span class="sd">            site_code: the code of site (default: NOne)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_code</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">site_code</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name_of_unformatted_stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span>
            <span class="n">name_of_output_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="o">+</span> <span class="s2">&quot;.xlsx&quot;</span>
        <span class="k">elif</span> <span class="n">site_code</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name_of_unformatted_stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_code</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span>
            <span class="n">name_of_output_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_code</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="o">+</span> <span class="s2">&quot;.xlsx&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># self.report + &quot;_&quot; + site_code + &quot;_&quot; + self.quarter + &quot;.csv&quot;</span>
            <span class="c1"># self.report + &quot;_&quot; + site_code + &quot;_&quot; + self.quarter + &quot;.xlsx&quot;</span>
            <span class="n">name_of_unformatted_stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">site_code</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span>
            <span class="n">name_of_output_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">site_code</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="o">+</span> <span class="s2">&quot;.xlsx&quot;</span>

        <span class="n">df_tmp</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">name_of_unformatted_stats</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">workbook1</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">name_of_output_file</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;strings_to_numbers&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
        <span class="c1"># create worksheet</span>
        <span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

        <span class="c1"># set width of columns</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
        <span class="c1"># number of columns</span>
        
        <span class="n">ncol</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
       <span class="c1"># print(ncol)</span>

        <span class="c1"># number of rows</span>
        <span class="n">nrow</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>

        <span class="n">column_names</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">col</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">col</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

        <span class="c1">#df = statistics[0:nrow]</span>
        <span class="c1"># print(statistics)</span>

        <span class="n">statistics</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="c1">########################</span>
        <span class="c1"># DICTIONARY OF COLORS #</span>
        <span class="c1">########################</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="s2">&quot;#477187&quot;</span><span class="p">,</span>
            <span class="s2">&quot;stroke_hosp&quot;</span><span class="p">:</span> <span class="s2">&quot;#535993&quot;</span><span class="p">,</span>
            <span class="s2">&quot;recurrent_stroke&quot;</span><span class="p">:</span> <span class="s2">&quot;#D4B86A&quot;</span><span class="p">,</span>
            <span class="s2">&quot;department_type&quot;</span><span class="p">:</span> <span class="s2">&quot;#D4A46A&quot;</span><span class="p">,</span>
            <span class="s2">&quot;hospitalization&quot;</span><span class="p">:</span> <span class="s2">&quot;#D4916A&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rehab&quot;</span><span class="p">:</span> <span class="s2">&quot;#D4BA6A&quot;</span><span class="p">,</span>
            <span class="s2">&quot;stroke&quot;</span><span class="p">:</span> <span class="s2">&quot;#565595&quot;</span><span class="p">,</span>
            <span class="s2">&quot;consciousness&quot;</span><span class="p">:</span> <span class="s2">&quot;#468B78&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gcs&quot;</span><span class="p">:</span> <span class="s2">&quot;#B9D6C1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nihss&quot;</span><span class="p">:</span> <span class="s2">&quot;#C5D068&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ct_mri&quot;</span><span class="p">:</span> <span class="s2">&quot;#AA8739&quot;</span><span class="p">,</span>
            <span class="s2">&quot;vasc_img&quot;</span><span class="p">:</span> <span class="s2">&quot;#277650&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ventilator&quot;</span><span class="p">:</span> <span class="s2">&quot;#AA5039&quot;</span><span class="p">,</span>
            <span class="s2">&quot;recanalization_procedure&quot;</span><span class="p">:</span> <span class="s2">&quot;#7F4C91&quot;</span><span class="p">,</span>
            <span class="s2">&quot;median_times&quot;</span><span class="p">:</span> <span class="s2">&quot;#BEBCBC&quot;</span><span class="p">,</span>
            <span class="s2">&quot;dysphagia&quot;</span><span class="p">:</span> <span class="s2">&quot;#F49B5B&quot;</span><span class="p">,</span>
            <span class="s2">&quot;hemicraniectomy&quot;</span><span class="p">:</span> <span class="s2">&quot;#A3E4D7&quot;</span><span class="p">,</span>
            <span class="s2">&quot;neurosurgery&quot;</span><span class="p">:</span> <span class="s2">&quot;#F8C471&quot;</span><span class="p">,</span>
            <span class="s2">&quot;neurosurgery_type&quot;</span><span class="p">:</span> <span class="s2">&quot;#CACFD2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;bleeding_reason&quot;</span><span class="p">:</span> <span class="s2">&quot;#CB4335&quot;</span><span class="p">,</span>
            <span class="s2">&quot;bleeding_source&quot;</span><span class="p">:</span> <span class="s2">&quot;#9B59B6&quot;</span><span class="p">,</span>
            <span class="s2">&quot;intervention&quot;</span><span class="p">:</span> <span class="s2">&quot;#5DADE2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;vt_treatment&quot;</span><span class="p">:</span> <span class="s2">&quot;#F5CBA7&quot;</span><span class="p">,</span>
            <span class="s2">&quot;afib&quot;</span><span class="p">:</span> <span class="s2">&quot;#A2C3F3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;carot&quot;</span><span class="p">:</span> <span class="s2">&quot;#F1C40F&quot;</span><span class="p">,</span>
            <span class="s2">&quot;antithrombotics&quot;</span><span class="p">:</span> <span class="s2">&quot;#B5E59F&quot;</span><span class="p">,</span>
            <span class="s2">&quot;statin&quot;</span><span class="p">:</span> <span class="s2">&quot;#28B463&quot;</span><span class="p">,</span>
            <span class="s2">&quot;carotid_stenosis&quot;</span><span class="p">:</span> <span class="s2">&quot;#B9D6C1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;carot_foll&quot;</span><span class="p">:</span> <span class="s2">&quot;#BFC9CA&quot;</span><span class="p">,</span>
            <span class="s2">&quot;antihypertensive&quot;</span><span class="p">:</span> <span class="s2">&quot;#7C7768&quot;</span><span class="p">,</span>
            <span class="s2">&quot;smoking&quot;</span><span class="p">:</span> <span class="s2">&quot;#F9C991&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cerebrovascular&quot;</span><span class="p">:</span> <span class="s2">&quot;#91C09E&quot;</span><span class="p">,</span>
            <span class="s2">&quot;discharge_destination&quot;</span><span class="p">:</span> <span class="s2">&quot;#C0EFF5&quot;</span><span class="p">,</span>
            <span class="s2">&quot;discharge_destination_same_centre&quot;</span><span class="p">:</span> <span class="s2">&quot;#56A3A6&quot;</span><span class="p">,</span>
            <span class="s2">&quot;discharge_destination_another_centre&quot;</span><span class="p">:</span> <span class="s2">&quot;#E8DF9C&quot;</span><span class="p">,</span>
            <span class="s2">&quot;discharge_destination_within_another_centre&quot;</span><span class="p">:</span> <span class="s2">&quot;#538083&quot;</span><span class="p">,</span>
            <span class="s2">&quot;angel_awards&quot;</span><span class="p">:</span> <span class="s2">&quot;#B87333&quot;</span><span class="p">,</span>
            <span class="s2">&quot;angel_resq_awards&quot;</span><span class="p">:</span> <span class="s2">&quot;#341885&quot;</span><span class="p">,</span>
            <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="s2">&quot;#3378B8&quot;</span><span class="p">,</span>
            <span class="s2">&quot;green&quot;</span><span class="p">:</span> <span class="s2">&quot;#A1CCA1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;orange&quot;</span><span class="p">:</span> <span class="s2">&quot;#DF7401&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gold&quot;</span><span class="p">:</span> <span class="s2">&quot;#FFDF00&quot;</span><span class="p">,</span>
            <span class="s2">&quot;platinum&quot;</span><span class="p">:</span> <span class="s2">&quot;#c0c0c0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;black&quot;</span><span class="p">:</span> <span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span>
            <span class="s2">&quot;red&quot;</span><span class="p">:</span> <span class="s2">&quot;#F45D5D&quot;</span>
        <span class="p">}</span>

        <span class="c1">#statistics = statistics[1:nrow]</span>

        <span class="c1">##########</span>
        <span class="c1"># GENDER #</span>
        <span class="c1">##########</span>
        <span class="c1"># set formatting for gender</span>
        <span class="n">gender</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gender&quot;</span><span class="p">)})</span>

        <span class="n">gender_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gender&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# patients female&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients male&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>
        <span class="c1">#worksheet.merge_range(&#39;E1:H1&#39;, &#39;GENDER&#39;, gender)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;GENDER&#39;</span><span class="p">,</span> <span class="n">gender</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # total patients&#39;</span><span class="p">,</span> <span class="n">gender_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">gender_color</span><span class="p">)</span>

        <span class="c1">##########################</span>
        <span class="c1"># STROKE IN THE HOSPITAL #</span>
        <span class="c1">##########################</span>
        <span class="n">stroke_hosp</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;stroke_hosp&quot;</span><span class="p">)})</span>

        <span class="n">stroke_hosp_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;stroke_hosp&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# patients having stroke in the hospital - Yes&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients having stroke in the hospital - Yes&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;STROKE IN THE HOSPITAL&#39;</span><span class="p">,</span> <span class="n">stroke_hosp</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # total patients&#39;</span><span class="p">,</span> <span class="n">stroke_hosp_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">stroke_hosp_color</span><span class="p">)</span>

        <span class="c1">####################</span>
        <span class="c1"># RECURRENT STROKE #</span>
        <span class="c1">####################</span>
        <span class="c1"># set formatting for recurrent stroke</span>
        <span class="n">recurrent_stroke</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;recurrent_stroke&quot;</span><span class="p">)})</span>

        <span class="n">recurrent_stroke_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;recurrent_stroke&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# recurrent stroke - Yes&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecurrent stroke - Yes&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;RECURRENT STROKE&#39;</span><span class="p">,</span> <span class="n">recurrent_stroke</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # total patients&#39;</span><span class="p">,</span> <span class="n">recurrent_stroke_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">recurrent_stroke_color</span><span class="p">)</span>

        <span class="c1">###################</span>
        <span class="c1"># DEPARTMENT TYPE #</span>
        <span class="c1">###################</span>

        <span class="n">department_type</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;department_type&quot;</span><span class="p">)})</span>

        <span class="n">department_type_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;department_type&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# department type - neurology&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - Other&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;DEPARTMENT TYPE&#39;</span><span class="p">,</span> <span class="n">department_type</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # total patients&#39;</span><span class="p">,</span> <span class="n">department_type_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">department_type_color</span><span class="p">)</span>
        
        <span class="c1">###################</span>
        <span class="c1"># HOSPITALIZATION #</span>
        <span class="c1">###################</span>

        <span class="n">hospitalization</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;hospitalization&quot;</span><span class="p">)})</span>

        <span class="n">hospitalization_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;hospitalization&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# patients hospitalized in stroke unit / ICU&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients hospitalized in standard bed&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;HOSPITALIZATION&#39;</span><span class="p">,</span> <span class="n">hospitalization</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # total patients&#39;</span><span class="p">,</span> <span class="n">hospitalization_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">hospitalization_color</span><span class="p">)</span>

        <span class="c1">#############################</span>
        <span class="c1"># REHABILITATION ASSESSMENT #</span>
        <span class="c1">#############################</span>

        <span class="n">rehab_assess</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rehab&quot;</span><span class="p">)})</span>

        <span class="n">rehab_assess_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rehab&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# patients assessed for rehabilitation - Yes&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients assessed for rehabilitation - No&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;REHABILITATION ASSESSMENT&#39;</span><span class="p">,</span> <span class="n">rehab_assess</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # total patients&#39;</span><span class="p">,</span> <span class="n">rehab_assess_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">rehab_assess_color</span><span class="p">)</span>

        <span class="c1">###############</span>
        <span class="c1"># STROKE TYPE #</span>
        <span class="c1">###############</span>
        <span class="n">stroke_type</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;stroke&quot;</span><span class="p">)})</span>

        <span class="n">stroke_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;stroke&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>


        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# stroke type - ischemic stroke&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - undetermined stroke&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;STROKE TYPE&#39;</span><span class="p">,</span> <span class="n">stroke_type</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # total patients&#39;</span><span class="p">,</span> <span class="n">stroke_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">stroke_color</span><span class="p">)</span>

        <span class="c1">#######################</span>
        <span class="c1"># CONSCIOUSNESS LEVEL #</span>
        <span class="c1">#######################</span>

        <span class="n">consciousness_level</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;consciousness&quot;</span><span class="p">)})</span>

        <span class="n">consciousness_level_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;consciousness&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# level of consciousness - alert&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% le</span><span class="s1">vel of consciousness - GCS&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;CONSCIOUSNESS LEVEL&#39;</span><span class="p">,</span> <span class="n">consciousness_level</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # ischemic + ICH&#39;</span><span class="p">,</span> <span class="n">consciousness_level_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">consciousness_level_color</span><span class="p">)</span>

        <span class="c1">#######</span>
        <span class="c1"># GCS #</span>
        <span class="c1">#######</span>

        <span class="n">gcs</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcs&quot;</span><span class="p">)})</span>

        <span class="n">gcs_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcs&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# GCS - 15-13&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% G</span><span class="s1">CS - &lt;8&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;GLASGOW COMA SCALE&#39;</span><span class="p">,</span> <span class="n">gcs</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # ischemic + ICH&#39;</span><span class="p">,</span> <span class="n">gcs_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">gcs_color</span><span class="p">)</span>

        <span class="c1">#########</span>
        <span class="c1"># NIHSS #</span>
        <span class="c1">#########</span>
        <span class="n">nihss</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nihss&quot;</span><span class="p">)})</span>

        <span class="n">nihss_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nihss&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# NIHSS - Not performed&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;NIHSS median score&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;NIHSS&#39;</span><span class="p">,</span> <span class="n">nihss</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # ischemic + ICH + CVT&#39;</span><span class="p">,</span> <span class="n">nihss_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">nihss_color</span><span class="p">)</span>

        <span class="c1">##########</span>
        <span class="c1"># CT/MRI #</span>
        <span class="c1">##########</span>
        <span class="n">ct_mri</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ct_mri&quot;</span><span class="p">)})</span>

        <span class="n">ct_mri_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ct_mri&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# CT/MRI - Not performed&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% CT/MRI - Performed within 1 hour after admission&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;CT/MRI&#39;</span><span class="p">,</span> <span class="n">ct_mri</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # CT/MRI performed&#39;</span><span class="p">,</span> <span class="n">ct_mri_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ct_mri_color</span><span class="p">)</span>

        <span class="c1">####################</span>
        <span class="c1"># VASCULAR IMAGING #</span>
        <span class="c1">####################</span>
        <span class="n">vascular_imaging</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vasc_img&quot;</span><span class="p">)})</span>

        <span class="n">vascular_imaging_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vasc_img&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# vascular imaging - CTA&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% vascular imaging - two modalities&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;VASCULAR IMAGING&#39;</span><span class="p">,</span> <span class="n">vascular_imaging</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # ICH + SAH&#39;</span><span class="p">,</span> <span class="n">vascular_imaging_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">vascular_imaging_color</span><span class="p">)</span>

        <span class="c1">##############</span>
        <span class="c1"># VENTILATOR #</span>
        <span class="c1">##############</span>
        <span class="n">ventilator</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ventilator&quot;</span><span class="p">)})</span>

        <span class="n">ventilator_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ventilator&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# patients put on ventilator - Yes&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients put on ventilator - Yes&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;VENTILATOR&#39;</span><span class="p">,</span> <span class="n">ventilator</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # IS + ICH + CVT&#39;</span><span class="p">,</span> <span class="n">ventilator_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ventilator_color</span><span class="p">)</span>

        <span class="c1">#############################</span>
        <span class="c1"># RECANALIZATION PROCEDURES #</span>
        <span class="c1">#############################</span>
        <span class="n">recanalization_procedures</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;recanalization_procedure&quot;</span><span class="p">)})</span>

        <span class="n">recanalization_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;recanalization_procedure&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>


        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# recanalization procedures - Not done&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Returned to the initial centre after recanalization procedures were performed at another centre&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;RECANALIZATION PROCEDURES&#39;</span><span class="p">,</span> <span class="n">recanalization_procedures</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # ischemic stroke&#39;</span><span class="p">,</span> <span class="n">recanalization_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">recanalization_color</span><span class="p">)</span>

        <span class="c1">################</span>
        <span class="c1"># MEDIAN TIMES #</span>
        <span class="c1">################</span>
        <span class="n">median_times</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;median_times&quot;</span><span class="p">)})</span>

        <span class="n">median_times_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;median_times&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Median DTN (minutes)&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Median TBY DIDO (minutes)&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;MEDIAN TIMES (minutes)&#39;</span><span class="p">,</span> <span class="n">median_times</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">median_times_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">median_times_color</span><span class="p">)</span>

        <span class="c1">#############</span>
        <span class="c1"># DYSPHAGIA #</span>
        <span class="c1">#############</span>
        <span class="n">dysphagia</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dysphagia&quot;</span><span class="p">)})</span>

        <span class="n">dysphagia_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dysphagia&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# dysphagia screening - Guss test&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Unable to test&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;DYSPHAGIA SCREENING&#39;</span><span class="p">,</span> <span class="n">dysphagia</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # IS + ICH + CVT&#39;</span><span class="p">,</span> <span class="n">dysphagia_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">dysphagia_color</span><span class="p">)</span>

        <span class="c1">#############</span>
        <span class="c1"># DYSPHAGIA #</span>
        <span class="c1">#############</span>
        <span class="n">dysphagia</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dysphagia&quot;</span><span class="p">)})</span>

        <span class="n">dysphagia_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dysphagia&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# dysphagia screening time - Within first 24 hours&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening time - Within first 24 hours&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;DYSPHAGIA TIMES&#39;</span><span class="p">,</span> <span class="n">dysphagia</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # Guss test + other test&#39;</span><span class="p">,</span> <span class="n">dysphagia_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">dysphagia_color</span><span class="p">)</span>

        <span class="c1">###################</span>
        <span class="c1"># HEMICRANIECTOMY #</span>
        <span class="c1">###################</span>
        <span class="n">hemicraniectomy</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;hemicraniectomy&quot;</span><span class="p">)})</span>

        <span class="n">hemicraniectomy_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;hemicraniectomy&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# hemicraniectomy - Yes&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% he</span><span class="s1">micraniectomy - Referred to another centre&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;HEMICRANIECTOMY&#39;</span><span class="p">,</span> <span class="n">hemicraniectomy</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # IS&#39;</span><span class="p">,</span> <span class="n">hemicraniectomy_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">hemicraniectomy_color</span><span class="p">)</span>

        <span class="c1">################</span>
        <span class="c1"># NEUROSURGERY #</span>
        <span class="c1">################</span>
        <span class="n">neurosurgery</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;neurosurgery&quot;</span><span class="p">)})</span>

        <span class="n">neurosurgery_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;neurosurgery&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# neurosurgery - Not known&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% neurosurgery - No&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;NEUROSURGERY&#39;</span><span class="p">,</span> <span class="n">neurosurgery</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # ICH&#39;</span><span class="p">,</span> <span class="n">neurosurgery_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">neurosurgery_color</span><span class="p">)</span>


        <span class="c1">#####################</span>
        <span class="c1"># NEUROSURGERY TYPE #</span>
        <span class="c1">#####################</span>
        <span class="n">neurosurgery_type</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;neurosurgery_type&quot;</span><span class="p">)})</span>

        <span class="n">neurosurgery_type_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;neurosurgery_type&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# neurosurgery type - intracranial hematoma evacuation&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% neurosurgery type - Referred to another centre&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;NEUROSURGERY TYPE&#39;</span><span class="p">,</span> <span class="n">neurosurgery_type</span><span class="p">)</span>


        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # ICH&#39;</span><span class="p">,</span> <span class="n">neurosurgery_type_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">neurosurgery_type_color</span><span class="p">)</span>


        <span class="c1">###################</span>
        <span class="c1"># BLEEDING REASON #</span>
        <span class="c1">###################</span>
        <span class="n">bleeding_reason</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bleeding_reason&quot;</span><span class="p">)})</span>

        <span class="n">bleeding_reason_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bleeding_reason&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# bleeding reason - arterial hypertension&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% bleeding reason - more than one&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;BLEEDING REASON&#39;</span><span class="p">,</span> <span class="n">bleeding_reason</span><span class="p">)</span>


        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # ICH&#39;</span><span class="p">,</span> <span class="n">bleeding_reason_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">bleeding_reason_color</span><span class="p">)</span>

        <span class="c1">###################</span>
        <span class="c1"># BLEEDING SOURCE #</span>
        <span class="c1">###################</span>
        <span class="n">bleeding_source</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bleeding_source&quot;</span><span class="p">)})</span>

        <span class="n">bleeding_source_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bleeding_source&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# bleeding source - Known&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% bleeding source - Not known&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;BLEEDING SOURCE&#39;</span><span class="p">,</span> <span class="n">bleeding_source</span><span class="p">)</span>


        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # ICH&#39;</span><span class="p">,</span> <span class="n">bleeding_source_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">bleeding_source_color</span><span class="p">)</span>

        <span class="c1">################</span>
        <span class="c1"># INTERVENTION #</span>
        <span class="c1">################</span>
        <span class="n">intervention</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;intervention&quot;</span><span class="p">)})</span>

        <span class="n">intervention_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;intervention&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# intervention - endovascular (coiling)&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% i</span><span class="s1">ntervention - more than one&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;INTERVENTION&#39;</span><span class="p">,</span> <span class="n">intervention</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # SAH&#39;</span><span class="p">,</span> <span class="n">intervention_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">intervention_color</span><span class="p">)</span>

        <span class="c1">################</span>
        <span class="c1"># VT TREATMENT #</span>
        <span class="c1">################</span>
        <span class="n">vt_treatment</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vt_treatment&quot;</span><span class="p">)})</span>

        <span class="n">vt_treatment_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vt_treatment&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# VT treatment - anticoagulation&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% VT treatment - more than one treatment&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;VENOUS THROMBOSIS TREATMENT&#39;</span><span class="p">,</span> <span class="n">vt_treatment</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # CVT&#39;</span><span class="p">,</span> <span class="n">intervention_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">intervention_color</span><span class="p">)</span>

        <span class="c1">#######################</span>
        <span class="c1"># ATRIAL FIBRILLATION #</span>
        <span class="c1">#######################</span>
        <span class="n">atrial_fibrillation</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;afib&quot;</span><span class="p">)})</span>

        <span class="n">afib_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;afib&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# afib/flutter - Known&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% o</span><span class="s1">ther afib detection method - Yes&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;ATRIAL FIBRILLATION&#39;</span><span class="p">,</span> <span class="n">atrial_fibrillation</span><span class="p">)</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# afib/flutter - Known&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% afib/flutter - Not known&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # ischemic + TIA&#39;</span><span class="p">,</span> <span class="n">afib_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">afib_color</span><span class="p">)</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# afib detection method - Telemetry with monitor allowing automatic detection of aFib&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# other afib detection method - Yes&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # detected during hospitalization&#39;</span><span class="p">,</span> <span class="n">afib_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">afib_color</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% o</span><span class="s1">ther afib detection method - Yes&#39;</span><span class="p">)),</span> <span class="s1">&#39;out of # not detected + not known&#39;</span><span class="p">,</span> <span class="n">afib_color</span><span class="p">)</span>


        <span class="c1">####################</span>
        <span class="c1"># CAROTID ARTERIES #</span>
        <span class="c1">####################</span>
        <span class="n">carot</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;carot&quot;</span><span class="p">)})</span>

        <span class="n">carot_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;carot&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# carotid arteries imaging - Yes&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid arteries imaging - Yes&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;CAROTID ARTERIES IMAGING&#39;</span><span class="p">,</span> <span class="n">carot</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # alive ischemic + TIA&#39;</span><span class="p">,</span> <span class="n">carot_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">carot_color</span><span class="p">)</span>


        <span class="c1">###################</span>
        <span class="c1"># ANTITHROMBOTICS #</span>
        <span class="c1">###################</span>
        <span class="n">antithrombotics</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;antithrombotics&quot;</span><span class="p">)})</span>

        <span class="n">antithrombotics_colors</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;antithrombotics&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# patients receiving antiplatelets&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients prescribed antithrombotics with aFib&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;ANTITHROMBOTICS&#39;</span><span class="p">,</span> <span class="n">antithrombotics</span><span class="p">)</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# patients receiving antiplatelets&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients receiving LMWH or heparin in full anticoagulant dose&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # alive ischemic + TIA + CVT&#39;</span><span class="p">,</span> <span class="n">antithrombotics_colors</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">antithrombotics_colors</span><span class="p">)</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients prescribed anticoagulants with aFib&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients prescribed antithrombotics with aFib&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # alive with AF+&#39;</span><span class="p">,</span> <span class="n">antithrombotics_colors</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">antithrombotics_colors</span><span class="p">)</span>

        <span class="c1">##########</span>
        <span class="c1"># STATIN #</span>
        <span class="c1">##########</span>
        <span class="n">statin</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;statin&quot;</span><span class="p">)})</span>

        <span class="n">statin_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;statin&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# patients prescribed statins - Yes&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients prescribed statins - Not known&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;STATINS&#39;</span><span class="p">,</span> <span class="n">statin</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # IS + TIA&#39;</span><span class="p">,</span> <span class="n">statin_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">statin_color</span><span class="p">)</span>


        <span class="c1">####################</span>
        <span class="c1"># CAROTID STENOSIS #</span>
        <span class="c1">####################</span>
        <span class="n">carotid_stenosis</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;carotid_stenosis&quot;</span><span class="p">)})</span>

        <span class="n">carotid_stenosis_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;carotid_stenosis&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# carotid stenosis - 50</span><span class="si">%-70%</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid stenosis - Not known&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;CAROTID STENOSIS&#39;</span><span class="p">,</span> <span class="n">carotid_stenosis</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # IS + TIA&#39;</span><span class="p">,</span> <span class="n">carotid_stenosis_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">carotid_stenosis_color</span><span class="p">)</span>

        <span class="c1">##############################</span>
        <span class="c1"># CAROTID STENOSIS FOLLOW UP #</span>
        <span class="c1">##############################</span>
        <span class="n">carotid_stenosis_foll</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;carot_foll&quot;</span><span class="p">)})</span>

        <span class="n">carotid_stenosis_foll_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;carot_foll&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# carotid stenosis followup - Yes&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid stenosis followup - Referred to another centre&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;CAROTID STENOSIS FOLLOW UP&#39;</span><span class="p">,</span> <span class="n">carotid_stenosis_foll</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # IS + TIA&#39;</span><span class="p">,</span> <span class="n">carotid_stenosis_foll_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">carotid_stenosis_foll_color</span><span class="p">)</span>

        <span class="c1">###############################</span>
        <span class="c1"># ANTIHYPERTENSIVE MEDICATION #</span>
        <span class="c1">###############################</span>
        <span class="n">antihypertensive</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;antihypertensive&quot;</span><span class="p">)})</span>

        <span class="n">antihypertensive_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;antihypertensive&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# prescribed antihypertensives - Not known&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% prescribed antihypertensives - No&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;ANTIHYPERTENSIVE MEDICATION&#39;</span><span class="p">,</span> <span class="n">antihypertensive</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # total patients - # ichemic reffered to another centre&#39;</span><span class="p">,</span> <span class="n">antihypertensive_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">antihypertensive_color</span><span class="p">)</span>


        <span class="c1">#####################</span>
        <span class="c1"># SMOKING CESSATION #</span>
        <span class="c1">#####################</span>
        <span class="n">smoking</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;smoking&quot;</span><span class="p">)})</span>

        <span class="n">smoking_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;smoking&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# recommended to a smoking cessation program - not a smoker&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecommended to a smoking cessation program - No&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;SMOKING CESSATION&#39;</span><span class="p">,</span> <span class="n">smoking</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # total patients - # ichemic reffered to another centre&#39;</span><span class="p">,</span> <span class="n">smoking_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">smoking_color</span><span class="p">)</span>


        <span class="c1">##########################</span>
        <span class="c1"># Cerebrovascular expert #</span>
        <span class="c1">##########################</span>
        <span class="n">cerebrovascular</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cerebrovascular&quot;</span><span class="p">)})</span>

        <span class="n">cerebrovascular_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cerebrovascular&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# recommended to a cerebrovascular expert - Recommended, and appointment was made&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecommended to a cerebrovascular expert - Not recommended&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;CEREBROVASCULAR EXPERT&#39;</span><span class="p">,</span> <span class="n">cerebrovascular</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # total patients - # ichemic reffered to another centre&#39;</span><span class="p">,</span> <span class="n">cerebrovascular_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cerebrovascular_color</span><span class="p">)</span>

        <span class="c1">#########################</span>
        <span class="c1"># DISCHARGE DESTINATION #</span>
        <span class="c1">#########################</span>

        <span class="n">discharge_destination</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discharge_destination&quot;</span><span class="p">)})</span>

        <span class="n">destination_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discharge_destination&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# discharge destination - Home&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Dead&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;DISCHARGE DESTINATION&#39;</span><span class="p">,</span> <span class="n">discharge_destination</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # total patients - # ichemic reffered to another centre&#39;</span><span class="p">,</span> <span class="n">destination_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">destination_color</span><span class="p">)</span>

        <span class="c1">##################################################</span>
        <span class="c1"># DISCHARGE DESTINATION - WITHIN THE SAME CENTRE #</span>
        <span class="c1">##################################################</span>

        <span class="n">discharge_destination_same_centre</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discharge_destination_same_centre&quot;</span><span class="p">)})</span>

        <span class="n">discharge_destination_same_centre_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discharge_destination_same_centre&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# transferred within the same centre - Acute rehabilitation&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% transferred within the same centre - Another department&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;DISCHARGE DESTINATION WITHIN THE SAME CENTRE&#39;</span><span class="p">,</span> <span class="n">discharge_destination_same_centre</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # transferred within the same centre&#39;</span><span class="p">,</span> <span class="n">discharge_destination_same_centre_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">discharge_destination_same_centre_color</span><span class="p">)</span>

        <span class="c1">#########################################################</span>
        <span class="c1"># DISCHARGE DESTINATION - TRANSFERRED TO ANOTHER CENTRE #</span>
        <span class="c1">#########################################################</span>

        <span class="n">discharge_destination_another_centre</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discharge_destination_another_centre&quot;</span><span class="p">)})</span>

        <span class="n">discharge_destination_another_centre_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discharge_destination_another_centre&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# transferred to another centre - Stroke centre&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% transferred to another centre - Another hospital&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;DISCHARGE DESTINATION TRANSFERRED TO ANOTHER CENTRE&#39;</span><span class="p">,</span> <span class="n">discharge_destination_another_centre</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # transferred to another centre&#39;</span><span class="p">,</span> <span class="n">discharge_destination_another_centre_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">discharge_destination_another_centre_color</span><span class="p">)</span>

        <span class="c1">################################################################</span>
        <span class="c1"># DISCHARGE DESTINATION - TRANSFERRED TO WITHIN ANOTHER CENTRE #</span>
        <span class="c1">################################################################</span>

        <span class="n">discharge_destination_within_another_centre</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discharge_destination_within_another_centre&quot;</span><span class="p">)})</span>

        <span class="n">discharge_destination_within_another_centre_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discharge_destination_within_another_centre&quot;</span><span class="p">),</span>
            <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;# department transferred to within another centre - Acute rehabilitation&#39;</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Another department&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;DISCHARGE DESTINATION TRANSFERRED WITHIN TO ANOTHER CENTRE&#39;</span><span class="p">,</span> <span class="n">discharge_destination_within_another_centre</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;out of # transferred to another centre&#39;</span><span class="p">,</span> <span class="n">discharge_destination_within_another_centre_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">discharge_destination_within_another_centre_color</span><span class="p">)</span>

        <span class="c1">################</span>
        <span class="c1"># angel awards #</span>
        <span class="c1">################</span>
        <span class="n">awards</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;angel_awards&quot;</span><span class="p">)})</span>

        <span class="n">awards_color</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;angel_awards&quot;</span><span class="p">)})</span>

        <span class="n">first_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_patients_column</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke patients treated in a dedicated stroke unit / ICU&#39;</span><span class="p">)</span>
        <span class="n">first_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first_index</span><span class="p">)</span>
        <span class="n">last_cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_index</span><span class="p">)</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="n">first_cell</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">last_cell</span><span class="p">,</span> <span class="s1">&#39;ESO ANGELS AWARDS&#39;</span><span class="p">,</span> <span class="n">awards</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">awards_color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">awards_color</span><span class="p">)</span>

        <span class="n">hidden_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;# patients treated with door to thrombolysis &lt; 60 minutes&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients treated with door to thrombolysis &lt; 45 minutes&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients treated with door to thrombectomy &lt; 90 minutes&#39;</span><span class="p">,</span> <span class="s1">&#39;# patients treated with door to thrombectomy &lt; 60 minutes&#39;</span><span class="p">,</span> <span class="s1">&#39;# recanalization rate out of total ischemic incidence&#39;</span><span class="p">,</span> <span class="s1">&#39;# suspected stroke patients undergoing CT/MRI&#39;</span><span class="p">,</span> <span class="s1">&#39;# all stroke patients undergoing dysphagia screening&#39;</span><span class="p">,</span> <span class="s1">&#39;# ischemic stroke patients discharged with antiplatelets&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% i</span><span class="s1">schemic stroke patients discharged with antiplatelets&#39;</span><span class="p">,</span> <span class="s1">&#39;# ischemic stroke patients discharged home with antiplatelets&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% i</span><span class="s1">schemic stroke patients discharged home with antiplatelets&#39;</span><span class="p">,</span> <span class="s1">&#39;# ischemic stroke patients discharged (home) with antiplatelets&#39;</span><span class="p">,</span> <span class="s1">&#39;# afib patients discharged with anticoagulants&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib patients discharged with anticoagulants&#39;</span><span class="p">,</span> <span class="s1">&#39;# afib patients discharged home with anticoagulants&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib patients discharged home with anticoagulants&#39;</span><span class="p">,</span> <span class="s1">&#39;# afib patients discharged (home) with anticoagulants&#39;</span><span class="p">,</span> <span class="s1">&#39;# stroke patients treated in a dedicated stroke unit / ICU&#39;</span><span class="p">]</span>
        				
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">hidden_columns</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="n">column</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">column</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

        <span class="c1"># format for green color</span>
        <span class="n">green</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;green&quot;</span><span class="p">)})</span>

        <span class="c1"># format for gold color</span>
        <span class="n">gold</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gold&quot;</span><span class="p">)})</span>

        <span class="c1"># format for platinum color</span>
        <span class="n">plat</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;platinum&quot;</span><span class="p">)})</span>

        <span class="c1"># format for gold black</span>
        <span class="n">black</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#000000&#39;</span><span class="p">,</span>
            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;black&quot;</span><span class="p">)})</span>

        <span class="c1"># format for red color</span>
        <span class="n">red</span> <span class="o">=</span> <span class="n">workbook1</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">)})</span>


        <span class="c1"># add table into worksheet</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">statistics</span><span class="p">,</span>
                   <span class="s1">&#39;header_row&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                   <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span>
                   <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;Table Style Light 8&#39;</span>
                   <span class="p">}</span>

        <span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

        <span class="c1"># total number of rows</span>
        <span class="n">number_of_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">statistics</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">comp</span><span class="p">:</span>    
            <span class="c1"># if cell contain TRUE in column &gt; 30 patients (DR) it will be colored to green</span>
            <span class="n">awards</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_patients_column</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">nrow</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;containing&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;TRUE&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">green</span><span class="p">})</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">def</span> <span class="nf">angels_awards_ivt_60</span><span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">coln</span><span class="p">):</span>
                <span class="sd">&quot;&quot;&quot;Add conditional formatting to angels awards for ivt &lt; 60.&quot;&quot;&quot;</span>
                <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                                                        <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mf">74.99</span><span class="p">,</span>
                                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">gold</span><span class="p">})</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span>
                                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">black</span><span class="p">})</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


            <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients treated with door to thrombolysis &lt; 60 minutes&#39;</span><span class="p">)</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">angels_awards_ivt_60</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

            <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients treated with door to thrombectomy &lt; 90 minutes&#39;</span><span class="p">)</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">angels_awards_ivt_60</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>


            <span class="k">def</span> <span class="nf">angels_awards_ivt_45</span><span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">coln</span><span class="p">):</span>
                <span class="sd">&quot;&quot;&quot;Add conditional formatting to angels awards for ivt &lt; 45.&quot;&quot;&quot;</span>
                <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">49.99</span><span class="p">,</span>
                                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">plat</span><span class="p">})</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">black</span><span class="p">})</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


            <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients treated with door to thrombolysis &lt; 45 minutes&#39;</span><span class="p">)</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">angels_awards_ivt_45</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

            <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% patients treated with door to thrombectomy &lt; 60 minutes&#39;</span><span class="p">)</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">angels_awards_ivt_45</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

            <span class="c1"># setting colors of cells according to their values</span>
            <span class="k">def</span> <span class="nf">angels_awards_recan</span><span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">coln</span><span class="p">):</span>
                <span class="sd">&quot;&quot;&quot;Add conditional formatting to angels awards for recaalization procedures.&quot;&quot;&quot;</span>
                <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                                                        <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mf">14.99</span><span class="p">,</span>
                                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">gold</span><span class="p">})</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                                                        <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mf">24.99</span><span class="p">,</span>
                                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">plat</span><span class="p">})</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
                                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">black</span><span class="p">})</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


            <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization rate out of total ischemic incidence&#39;</span><span class="p">)</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">angels_awards_recan</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">angels_awards_processes</span><span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">coln</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                <span class="sd">&quot;&quot;&quot;Add conditional formatting to angels awards for processes.&quot;&quot;&quot;</span>
                <span class="n">count</span> <span class="o">=</span> <span class="n">count</span>
                <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
                                                        <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mf">84.99</span><span class="p">,</span>
                                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">gold</span><span class="p">})</span>

                    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">85</span><span class="p">,</span>
                                                        <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mf">89.99</span><span class="p">,</span>
                                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">plat</span><span class="p">})</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span>
                                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">black</span><span class="p">})</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


            <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% s</span><span class="s1">uspected stroke patients undergoing CT/MRI&#39;</span><span class="p">)</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">angels_awards_processes</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

            <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% all stroke patients undergoing dysphagia screening&#39;</span><span class="p">)</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">angels_awards_processes</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

            <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% i</span><span class="s1">schemic stroke patients discharged (home) with antiplatelets&#39;</span><span class="p">)</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">angels_awards_processes</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

            <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;% afib patients discharged (home) with anticoagulants&#39;</span><span class="p">)</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">angels_awards_processes</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

            <span class="c1"># setting colors of cells according to their values</span>
            <span class="k">def</span> <span class="nf">angels_awards_hosp</span><span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">coln</span><span class="p">):</span>
                <span class="sd">&quot;&quot;&quot;Add conditional formatting to angels awards for hospitalization.&quot;&quot;&quot;</span>
                <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">plat</span><span class="p">})</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">number_of_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">0.99</span><span class="p">,</span>
                                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">black</span><span class="p">})</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke patients treated in a dedicated stroke unit / ICU&#39;</span><span class="p">)</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">angels_awards_hosp</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

            <span class="c1"># set color for proposed angel award</span>
            <span class="k">def</span> <span class="nf">proposed_award</span><span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">coln</span><span class="p">):</span>
                <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">nrow</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;containing&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;NONE&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">green</span><span class="p">})</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">nrow</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;containing&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;GOLD&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">gold</span><span class="p">})</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">nrow</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;containing&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;PLATINUM&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">plat</span><span class="p">})</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="k">while</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">nrow</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">cell_n</span> <span class="o">=</span> <span class="n">column</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cell_n</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;containing&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;DIAMOND&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">black</span><span class="p">})</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Proposed Award&#39;</span><span class="p">)</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">proposed_award</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">coln</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
            <span class="c1">#worksheet.write_column(3, index, awards)</span>

            
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="n">workbook1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">RES-Q package</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Marie Jankujova.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
    </div>

    

    
  </body>
</html>