
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>resqdb.GeneratePresentation &#8212; RES-Q package January, 2019 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for resqdb.GeneratePresentation</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">File name: GeneratePresentation.py</span>
<span class="sd">Package: resq</span>
<span class="sd">Written by: Marie Jankujova - jankujova.marie@fnusa.cz on 11-2017</span>
<span class="sd">Version: v1.0</span>
<span class="sd">Version comment: The first version of script which calls class GenerateGraphs and create graphs into presentation. </span>
<span class="sd">Description: This script is used to call class GenerateGraphs and produce graphs into presentation. </span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">date</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">import</span> <span class="nn">pytz</span>
<span class="kn">from</span> <span class="nn">resqdb.GenerateGraphs</span> <span class="k">import</span> <span class="n">GenerateGraphs</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>
<span class="kn">from</span> <span class="nn">pptx</span> <span class="k">import</span> <span class="n">Presentation</span>
<span class="kn">from</span> <span class="nn">pptx.util</span> <span class="k">import</span> <span class="n">Cm</span><span class="p">,</span> <span class="n">Pt</span><span class="p">,</span> <span class="n">Inches</span>
<span class="kn">from</span> <span class="nn">pptx.dml.color</span> <span class="k">import</span> <span class="n">RGBColor</span>

<div class="viewcode-block" id="GeneratePresentation"><a class="viewcode-back" href="../../source/resqdb.html#resqdb.GeneratePresentation.GeneratePresentation">[docs]</a><span class="k">class</span> <span class="nc">GeneratePresentation</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; The class generating the general presentation for countries and sites. </span>

<span class="sd">    :param df: the dataframe with calculated statistics</span>
<span class="sd">    :type df: pandas dataframe</span>
<span class="sd">    :param country: `True` if country is included in the statistics as site</span>
<span class="sd">    :type country: bool</span>
<span class="sd">    :param country_code: the country code</span>
<span class="sd">    :type country_code: str</span>
<span class="sd">    :param split_sites: `True` if presentation should be generated per sites seperately</span>
<span class="sd">    :type split_sites: bool</span>
<span class="sd">    :param site: the site code</span>
<span class="sd">    :type site: str</span>
<span class="sd">    :param report: the type of the report eg. quarter</span>
<span class="sd">    :type report: str</span>
<span class="sd">    :param quarter: the type of the period eg. Q1_2019</span>
<span class="sd">    :type quarter: str</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">country_code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">split_sites</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quarter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">country_code</span> <span class="o">=</span> <span class="n">country_code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">=</span> <span class="n">report</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="o">=</span> <span class="n">quarter</span>

        <span class="c1">#master_pptx = self.country_code + &quot;.pptx&quot;</span>
        <span class="n">script_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span> 
        <span class="n">master_pptx</span> <span class="o">=</span> <span class="s2">&quot;master.pptx&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_dir</span><span class="p">,</span> <span class="s2">&quot;backgrounds&quot;</span><span class="p">,</span> <span class="n">master_pptx</span><span class="p">))</span>

        <span class="c1"># Connect to database and get country name according to country code.</span>
        <span class="k">def</span> <span class="nf">select_country</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; The function obtaining the name of country from the package pytz based on the country code. </span>

<span class="sd">            :param value: the country code</span>
<span class="sd">            :type value: str</span>
<span class="sd">            :returns: the country name</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">country_name</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">country_names</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">country_name</span>

        <span class="c1"># If country is used as site, the country name is selected from countries dictionary by country code. :) </span>
        <span class="k">if</span> <span class="p">(</span><span class="n">country</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">country_code</span> <span class="o">==</span> <span class="s1">&#39;UZB&#39;</span><span class="p">:</span>
                <span class="n">country_code</span> <span class="o">=</span> <span class="s1">&#39;UZ&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span> <span class="o">=</span> <span class="n">select_country</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">country_code</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># If split_sites is True, then go through dataframe and generate graphs for each site (the country will be included as site in each file).</span>
        <span class="n">site_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Site ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="c1"># Delete country name from side ids list.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">site_ids</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="n">site</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Site ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">site</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">])]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_generate_graphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">site_code</span><span class="o">=</span><span class="n">site</span><span class="p">)</span>

        <span class="c1"># Generate formatted statistics for all sites individualy + country as site is included</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">split_sites</span><span class="p">)</span> <span class="ow">and</span> <span class="n">site</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">site_ids</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Site ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">])]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_generate_graphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">site_code</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    
        <span class="c1"># Produce formatted statistics for all sites + country as site</span>
        <span class="k">if</span> <span class="n">site</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_generate_graphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">site_code</span><span class="o">=</span><span class="n">country_code</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_generate_graphs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">site_code</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The function opening the presentation and generating graphs. </span>
<span class="sd">        </span>
<span class="sd">        :param df: the dataframe with calculated statistic</span>
<span class="sd">        :type df: pandas dataframe</span>
<span class="sd">        :param site_code: the site ID</span>
<span class="sd">        :type site_code: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">prs</span> <span class="o">=</span> <span class="n">Presentation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>

        <span class="n">first_slide</span> <span class="o">=</span> <span class="n">prs</span><span class="o">.</span><span class="n">slides</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">first_slide</span><span class="o">.</span><span class="n">shapes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">text_frame</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">text_frame</span>

        <span class="n">first_slide_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Summary&quot;</span>
        <span class="c1">#first_slide_text = &quot;\nData Summary&quot;</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">run</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
        <span class="n">run</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">first_slide_text</span>

        <span class="n">font</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">font</span>
        <span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Century Gothic&#39;</span>
        <span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
        <span class="n">font</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span><span class="mi">250</span><span class="p">,</span><span class="mi">250</span><span class="p">)</span>

        <span class="c1"># if (self.country_name in [&#39;Ukraine&#39;, &#39;Poland&#39;] and len(df) &gt; 2):</span>
        <span class="c1">#     main_col = &#39;Site ID&#39;</span>
        <span class="c1"># else:</span>
        <span class="n">main_col</span> <span class="o">=</span>  <span class="s1">&#39;Site Name&#39;</span>

        <span class="c1">########################</span>
        <span class="c1">#### TOTAL PATIENTS ####</span>
        <span class="c1">########################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Total Patients&#39;</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">country_patients</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">tmp_df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;TOTAL PATIENTS (n = </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">country_patients</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tmp_df</span><span class="p">[</span><span class="n">main_col</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">]</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">##########################</span>
        <span class="c1">### MEDIAN PATIENT AGE ###</span>
        <span class="c1">##########################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median patient age&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MEDIAN PATIENT AGE&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">###########################</span>
        <span class="c1">### GENDER DISTRIBUTION ###</span>
        <span class="c1">###########################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients female&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Female&#39;</span><span class="p">,</span> <span class="s1">&#39;Male&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% patients female&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients male&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;GENDER DISTRIBUTION&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">############################################</span>
        <span class="c1">### % RECURRENT STROKES OUT OF ALL CASES ###</span>
        <span class="c1">############################################</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        sheet_name = &#39;recurrent_stroke&#39;</span>
<span class="sd">        column_name = &#39;% recurrent stroke - Yes&#39;</span>

<span class="sd">        tmp_df = df[[main_col, column_name]]</span>
<span class="sd">        tmp_df = tmp_df.sort_values([column_name], ascending = True)</span>

<span class="sd">        title = &quot;% RECURRENT STROKES out of all cases&quot;</span>

<span class="sd">        GenerateGraphs(dataframe=tmp_df, title=title, column_name=column_name, sheet_name=sheet_name, writer=writer, workbook=workbook)</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1">#######################</span>
        <span class="c1">### DEPARTMENT TYPE ###</span>
        <span class="c1">#######################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - neurology&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;neurology&#39;</span><span class="p">,</span> <span class="s1">&#39;neurosurgery&#39;</span><span class="p">,</span> <span class="s1">&#39;anesthesiology resuscitation critical care&#39;</span><span class="p">,</span> <span class="s1">&#39;internal medicine&#39;</span><span class="p">,</span> <span class="s1">&#39;geriatrics&#39;</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - neurology&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - neurosurgery&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - anesthesiology/resuscitation/critical care&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - internal medicine&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - geriatrics&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - Other&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% DEPARTMENT TYPE ALLOCATION out of all cases&quot;</span> 

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">###################################</span>
        <span class="c1">### HOSPITALIZATION DESTINATION ###</span>
        <span class="c1">###################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients hospitalized in stroke unit / ICU&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;stroke unit&#39;</span><span class="p">,</span> <span class="s1">&#39;monitored bed with telemetry&#39;</span><span class="p">,</span> <span class="s1">&#39;standard bed&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in stroke unit / ICU&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in monitored bed with telemetry&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in standard bed&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% HOSPITALIZATION DESTINATION out of all cases&quot;</span> 

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">###############</span>
        <span class="c1"># STROKE TYPE #</span>
        <span class="c1">###############</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - ischemic stroke&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ischemic&#39;</span><span class="p">,</span> <span class="s1">&#39;transient ischemic attack&#39;</span><span class="p">,</span> <span class="s1">&#39;intracerebral hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;subarrachnoid hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;cerebral venous thrombosis&#39;</span><span class="p">,</span> <span class="s1">&#39;undetermined&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - ischemic stroke&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - transient ischemic attack&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - intracerebral hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - subarrachnoid hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - cerebral venous thrombosis&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - undetermined stroke&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% STROKE TYPE out of all cases&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">######################</span>
        <span class="c1"># CONSIOUSNESS LEVEL #</span>
        <span class="c1">######################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;alert_all_perc&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;alert&#39;</span><span class="p">,</span> <span class="s1">&#39;drowsy&#39;</span><span class="p">,</span> <span class="s1">&#39;comatose&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;alert_all_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;drowsy_all_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;comatose_all_perc&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% CONSCIOUSNESS LEVEL for IS, ICH, CVT, SAH&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        #######</span>
<span class="sd">        # GCS #</span>
<span class="sd">        #######</span>
<span class="sd">        column_names = [&#39;% GCS - 15-13&#39;, &#39;% GCS - 12-8&#39;, &#39;% GCS - &lt;8&#39;]</span>
<span class="sd">        column_name = &#39;% GCS - 15-13&#39;</span>
<span class="sd">        legend = [&#39;GCS 15 - 13&#39;, &#39;GCS 12 - 8&#39;, &#39;GCS &lt; 8&#39;]</span>

<span class="sd">        tmp_df = df[[main_col, &#39;% GCS - 15-13&#39;, &#39;% GCS - 12-8&#39;, &#39;% GCS - &lt;8&#39;]]</span>
<span class="sd">        tmp_df = tmp_df.sort_values(column_names, ascending = [True, True, True])</span>

<span class="sd">        title = &quot;% GLASGOW COMA SCALE INTERVALS&quot;</span>

<span class="sd">        GenerateGraphs(dataframe=tmp_df, presentation=prs, title=title, column_name=column_name, country=self.country_name, legend=legend, number_of_series=len(legend), graph_type=&#39;stacked&#39;)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1">###################</span>
        <span class="c1"># NIHSS PERFORMED #</span>
        <span class="c1">###################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% NIHSS - Performed&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% NIHSS PERFORMED for IS, ICH, CVT&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">######################</span>
        <span class="c1"># NIHSS MEDIAN SCORE #</span>
        <span class="c1">######################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;NIHSS median score&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;NIHSS median score&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">####################</span>
        <span class="c1"># CT/MRI performed #</span>
        <span class="c1">####################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% CT/MRI - performed&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% CT/MRI PERFORMED for IS, ICH, CVT, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">##################################</span>
        <span class="c1"># CT/MRI PERFORMED WITHIN 1 HOUR #</span>
        <span class="c1">##################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% CT/MRI - Performed within 1 hour after admission&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% CT/MRI PERFORMED WITHIN 1 HOUR AFTER ADMISSION for IS, ICH, CVT, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">####################</span>
        <span class="c1"># VASCULAR IMAGING #</span>
        <span class="c1">####################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;vascular_imaging_cta_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vascular_imaging_mra_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vascular_imaging_dsa_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vascular_imaging_none_norm&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;vascular_imaging_cta_norm&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CTA&#39;</span><span class="p">,</span> <span class="s1">&#39;MRA&#39;</span><span class="p">,</span> <span class="s1">&#39;DSA&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;vascular_imaging_cta_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vascular_imaging_mra_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vascular_imaging_dsa_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vascular_imaging_none_norm&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% VASCULAR IMAGING PERFORMED for ICH, SAH&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">############################</span>
        <span class="c1"># RECANALIZATION TREATMENT #</span>
        <span class="c1">############################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IV tPa&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPa + another centre for endovascular treatment&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + referred to another centre for endovascular treatment&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% IV tPa for IS&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">####################################################</span>
        <span class="c1"># RECANALIZATION TREATMENT IN COMPREHENSIVE CENTRE #</span>
        <span class="c1">####################################################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Endovascular treatment alone&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + endovascular treatment&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;endovascular treatment&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Endovascular treatment alone&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% RECANALIZATION PROCEDURES IN COMPREHENSIVE CENTRES for IS&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">##########################################################</span>
        <span class="c1"># RECANALIZATION TREATMENT IN REFFERED TO ANOTHER CENTRE #</span>
        <span class="c1">##########################################################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + referred to another centre for endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Referred to another centre for endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Referred to another centre for endovascular treatment and hospitalization continues at the referred to centre&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Referred for endovascular treatment and patient is returned to the initial centre&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + referred to another centre for endovascular treatment&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IV tPa + another centre for endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;another centre for endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;another centre for endovascular treatment and hospitalization continues&#39;</span><span class="p">,</span> <span class="s1">&#39;another centre for endovascular treatment and returned to the initial centre&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + referred to another centre for endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Referred to another centre for endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Referred to another centre for endovascular treatment and hospitalization continues at the referred to centre&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Referred for endovascular treatment and patient is returned to the initial centre&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PATIENTS TRANSFERRED TO ANOTHER CENTRE FOR RECANALIZATION PROCEDURES FROM PRIMARY CENTRE for IS&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">############################</span>
        <span class="c1"># RECANALIZATION TREATMENT #</span>
        <span class="c1">############################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IV tPa&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPa + another centre for endovascular treatment&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% patients recanalized&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Endovascular treatment alone&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + referred to another centre for endovascular treatment&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;% patients recanalized&#39;</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% RECANALIZATION PROCEDURES for IS&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">################</span>
        <span class="c1"># % median DTN #</span>
        <span class="c1">################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median DTN (minutes)&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MEDIAN DOOR-TO-NEEDLE TIME (minutes) for thrombolyzed patients&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">###############</span>
        <span class="c1">#  median DTG #</span>
        <span class="c1">###############</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median DTG (minutes)&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MEDIAN DOOR-TO-GROIN TIME (minutes) for patients receiving endovascular treatment in a comprehensive centre&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">####################</span>
        <span class="c1">#  median TBY DIDO #</span>
        <span class="c1">####################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median TBY DIDO (minutes)&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MEDIAN DOOR-IN-DOOR-OUT TIME (minutes) for patients referred from a primary centre to another centre for recanalization therapy&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">#######################</span>
        <span class="c1"># dysphagia screening #</span>
        <span class="c1">#######################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Guss test&#39;</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Guss test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Other test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Another centre&#39;</span><span class="p">]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GUSS test&#39;</span><span class="p">,</span> <span class="s1">&#39;Other test&#39;</span><span class="p">,</span> <span class="s1">&#39;Another centre&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Guss test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Other test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Another centre&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">column_names</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% DYSPHAGIA SCREENING PERFORMED for IS, ICH, CVT&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">######################################</span>
        <span class="c1">#  dypshagia screening within 1 hour #</span>
        <span class="c1">######################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening time - Within first 24 hours&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% DYSPHAGIA SCREENING TIME WITHIN FIRST 24 HOURS AFTER ADMISSION&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        
        <span class="c1">###########################</span>
        <span class="c1"># PUT ON VENTILATOR - YES #</span>
        <span class="c1">###########################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients put on ventilator - Yes&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PATIENTS PUT ON VENTILATOR for IS, ICH, CVT&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">###################</span>
        <span class="c1"># HEMICRANEOCTOMY #</span>
        <span class="c1">###################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% he</span><span class="s1">micraniectomy - Yes&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;Referred to another centre&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% he</span><span class="s1">micraniectomy - Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% he</span><span class="s1">micraniectomy - Referred to another centre&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% HEMICRANIECTOMY PERFORMED for IS&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">################</span>
        <span class="c1"># NEUROSURGERY #</span>
        <span class="c1">################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% neurosurgery - Yes&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% NEUROSURGERY PERFORMED for ICH&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">#######################################</span>
        <span class="c1"># NEUROSURGERY TYPE (FIRST 3 OPTIONS) #</span>
        <span class="c1">#######################################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;% neurosurgery type - intracranial hematoma evacuation&#39;</span><span class="p">,</span> <span class="s1">&#39;% neurosurgery type - external ventricular drainage&#39;</span><span class="p">,</span> <span class="s1">&#39;% neurosurgery type - decompressive craniectomy&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% neurosurgery type - intracranial hematoma evacuation&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;intracranial hematoma evacuation&#39;</span><span class="p">,</span> <span class="s1">&#39;external ventricular drainage&#39;</span><span class="p">,</span> <span class="s1">&#39;decompressive craniectomy&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% neurosurgery type - intracranial hematoma evacuation&#39;</span><span class="p">,</span> <span class="s1">&#39;% neurosurgery type - external ventricular drainage&#39;</span><span class="p">,</span> <span class="s1">&#39;% neurosurgery type - decompressive craniectomy&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% NEUROSURGERY TYPE PERFORMED for ICH in comprehensive centres&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">###################################</span>
        <span class="c1"># NEUROSURGERY TYPE (LAST OPTION) #</span>
        <span class="c1">###################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% neurosurgery type - Referred to another centre&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PATIENTS REFERRED TO ANOTHER CENTRE FOR NEUROSURGERY&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">###################</span>
        <span class="c1"># BLEEDING REASON #</span>
        <span class="c1">###################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bleeding_arterial_hypertension_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_aneurysm_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_arterio_venous_malformation_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_anticoagulation_therapy_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_amyloid_angiopathy_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_other_perc_norm&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;bleeding_arterial_hypertension_perc_norm&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;arterial hypertension&#39;</span><span class="p">,</span> <span class="s1">&#39;aneurysm&#39;</span><span class="p">,</span> <span class="s1">&#39;arterio-venous malformation&#39;</span><span class="p">,</span> <span class="s1">&#39;anticoagulation therapy&#39;</span><span class="p">,</span> <span class="s1">&#39;amyloid angiopathy&#39;</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;bleeding_arterial_hypertension_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_aneurysm_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_arterio_venous_malformation_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_anticoagulation_therapy_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_amyloid_angiopathy_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;bleeding_other_perc_norm&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% BLEEDING REASON for ICH&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">##########################</span>
        <span class="c1"># INTERVENTION PERFORMED #</span>
        <span class="c1">##########################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;intervention_endovascular_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_neurosurgical_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_other_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_referred_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_none_perc_norm&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;intervention_endovascular_perc_norm&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Endovascular (coiling)&#39;</span><span class="p">,</span> <span class="s1">&#39;Neurosurgical (clipping)&#39;</span><span class="p">,</span> <span class="s1">&#39;Other neurosurgical treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;Patient referred to another centre&#39;</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;intervention_endovascular_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_neurosurgical_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_other_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_referred_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;intervention_none_perc_norm&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% INTERVENTION PERFORMED for SAH&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">##########################################</span>
        <span class="c1"># % PATIENTS ASSESSED FOR REHABILITATION #</span>
        <span class="c1">##########################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients assessed for rehabilitation - Yes&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% REHABILITATION ASSESSMENT out of all cases&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">###############################</span>
        <span class="c1"># VENOUS THROMBOSIS TREATMENT #</span>
        <span class="c1">###############################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;vt_treatment_anticoagulation_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vt_treatment_thrombectomy_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vt_treatment_local_thrombolysis_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vt_treatment_local_neurological_treatment_perc_norm&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;vt_treatment_anticoagulation_perc_norm&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;anticoagulation&#39;</span><span class="p">,</span> <span class="s1">&#39;thrombectomy&#39;</span><span class="p">,</span> <span class="s1">&#39;local thrombolysis&#39;</span><span class="p">,</span> <span class="s1">&#39;neurosurgical treatment&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;vt_treatment_anticoagulation_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vt_treatment_thrombectomy_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vt_treatment_local_thrombolysis_perc_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;vt_treatment_local_neurological_treatment_perc_norm&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% VENOUS THROMBOSIS TREATMENT for CVT&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">################################</span>
        <span class="c1"># ATRIAL FIBRILLATION DETECTED #</span>
        <span class="c1">################################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;% afib/flutter - Detected during hospitalization&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib/flutter - Newly-detected at admission&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib/flutter - Known&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% afib/flutter - Detected during hospitalization&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;detected during hospitalization&#39;</span><span class="p">,</span> <span class="s1">&#39;newly-detected at admission&#39;</span><span class="p">,</span> <span class="s1">&#39;known aFib&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% afib/flutter - Detected during hospitalization&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib/flutter - Newly-detected at admission&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib/flutter - Known&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% ATRIAL FIBRILLATION DETECTED for IS, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">########################################</span>
        <span class="c1"># ATRIAL FIBRILLATION DETECTION METHOD #</span>
        <span class="c1">########################################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;% afib detection method - Telemetry with monitor allowing automatic detection of aFib&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - Telemetry without monitor allowing automatic detection of aFib&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - Holter-type monitoring&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - EKG monitoring in an ICU bed with automatic detection of aFib&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - EKG monitoring in an ICU bed without automatic detection of aFib&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% afib detection method - Telemetry with monitor allowing automatic detection of aFib&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Telemetry with monitoring&#39;</span><span class="p">,</span> <span class="s1">&#39;Telemetry without monitoring&#39;</span><span class="p">,</span> <span class="s1">&#39;Holter-type monitoring&#39;</span><span class="p">,</span> <span class="s1">&#39;EKG monitoring in an ICU bed with automatic detection of aFib&#39;</span><span class="p">,</span> <span class="s1">&#39;EKG monitoring in an ICU bed without automatic detection of aFib&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - Telemetry with monitor allowing automatic detection of aFib&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - Telemetry without monitor allowing automatic detection of aFib&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - Holter-type monitoring&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - EKG monitoring in an ICU bed with automatic detection of aFib&#39;</span><span class="p">,</span> <span class="s1">&#39;% afib detection method - EKG monitoring in an ICU bed without automatic detection of aFib&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% ATRIAL FIBRILLATION DETECTION METHOD&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">#######################################</span>
        <span class="c1"># AMBULATORY HEART RHYTHM RECOMMENDED #</span>
        <span class="c1">#######################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% o</span><span class="s1">ther afib detection method - Yes&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% AMBULATORY HEART RHYTHM RECOMMENDED for IS, TIA without AFib detection&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">##################################</span>
        <span class="c1"># CAROTID ARTERIES IMAGING - YES #</span>
        <span class="c1">##################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid arteries imaging - Yes&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% CAROTID ARTERIES IMAGING PERFORMED for IS, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">##############################</span>
        <span class="c1"># ANTITHROMBOTICS PRESCRIBED #</span>
        <span class="c1">##############################</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        column_name = &#39;% patients receiving antiplatelets&#39;</span>
<span class="sd">        legend = [&#39;Antiplatelets&#39;, &#39;Vitamin K&#39;, &#39;Dabigatran&#39;, &#39;Rivaroxaban&#39;, &#39;Apixaban&#39;, &#39;Edoxaban&#39;, &#39;LMWH or heparin in prophylactic dose&#39;, &#39;LMWH or heparin in anticoagulant dose&#39;]</span>

<span class="sd">        tmp_df = df[[main_col, &#39;% patients prescribed antithrombotics&#39;, &#39;% patients receiving antiplatelets&#39;, &#39;% patients receiving Vit. K antagonist&#39;, &#39;% patients receiving dabigatran&#39;, &#39;% patients receiving rivaroxaban&#39;, &#39;% patients receiving apixaban&#39;, &#39;% patients receiving edoxaban&#39;, &#39;% patients receiving LMWH or heparin in prophylactic dose&#39;, &#39;% patients receiving LMWH or heparin in full anticoagulant dose&#39;]]</span>

<span class="sd">        tmp_df = tmp_df.sort_values([&#39;% patients prescribed antithrombotics&#39;], ascending = True)</span>

<span class="sd">        title = &quot;% ANTITHROMBOTICS PRESCRIBED for IS, TIA&quot;</span>

<span class="sd">        GenerateGraphs(dataframe=tmp_df, presentation=prs, title=title, column_name=column_name, country=self.country_name, legend=legend, number_of_series=len(legend), graph_type=&#39;stacked&#39;)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1">##################################################</span>
        <span class="c1"># % PATIENTS PRESCRIBED ANTICOAGULANTS WITH AFIB #</span>
        <span class="c1">##################################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed anticoagulants with aFib&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PATIENTS WITH AFIB, PRESCRIBED ANTICOAGULANTS for IS, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">#########################################################</span>
        <span class="c1"># % PATIENTS PRESCRIBED ANTICOAGULANTS WITH AFIB (HOME) #</span>
        <span class="c1">#########################################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% afib patients discharged home with anticoagulants&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PATIENTS DISCHARGED HOME WITH AFIB, PRESCRIBED ANTICOAGULANTS </span><span class="se">\n</span><span class="s2">for IS, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">##################################################</span>
        <span class="c1"># PATIENTS PRESCRIBED ANTIPLATELETS WITHOUT AFIB #</span>
        <span class="c1">##################################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed antiplatelets without aFib&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PATIENTS WITHOUT AFIB, PRESCRIBED ANTIPLATELETS for IS, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        
        <span class="c1">###################################</span>
        <span class="c1"># NOT PRESCRIBED, BUT RECOMMENDED #</span>
        <span class="c1">###################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients not prescribed antithrombotics, but recommended&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PATIENTS NOT PRESCRIBED, BUT RECOMMENDED ANTITHROMBOTICS for IS, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">############</span>
        <span class="c1"># WITH CVT #</span>
        <span class="c1">############</span>
        <span class="c1">##############################</span>
        <span class="c1"># ANTITHROMBOTICS PRESCRIBED #</span>
        <span class="c1">##############################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients receiving antiplatelets with CVT&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Antiplatelets&#39;</span><span class="p">,</span> <span class="s1">&#39;Vitamin K&#39;</span><span class="p">,</span> <span class="s1">&#39;Dabigatran&#39;</span><span class="p">,</span> <span class="s1">&#39;Rivaroxaban&#39;</span><span class="p">,</span> <span class="s1">&#39;Apixaban&#39;</span><span class="p">,</span> <span class="s1">&#39;Edoxaban&#39;</span><span class="p">,</span> <span class="s1">&#39;LMWH or heparin in prophylactic dose&#39;</span><span class="p">,</span> <span class="s1">&#39;LMWH or heparin in anticoagulant dose&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% patients prescribed antithrombotics with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving antiplatelets with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving Vit. K antagonist with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving dabigatran with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving rivaroxaban with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving apixaban with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving edoxaban with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving LMWH or heparin in prophylactic dose with CVT&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients receiving LMWH or heparin in full anticoagulant dose with CVT&#39;</span><span class="p">]]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;% patients prescribed antithrombotics with CVT&#39;</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% ANTITHROMBOTICS PRESCRIBED for IS, TIA, CVT&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">##################################################</span>
        <span class="c1"># % PATIENTS PRESCRIBED ANTICOAGULANTS WITH AFIB #</span>
        <span class="c1">##################################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed anticoagulants with aFib with CVT&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PATIENTS WITH AFIB, PRESCRIBED ANTICOAGULANTS for IS, TIA, CVT&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">##################################################</span>
        <span class="c1"># PATIENTS PRESCRIBED ANTIPLATELETS WITHOUT AFIB #</span>
        <span class="c1">##################################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed antiplatelets without aFib with CVT&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PATIENTS WITHOUT AFIB, PRESCRIBED ANTIPLATELETS for IS, TIA, CVT&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        
        <span class="c1">###################################</span>
        <span class="c1"># NOT PRESCRIBED, BUT RECOMMENDED #</span>
        <span class="c1">###################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients not prescribed antithrombotics, but recommended with CVT&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% PATIENTS NOT PRESCRIBED, BUT RECOMMENDED ANTITHROMBOTICS </span><span class="se">\n</span><span class="s2">for IS, TIA, CVT&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">##########################</span>
        <span class="c1"># DISCHARGE WITH STATINS #</span>
        <span class="c1">##########################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed statins - Yes&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% DISCHARGED WITH STATINS for IS, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">#############################</span>
        <span class="c1"># CAROTID STENOSIS DETECTED #</span>
        <span class="c1">#############################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid stenosis - &gt;70%&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% CAROTID STENOSIS OF OVER 70 PERCENT for IS, TIA&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">##################################################</span>
        <span class="c1"># % CAROTID STENOSIS FOLLOWUP - YES, BUT PLANNED #</span>
        <span class="c1">##################################################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid stenosis followup - Yes, but planned&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid stenosis followup - Referred to another centre&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid stenosis followup - Yes, but planned&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Yes or planned&#39;</span><span class="p">,</span> <span class="s1">&#39;Referred to another centre&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid stenosis followup - Yes, but planned&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid stenosis followup - Referred to another centre&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">% E</span><span class="s2">NDARTERECTOMY OR ANGIOPLASTY / STENTING DONE OR PLANNED for IS, TIA with ICA STENOSIS &gt; 70%&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">#############################################################</span>
        <span class="c1"># % ANTIHYPERTENSIVE MEDICATION PRESCRIBED out of all cases #</span>
        <span class="c1">#############################################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% prescribed antihypertensives - Yes&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% ANTIHYPERTENSIVE MEDICATION PRESCRIBED out of all cases&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">######################################################</span>
        <span class="c1"># % RECOMMENDED TO A SMOKING CESSATION PROGRAM - YES #</span>
        <span class="c1">######################################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecommended to a smoking cessation program - Yes&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% RECOMMENDED TO A SMOKING CESSATION PROGRAM out of smokers&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">###########################################################</span>
        <span class="c1"># % RECOMMENDED TO A CEREBROVASCULAR EXPERT - RECOMMENDED #</span>
        <span class="c1">###########################################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecommended to a cerebrovascular expert - Recommended&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% RECOMMENDED TO A CEREBROVASCULAR EXPERT out of all cases&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">#########################</span>
        <span class="c1"># DISCHARGE DESTINATION #</span>
        <span class="c1">#########################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Home&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Transferred within the same centre&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Transferred to another centre&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Social care facility&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Dead&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Home&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;home&#39;</span><span class="p">,</span> <span class="s1">&#39;transferred within the same centre&#39;</span><span class="p">,</span> <span class="s1">&#39;transferred to another centre&#39;</span><span class="p">,</span> <span class="s1">&#39;social care facility&#39;</span><span class="p">,</span> <span class="s1">&#39;dead&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Home&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Transferred within the same centre&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Transferred to another centre&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Social care facility&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ischarge destination - Dead&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% DISCHARGE DESTINATION&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">############################################################################</span>
        <span class="c1"># DISCHARGE DESTINATION - DEPARTMENT TRANSFERRED TO WITHIN THE SAME CENTRE #</span>
        <span class="c1">############################################################################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;% transferred within the same centre - Acute rehabilitation&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred within the same centre - Post-care bed&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred within the same centre - Another department&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% transferred within the same centre - Acute rehabilitation&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Acute rehabilitation&#39;</span><span class="p">,</span> <span class="s1">&#39;Post-care bed&#39;</span><span class="p">,</span> <span class="s1">&#39;Another department&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% transferred within the same centre - Acute rehabilitation&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred within the same centre - Post-care bed&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred within the same centre - Another department&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% DISCHARGE DESTINATION - PATIENT TRANSFERRED WITHIN THE SAME CENTRE&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">####################################################</span>
        <span class="c1"># % DISCHARGE DESTINATION - CENTRE TRANSFERRED TO  #</span>
        <span class="c1">####################################################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;% transferred to another centre - Stroke centre&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred to another centre - Comprehensive stroke centre&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred to another centre - Another hospital&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% transferred to another centre - Stroke centre&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Stroke centre&#39;</span><span class="p">,</span> <span class="s1">&#39;Comprehensive stroke centre&#39;</span><span class="p">,</span> <span class="s1">&#39;Another hospital&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% transferred to another centre - Stroke centre&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred to another centre - Comprehensive stroke centre&#39;</span><span class="p">,</span> <span class="s1">&#39;% transferred to another centre - Another hospital&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% DISCHARGE DESTINATION - PATIENT TRANSFERRED TO ANOTHER CENTRE&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">#################################################################################</span>
        <span class="c1"># % DISCHARGE DESTINATION - DEPARTMENT TRANSFERRED TO WITHIN TO ANOTHER CENTRE  #</span>
        <span class="c1">#################################################################################</span>
        <span class="n">sorted_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Acute rehabilitation&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Post-care bed&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Neurology&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Another department&#39;</span><span class="p">]</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Acute rehabilitation&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Acute rehabilitation&#39;</span><span class="p">,</span> <span class="s1">&#39;Post-care bed&#39;</span><span class="p">,</span> <span class="s1">&#39;Neurology&#39;</span><span class="p">,</span> <span class="s1">&#39;Another department&#39;</span><span class="p">]</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Acute rehabilitation&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Post-care bed&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Neurology&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment transferred to within another centre - Another department&#39;</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">sorted_by</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% DISCHARGE DESTINATION - PATIENT TRANSFERRED TO ANOTHER CENTRE (DEPARTMENT)&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">########################</span>
        <span class="c1"># MEDIAN DISCHARGE mRS #</span>
        <span class="c1">########################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median discharge mRS&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MEDIAN DISCHARGE MRS&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1">###############################</span>
        <span class="c1"># MEDIAN HOSPITAL STAY (DAYS) #</span>
        <span class="c1">###############################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median hospital stay (days)&#39;</span>

        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MEDIAN HOSPITAL STAY (DAYS)&quot;</span>

        <span class="n">GenerateGraphs</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country_name</span><span class="p">)</span>

        <span class="c1"># set pptx output name (for cz it&#39;ll be presentation_CZ.pptx)</span>
        <span class="n">working_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="n">pptx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">site_code</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">quarter</span> <span class="o">+</span> <span class="s2">&quot;.pptx&quot;</span>
        <span class="n">presentation_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span> <span class="n">pptx</span><span class="p">))</span>

        <span class="n">prs</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">presentation_path</span><span class="p">)</span></div>






        


</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">RES-Q package</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Marie Jankujova.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
    </div>

    

    
  </body>
</html>