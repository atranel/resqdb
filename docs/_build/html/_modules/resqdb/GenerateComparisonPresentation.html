
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>resqdb.GenerateComparisonPresentation &#8212; RES-Q package January, 2019 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for resqdb.GenerateComparisonPresentation</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">File name: GenerateComparisonPresentation.py</span>
<span class="sd">Package: resq</span>
<span class="sd">Written by: Marie Jankujova - jankujova.marie@fnusa.cz on 11-2018</span>
<span class="sd">Version: v1.0</span>
<span class="sd">Version comment: The first version of script which generate comaparison into presentation in PPTX format.  </span>
<span class="sd">Description: This script is used to generate comparison charts into presentation. </span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">date</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">pytz</span>

<span class="kn">import</span> <span class="nn">xlsxwriter</span>


<span class="kn">import</span> <span class="nn">csv</span>

<span class="kn">from</span> <span class="nn">pptx</span> <span class="k">import</span> <span class="n">Presentation</span>
<span class="kn">from</span> <span class="nn">pptx.chart.data</span> <span class="k">import</span> <span class="n">CategoryChartData</span><span class="p">,</span> <span class="n">ChartData</span>
<span class="kn">from</span> <span class="nn">pptx.enum.shapes</span> <span class="k">import</span> <span class="n">MSO_SHAPE</span>
<span class="kn">from</span> <span class="nn">pptx.enum.chart</span> <span class="k">import</span> <span class="n">XL_CHART_TYPE</span><span class="p">,</span> <span class="n">XL_TICK_MARK</span><span class="p">,</span> <span class="n">XL_TICK_LABEL_POSITION</span><span class="p">,</span> <span class="n">XL_LEGEND_POSITION</span><span class="p">,</span> <span class="n">XL_LABEL_POSITION</span>
<span class="kn">from</span> <span class="nn">pptx.enum.text</span> <span class="k">import</span> <span class="n">MSO_AUTO_SIZE</span>
<span class="kn">from</span> <span class="nn">pptx.util</span> <span class="k">import</span> <span class="n">Cm</span><span class="p">,</span> <span class="n">Pt</span><span class="p">,</span> <span class="n">Inches</span>
<span class="kn">from</span> <span class="nn">pptx.dml.color</span> <span class="k">import</span> <span class="n">RGBColor</span>
<span class="kn">from</span> <span class="nn">pptx.enum.dml</span> <span class="k">import</span> <span class="n">MSO_LINE</span>
<span class="kn">from</span> <span class="nn">pptx.oxml.xmlchemy</span> <span class="k">import</span> <span class="n">OxmlElement</span>

<div class="viewcode-block" id="GeneratePeriodCompPresentation"><a class="viewcode-back" href="../../source/resqdb.html#resqdb.GenerateComparisonPresentation.GeneratePeriodCompPresentation">[docs]</a><span class="k">class</span> <span class="nc">GeneratePeriodCompPresentation</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class takes as arguments two dataframes which represents two different periods of time and creates comparison graphs.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        ndf1 - dataframe containing data for first period</span>
<span class="sd">        ndf2 - dataframe containing data for second period</span>
<span class="sd">        name1 - name of first period (e.g. 2017)</span>
<span class="sd">        name2 - name of 2nd periodn (e.g. 2018) </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ndf1</span><span class="p">,</span> <span class="n">ndf2</span><span class="p">,</span> <span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ndf1</span> <span class="o">=</span> <span class="n">ndf1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndf2</span> <span class="o">=</span> <span class="n">ndf2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name1</span> <span class="o">=</span> <span class="n">name1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name2</span> <span class="o">=</span> <span class="n">name2</span>

        <span class="c1"># Get absolute path to the database.</span>
        <span class="n">script_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span> <span class="c1">#&lt;-- absolute dir the script is in</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;resq.db&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">abs_db_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_dir</span><span class="p">,</span> <span class="s2">&quot;database&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

        <span class="n">master_pptx</span> <span class="o">=</span> <span class="s2">&quot;countries_comparison.pptx&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_dir</span><span class="p">,</span> <span class="s2">&quot;backgrounds&quot;</span><span class="p">,</span> <span class="n">master_pptx</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_generate_graphs</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">_generate_graphs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This function generates graphs into presentation .pptx.&quot;&quot;&quot;</span>

        <span class="n">prs</span> <span class="o">=</span> <span class="n">Presentation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>

        <span class="n">first_slide</span> <span class="o">=</span> <span class="n">prs</span><span class="o">.</span><span class="n">slides</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">first_slide</span><span class="o">.</span><span class="n">shapes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">text_frame</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">text_frame</span>

        <span class="n">first_slide_text</span> <span class="o">=</span> <span class="s2">&quot;Data Comparison&quot;</span>
    
        <span class="n">p</span> <span class="o">=</span> <span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">run</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
        <span class="n">run</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">first_slide_text</span>

        <span class="n">font</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">font</span>
        <span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Calibri Light&#39;</span>
        <span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span>
        <span class="n">font</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span><span class="mi">250</span><span class="p">,</span><span class="mi">250</span><span class="p">)</span>

        <span class="c1"># if (self.country_name in [&#39;Ukraine&#39;, &#39;Poland&#39;] and len(df) &gt; 2):</span>
        <span class="c1">#     main_col = &#39;Site ID&#39;</span>
        <span class="c1"># else:</span>
        <span class="n">main_col</span> <span class="o">=</span> <span class="s1">&#39;Site Name&#39;</span>

        <span class="c1"># main_col = &quot;Site Name&quot;</span>

        <span class="c1">########################</span>
        <span class="c1">#### TOTAL PATIENTS ####</span>
        <span class="c1">########################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Total Patients&#39;</span>
        <span class="c1"># Nationally df</span>
        <span class="n">tmp_ndf1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf1</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf1</span> <span class="o">=</span> <span class="n">tmp_ndf1</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Site-level df</span>
        <span class="n">tmp_ndf2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf2</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf2</span> <span class="o">=</span> <span class="n">tmp_ndf2</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Merge dataframes</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tmp_ndf1</span><span class="p">,</span> <span class="n">tmp_ndf2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Site Name&#39;</span><span class="p">])</span>
        <span class="n">tmp_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">main_col</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Total patients enrolled&quot;</span>

        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name2</span><span class="p">]</span>
        
        <span class="n">GeneratePeriodCompGraph</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">)</span>

        <span class="c1">###########################################</span>
        <span class="c1">#### PATIENTS RECEIVING RECANALIZATION ####</span>
        <span class="c1">###########################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients recanalized&#39;</span>
        <span class="c1"># Nationally df</span>
        <span class="n">tmp_ndf1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf1</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf1</span> <span class="o">=</span> <span class="n">tmp_ndf1</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Site-level df</span>
        <span class="n">tmp_ndf2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf2</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf2</span> <span class="o">=</span> <span class="n">tmp_ndf2</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Merge dataframes</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tmp_ndf1</span><span class="p">,</span> <span class="n">tmp_ndf2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Site Name&#39;</span><span class="p">])</span>
        <span class="n">tmp_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">main_col</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% patients receiving recanalization procedures&quot;</span>
        <span class="n">subtitle</span> <span class="o">=</span> <span class="s2">&quot;Calculated out of number of IS&quot;</span>

        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name2</span><span class="p">]</span>
        
        <span class="n">GeneratePeriodCompGraph</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="n">subtitle</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">)</span>

        <span class="c1">##############################</span>
        <span class="c1">#### MEDIAN DTN (MINUTES) ####</span>
        <span class="c1">##############################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median DTN (minutes)&#39;</span>
        <span class="c1"># Nationally df</span>
        <span class="n">tmp_ndf1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf1</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf1</span> <span class="o">=</span> <span class="n">tmp_ndf1</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Site-level df</span>
        <span class="n">tmp_ndf2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf2</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf2</span> <span class="o">=</span> <span class="n">tmp_ndf2</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Merge dataframes</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tmp_ndf1</span><span class="p">,</span> <span class="n">tmp_ndf2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Site Name&#39;</span><span class="p">])</span>
        <span class="n">tmp_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">main_col</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Median Door-to-Needle Time (DTN), in minutes&quot;</span>

        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name2</span><span class="p">]</span>
        
        <span class="n">GeneratePeriodCompGraph</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">)</span>

        <span class="c1">##############################</span>
        <span class="c1">#### MEDIAN DTG (MINUTES) ####</span>
        <span class="c1">##############################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median DTG (minutes)&#39;</span>
        <span class="c1"># Nationally df</span>
        <span class="n">tmp_ndf1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf1</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf1</span> <span class="o">=</span> <span class="n">tmp_ndf1</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Site-level df</span>
        <span class="n">tmp_ndf2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf2</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf2</span> <span class="o">=</span> <span class="n">tmp_ndf2</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Merge dataframes</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tmp_ndf1</span><span class="p">,</span> <span class="n">tmp_ndf2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Site Name&#39;</span><span class="p">])</span>
        <span class="n">tmp_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">main_col</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Median Door-to-Needle Time (DTG), in minutes&quot;</span>

        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name2</span><span class="p">]</span>
        
        <span class="n">GeneratePeriodCompGraph</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">)</span>
        

        <span class="c1"># set pptx output name (for cz it&#39;ll be presentation_CZ.pptx)</span>
        <span class="n">working_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="n">pptx</span> <span class="o">=</span> <span class="s2">&quot;comparison_two_periods.pptx&quot;</span>
        <span class="n">presentation_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span> <span class="n">pptx</span><span class="p">))</span>

        <span class="n">prs</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">presentation_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeneratePeriodCompGraph"><a class="viewcode-back" href="../../source/resqdb.html#resqdb.GenerateComparisonPresentation.GeneratePeriodCompGraph">[docs]</a><span class="k">class</span> <span class="nc">GeneratePeriodCompGraph</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function generates graphs into given presentation. </span>

<span class="sd">    Arguments:</span>
<span class="sd">        df - dataframe containing values for each period in one column</span>
<span class="sd">        presentation - opened presentation document</span>
<span class="sd">        column_name - the name of column</span>
<span class="sd">        title - the name of slide</span>
<span class="sd">        subtitle - the subtitle of slide (smaller font)</span>
<span class="sd">        number_of_series - number of values in one column (bar) for stacked charplots</span>
<span class="sd">        legend - list of legend names</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">presentation</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">presentation</span> <span class="o">=</span> <span class="n">presentation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column_name</span> <span class="o">=</span> <span class="n">column_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">=</span> <span class="n">number_of_series</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span> <span class="o">=</span> <span class="s1">&#39;Roboto&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legend</span> <span class="o">=</span> <span class="n">legend</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subtitle</span> <span class="o">=</span> <span class="n">subtitle</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">category_font_size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_label_font_size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">categories_column</span> <span class="o">=</span> <span class="s1">&#39;Site Name&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_create_column_clustered_barplot</span><span class="p">()</span>
        

    <span class="k">def</span> <span class="nf">_get_length_of_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">legend</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return number of letters in legend to adjust the font size of legend.&quot;&quot;&quot;</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">legend</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">count</span>

    <span class="k">def</span> <span class="nf">_create_column_clustered_barplot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create column clustered barplot.&quot;&quot;&quot;</span>

        <span class="n">maximum</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1"># Get column names of dataframe</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories_column</span><span class="p">)</span>

        <span class="c1"># Add slide to presentation (layout 11 is our custom layout where only title &#39;Agency FB&#39;, color: RGBColor(43, 88, 173)  and size:24 is set)</span>
        <span class="n">slide</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">presentation</span><span class="o">.</span><span class="n">slides</span><span class="o">.</span><span class="n">add_slide</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">presentation</span><span class="o">.</span><span class="n">slide_layouts</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span>
        <span class="c1"># Get title object</span>
        <span class="n">title_placeholders</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">title</span>
        <span class="c1"># Set title</span>
        <span class="n">title_placeholders</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>

        <span class="c1"># If subtitle is not set, remove placeholder for the subtitle from page. </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtitle</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">placeholders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">sp</span> <span class="o">=</span> <span class="n">subtitle</span><span class="o">.</span><span class="n">element</span>
            <span class="n">sp</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">placeholders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">subtitle</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtitle</span>

        <span class="c1"># 1st chart (left side) - nationally sample</span>
        <span class="n">chart_data</span> <span class="o">=</span> <span class="n">ChartData</span><span class="p">()</span>
        <span class="n">chart_data</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">categories_column</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="c1"># Add data in each category </span>
        <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span> 
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

        <span class="c1"># Set margins.</span>
        <span class="n">specs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">16.5</span><span class="p">),</span>
            <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span>
            <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">0.7</span><span class="p">),</span>
            <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="n">chart</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span>
            <span class="n">XL_CHART_TYPE</span><span class="o">.</span><span class="n">COLUMN_CLUSTERED</span><span class="p">,</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">],</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">chart_data</span><span class="p">)</span><span class="o">.</span><span class="n">chart</span>

        <span class="c1"># Get series of chart</span>
        <span class="n">series</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Get plot </span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">gap_width</span> <span class="o">=</span> <span class="mi">220</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">overlap</span> <span class="o">=</span> <span class="o">-</span><span class="mi">25</span>
        <span class="c1"># Set for each bar same color</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">vary_by_categories</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Show data labels and set font</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        plot.has_data_labels = False</span>
<span class="sd">        data_labels = plot.data_labels</span>
<span class="sd">        data_labels.font.size = self.data_label_font_size</span>
<span class="sd">        data_labels.font.bold = True</span>
<span class="sd">        data_labels.font.name = self.font_name&#39;&#39;&#39;</span>

        <span class="c1"># Value for x-axis (change font size, name, and other things)</span>
        <span class="n">value_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">value_axis</span>
        <span class="n">tick_labels</span> <span class="o">=</span> <span class="n">value_axis</span><span class="o">.</span><span class="n">tick_labels</span>
        <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">category_font_size</span>
        <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>

        <span class="c1"># Don&#39;t show major gridlines</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">has_major_gridlines</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">major_gridlines</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">217</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">217</span><span class="p">)</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">major_gridlines</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">major_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">NONE</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">217</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">217</span><span class="p">)</span>
        <span class="c1"># Set range of axis</span>
        <span class="c1">#value_axis.maximum_scale = ndf_maximum</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">minimum_scale</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Value for y-axis (change font size, name, and other things)</span>
        <span class="n">category_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">category_axis</span>
        <span class="n">category_axis</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">217</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">217</span><span class="p">)</span>
        <span class="c1"># Delete tick marks</span>
        <span class="n">category_axis</span><span class="o">.</span><span class="n">major_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">NONE</span>
        <span class="c1">#category_axis.major_unit = 1</span>
        <span class="n">category_labels</span> <span class="o">=</span> <span class="n">category_axis</span><span class="o">.</span><span class="n">tick_labels</span>
        <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">category_font_size</span>
        <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>

        <span class="c1"># Set legend </span>
        <span class="n">chart</span><span class="o">.</span><span class="n">has_legend</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">XL_LEGEND_POSITION</span><span class="o">.</span><span class="n">BOTTOM</span>
        <span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">include_in_layout</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span></div>

<div class="viewcode-block" id="GenerateCountriesCompPresentation"><a class="viewcode-back" href="../../source/resqdb.html#resqdb.GenerateComparisonPresentation.GenerateCountriesCompPresentation">[docs]</a><span class="k">class</span> <span class="nc">GenerateCountriesCompPresentation</span><span class="p">:</span>     
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class takes as arguments two dataframes which represents two different set of countries in the same period (e.g. nationally samples and site samples) and creates comparison graphs.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        ndf - dataframe containing data for first set of countries in given period</span>
<span class="sd">        sldf - dataframe containing data for second set of countries in given period</span>
<span class="sd">        name - name of given period (e.g. 2017)</span>
<span class="sd">        samples - name of countries which should be colored by different color in the main graph</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ndf</span><span class="p">,</span> <span class="n">sldf</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="p">[]):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span> <span class="o">=</span> <span class="n">ndf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span> <span class="o">=</span> <span class="n">sldf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="c1"># Get absolute path to the database.</span>
        <span class="n">script_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span> <span class="c1">#&lt;-- absolute dir the script is in</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;resq.db&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">abs_db_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_dir</span><span class="p">,</span> <span class="s2">&quot;database&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

        <span class="n">master_pptx</span> <span class="o">=</span> <span class="s2">&quot;countries_comparison.pptx&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_dir</span><span class="p">,</span> <span class="s2">&quot;backgrounds&quot;</span><span class="p">,</span> <span class="n">master_pptx</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">select_country</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;UZB&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;UZ&#39;</span>
            <span class="n">country_name</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">country_names</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">country_name</span>


        <span class="c1"># If country is used as site, the country name is selected from countries dictionary by country code. :</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nationally_countries</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)):</span>
                <span class="n">country</span> <span class="o">=</span> <span class="n">select_country</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nationally_countries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">country</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_generate_graphs</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_generate_graphs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This function generates graphs into presentation (pptx).&quot;&quot;&quot;</span>

        <span class="n">prs</span> <span class="o">=</span> <span class="n">Presentation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>

        <span class="n">first_slide</span> <span class="o">=</span> <span class="n">prs</span><span class="o">.</span><span class="n">slides</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">first_slide</span><span class="o">.</span><span class="n">shapes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">text_frame</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">text_frame</span>

        <span class="n">first_slide_text</span> <span class="o">=</span> <span class="s2">&quot;Data Comparison&quot;</span>
    
        <span class="n">p</span> <span class="o">=</span> <span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">run</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
        <span class="n">run</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">first_slide_text</span>

        <span class="n">font</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">font</span>
        <span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Century Gothic&#39;</span>
        <span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">font</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span><span class="mi">250</span><span class="p">,</span><span class="mi">250</span><span class="p">)</span>

        <span class="c1"># if (self.country_name in [&#39;Ukraine&#39;, &#39;Poland&#39;] and len(df) &gt; 2):</span>
        <span class="c1">#    main_col = &#39;Site ID&#39;</span>
        <span class="c1"># else:</span>
        <span class="n">main_col</span> <span class="o">=</span> <span class="s1">&#39;Site Name&#39;</span>

        <span class="c1">########################</span>
        <span class="c1">#### TOTAL PATIENTS ####</span>
        <span class="c1">########################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Total Patients&#39;</span>
        <span class="c1"># Nationally df</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Site-level df</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="n">tmp_sldf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># combine them to one dataframe</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_sldf</span><span class="p">)</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Total number of cases - admission date in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">GenerateCountriesCompGraphs</span><span class="p">(</span><span class="n">ndf</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">)</span>

        <span class="c1">#if self.country_name is not None:</span>
         <span class="c1">#   tmp_df = tmp_df.loc[tmp_df[main_col] != self.country_name]</span>

        <span class="c1">########################</span>
        <span class="c1">#### TOTAL PATIENTS ####</span>
        <span class="c1">########################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Total Patients&#39;</span>
        <span class="c1"># Nationally df</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Site-level df</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="n">tmp_sldf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># combine them to one dataframe</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_sldf</span><span class="p">)</span>
        <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Total number of cases - admission date in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">GenerateCountriesCompGraphs</span><span class="p">(</span><span class="n">ndf</span><span class="o">=</span><span class="n">tmp_df</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nationally_countries</span><span class="p">)</span>

        <span class="c1">#if self.country_name is not None:</span>
         <span class="c1">#   tmp_df = tmp_df.loc[tmp_df[main_col] != self.country_name]</span>
        
        <span class="c1">############################</span>
        <span class="c1">#### MEDIAN PATIENT AGE ####</span>
        <span class="c1">############################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median patient age&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Median patient age&#39;</span>
        <span class="c1"># Nationally df</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Site-level df</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="n">tmp_sldf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">GenerateCountriesCompGraphs</span><span class="p">(</span><span class="n">ndf</span><span class="o">=</span><span class="n">tmp_ndf</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="n">tmp_sldf</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">)</span>

        <span class="c1">###############</span>
        <span class="c1"># STROKE TYPE #</span>
        <span class="c1">###############</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - ischemic stroke&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ischemic&#39;</span><span class="p">,</span> <span class="s1">&#39;transient ischemic attack&#39;</span><span class="p">,</span> <span class="s1">&#39;intracerebral hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;subarrachnoid hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;cerebral venous thrombosis&#39;</span><span class="p">,</span> <span class="s1">&#39;undetermined&#39;</span><span class="p">]</span>

        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - ischemic stroke&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - transient ischemic attack&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - intracerebral hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - subarrachnoid hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - cerebral venous thrombosis&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - undetermined stroke&#39;</span><span class="p">]]</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - ischemic stroke&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - transient ischemic attack&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - intracerebral hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - subarrachnoid hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - cerebral venous thrombosis&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - undetermined stroke&#39;</span><span class="p">]]</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="n">tmp_sldf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Stroke type, ordered by </span><span class="si">% i</span><span class="s2">schemic stroke&quot;</span>

        <span class="n">GenerateCountriesCompGraphs</span><span class="p">(</span><span class="n">ndf</span><span class="o">=</span><span class="n">tmp_ndf</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="n">tmp_sldf</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">#######################</span>
        <span class="c1">### DEPARTMENT TYPE ###</span>
        <span class="c1">#######################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - neurology&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;neurology&#39;</span><span class="p">,</span> <span class="s1">&#39;neurosurgery&#39;</span><span class="p">,</span> <span class="s1">&#39;anesthesiology resuscitation critical care&#39;</span><span class="p">,</span> <span class="s1">&#39;internal medicine&#39;</span><span class="p">,</span> <span class="s1">&#39;geriatrics&#39;</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">]</span>

        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - neurology&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - neurosurgery&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - anesthesiology/resuscitation/critical care&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - internal medicine&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - geriatrics&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - Other&#39;</span><span class="p">]]</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - neurology&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - neurosurgery&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - anesthesiology/resuscitation/critical care&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - internal medicine&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - geriatrics&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - Other&#39;</span><span class="p">]]</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="n">tmp_sldf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Department type, ordered by % neurology&quot;</span>

        <span class="n">GenerateCountriesCompGraphs</span><span class="p">(</span><span class="n">ndf</span><span class="o">=</span><span class="n">tmp_ndf</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="n">tmp_sldf</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">###################################</span>
        <span class="c1">### HOSPITALIZATION DESTINATION ###</span>
        <span class="c1">###################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients hospitalized in stroke unit / ICU&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke unit / ICU&#39;</span><span class="p">,</span> <span class="s1">&#39;% monitored bed with telemetry&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">tandard bed&#39;</span><span class="p">]</span>

        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in stroke unit / ICU&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in monitored bed with telemetry&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in standard bed&#39;</span><span class="p">]]</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in stroke unit / ICU&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in monitored bed with telemetry&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in standard bed&#39;</span><span class="p">]]</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="n">tmp_sldf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Hospitalization type, ordered by </span><span class="si">% s</span><span class="s2">troke unit&quot;</span>

        <span class="n">GenerateCountriesCompGraphs</span><span class="p">(</span><span class="n">ndf</span><span class="o">=</span><span class="n">tmp_ndf</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="n">tmp_sldf</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">)</span>

        <span class="c1">##########################</span>
        <span class="c1">### CT / MRI performed ###</span>
        <span class="c1">##########################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% CT/MRI - performed&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;% performed&#39;</span><span class="p">,</span> <span class="s1">&#39;% performed within 1 hour after admission&#39;</span><span class="p">]</span>

        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% CT/MRI - performed&#39;</span><span class="p">,</span> <span class="s1">&#39;% CT/MRI - Performed within 1 hour after admission&#39;</span><span class="p">]]</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% CT/MRI - performed&#39;</span><span class="p">,</span> <span class="s1">&#39;% CT/MRI - Performed within 1 hour after admission&#39;</span><span class="p">]]</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="n">tmp_sldf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% patients receiving CT / MRI&quot;</span>
        <span class="n">subtitle</span> <span class="o">=</span> <span class="s2">&quot;- Calculated out of number of IS + ICH + TIA + CVT -&quot;</span>

        <span class="n">GenerateCountriesCompGraphs</span><span class="p">(</span><span class="n">ndf</span><span class="o">=</span><span class="n">tmp_ndf</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="n">tmp_sldf</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;grouped&#39;</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="n">subtitle</span><span class="p">)</span>

        <span class="c1">############################</span>
        <span class="c1"># RECANALIZATION TREATMENT #</span>
        <span class="c1">############################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IV tPa&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPa + another centre for endovascular treatment&#39;</span><span class="p">]</span>

        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% patients recanalized&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Endovascular treatment alone&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + referred to another centre for endovascular treatment&#39;</span><span class="p">]]</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% patients recanalized&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Endovascular treatment alone&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + referred to another centre for endovascular treatment&#39;</span><span class="p">]]</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="n">tmp_sldf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% patients receiving recanalization procedures&quot;</span>
        <span class="n">subtitle</span> <span class="o">=</span> <span class="s2">&quot;- Calculated out of number of IS -&quot;</span>

        <span class="n">GenerateCountriesCompGraphs</span><span class="p">(</span><span class="n">ndf</span><span class="o">=</span><span class="n">tmp_ndf</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="n">tmp_sldf</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="n">subtitle</span><span class="p">)</span>

        <span class="c1">################</span>
        <span class="c1"># % median DTN #</span>
        <span class="c1">################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median DTN (minutes)&#39;</span>
        <span class="c1"># Nationally df</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Site-level df</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="n">tmp_sldf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Median Door-to-Needle Time (DTN), in minutes&quot;</span>

        <span class="n">GenerateCountriesCompGraphs</span><span class="p">(</span><span class="n">ndf</span><span class="o">=</span><span class="n">tmp_ndf</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="n">tmp_sldf</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">)</span>

        <span class="c1">#######################</span>
        <span class="c1"># dysphagia screening #</span>
        <span class="c1">#######################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Guss test&#39;</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Guss test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Other test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Another centre&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Unable to test&#39;</span><span class="p">]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">% G</span><span class="s1">USS test&#39;</span><span class="p">,</span> <span class="s1">&#39;% Other test&#39;</span><span class="p">,</span> <span class="s1">&#39;% Another centre&#39;</span><span class="p">,</span> <span class="s1">&#39;% Unable to test&#39;</span><span class="p">]</span>

        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Guss test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Other test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Another centre&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Unable to test&#39;</span><span class="p">]]</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Guss test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Other test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Another centre&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Unable to test&#39;</span><span class="p">]]</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="n">tmp_sldf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% patients screened for dysphagia, ordered by </span><span class="si">% G</span><span class="s2">USS test&quot;</span>
        <span class="n">subtitle</span> <span class="o">=</span> <span class="s2">&quot;- Calculated out of number of IS + ICH + CVT -&quot;</span>

        <span class="n">GenerateCountriesCompGraphs</span><span class="p">(</span><span class="n">ndf</span><span class="o">=</span><span class="n">tmp_ndf</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="n">tmp_sldf</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">),</span> <span class="n">graph_type</span><span class="o">=</span><span class="s1">&#39;stacked&#39;</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="n">subtitle</span><span class="p">)</span>

        <span class="c1">#################################</span>
        <span class="c1"># % ASSESSED FOR REHABILITATION #</span>
        <span class="c1">#################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients assessed for rehabilitation - Yes&#39;</span>
        <span class="c1"># Nationally df</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Site-level df</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="n">tmp_sldf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% patients assessed for rehabilitation within 72 hrs after admission&quot;</span>

        <span class="n">GenerateCountriesCompGraphs</span><span class="p">(</span><span class="n">ndf</span><span class="o">=</span><span class="n">tmp_ndf</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="n">tmp_sldf</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">)</span>

        <span class="c1">##################################</span>
        <span class="c1"># CAROTID ARTERIES IMAGING - YES #</span>
        <span class="c1">##################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid arteries imaging - Yes&#39;</span>

        <span class="c1"># Nationally df</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Site-level df</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="n">tmp_sldf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% patients receiving carotid arteries imaging&quot;</span>
        <span class="n">subtitle</span> <span class="o">=</span> <span class="s2">&quot;- Calculated out of number of IS + TIA -&quot;</span>

        <span class="n">GenerateCountriesCompGraphs</span><span class="p">(</span><span class="n">ndf</span><span class="o">=</span><span class="n">tmp_ndf</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="n">tmp_sldf</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="n">subtitle</span><span class="p">)</span>

        <span class="c1">##################################</span>
        <span class="c1"># PRESCRIPTION OF ANTICOAGULANTS #</span>
        <span class="c1">##################################</span>
        <span class="c1"># column_name = &#39;% patients prescribed anticoagulants with aFib with CVT&#39;</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed anticoagulants with aFib&#39;</span>

        <span class="c1"># Nationally df</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Site-level df</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="n">tmp_sldf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Prescription of anticoagulants for patients with atrial fibrillation&quot;</span>
        <span class="n">subtitle</span> <span class="o">=</span> <span class="s2">&quot;- Calculated out of number of patients with atrial fibrillation discharge alive -&quot;</span>

        <span class="n">GenerateCountriesCompGraphs</span><span class="p">(</span><span class="n">ndf</span><span class="o">=</span><span class="n">tmp_ndf</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="n">tmp_sldf</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="n">subtitle</span><span class="p">)</span>

        <span class="c1">###################################</span>
        <span class="c1"># PRESCRIPTION OF ANTITHROMBOTICS #</span>
        <span class="c1">###################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed antithrombotics with aFib&#39;</span>

        <span class="c1"># Nationally df</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Site-level df</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="n">tmp_sldf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Prescription of antithrombotics for patients with atrial fibrillation&quot;</span>
        <span class="n">subtitle</span> <span class="o">=</span> <span class="s2">&quot;- Calculated out of number of patients with atrial fibrillation discharge alive -&quot;</span>

        <span class="n">GenerateCountriesCompGraphs</span><span class="p">(</span><span class="n">ndf</span><span class="o">=</span><span class="n">tmp_ndf</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="n">tmp_sldf</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="n">subtitle</span><span class="p">)</span>

        <span class="c1">##########################</span>
        <span class="c1"># DISCHARGE WITH STATINS #</span>
        <span class="c1">##########################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed statins - Yes&#39;</span>

        <span class="c1"># Nationally df</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Site-level df</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="n">tmp_sldf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% patients discharged on statins&quot;</span>
        <span class="n">subtitle</span> <span class="o">=</span> <span class="s2">&quot;- Calculated out of number of IS + TIA -&quot;</span>

        <span class="n">GenerateCountriesCompGraphs</span><span class="p">(</span><span class="n">ndf</span><span class="o">=</span><span class="n">tmp_ndf</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="n">tmp_sldf</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="n">subtitle</span><span class="p">)</span>
        
        <span class="c1">#############################################################</span>
        <span class="c1"># % ANTIHYPERTENSIVE MEDICATION PRESCRIBED out of all cases #</span>
        <span class="c1">#############################################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% prescribed antihypertensives - Yes&#39;</span>

        <span class="c1"># Nationally df</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Site-level df</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="n">tmp_sldf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% patients prescribed antihypertensives at discharge&quot;</span>
        <span class="n">subtitle</span> <span class="o">=</span> <span class="s2">&quot;- Calculated out of number of patients discharged alive -&quot;</span>

        <span class="n">GenerateCountriesCompGraphs</span><span class="p">(</span><span class="n">ndf</span><span class="o">=</span><span class="n">tmp_ndf</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="n">tmp_sldf</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="n">subtitle</span><span class="p">)</span>

        <span class="c1">###########################################################</span>
        <span class="c1"># % RECOMMENDED TO A CEREBROVASCULAR EXPERT - RECOMMENDED #</span>
        <span class="c1">###########################################################</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecommended to a cerebrovascular expert - Recommended&#39;</span>

        <span class="c1"># Nationally df</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_ndf</span> <span class="o">=</span> <span class="n">tmp_ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Site-level df</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">tmp_sldf</span> <span class="o">=</span> <span class="n">tmp_sldf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="n">column_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;% patients prescribed antihypertensives at discharge&quot;</span>
        <span class="n">subtitle</span> <span class="o">=</span> <span class="s2">&quot;- Calculated out of number of patients discharged alive -&quot;</span>

        <span class="n">GenerateCountriesCompGraphs</span><span class="p">(</span><span class="n">ndf</span><span class="o">=</span><span class="n">tmp_ndf</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="n">tmp_sldf</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="n">subtitle</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="p">)</span>

        <span class="c1"># set pptx output name (for cz it&#39;ll be presentation_CZ.pptx)</span>
        <span class="n">working_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="n">pptx</span> <span class="o">=</span> <span class="s2">&quot;comparison.pptx&quot;</span>
        <span class="n">presentation_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span> <span class="n">pptx</span><span class="p">))</span>

        <span class="n">prs</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">presentation_path</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenerateCountriesCompGraphs"><a class="viewcode-back" href="../../source/resqdb.html#resqdb.GenerateComparisonPresentation.GenerateCountriesCompGraphs">[docs]</a><span class="k">class</span> <span class="nc">GenerateCountriesCompGraphs</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function generates graphs into given presentation for two sets of countries.  </span>

<span class="sd">    Arguments:</span>
<span class="sd">        ndf - dataframe containing values for first set of countries</span>
<span class="sd">        presentation - opened presentation document</span>
<span class="sd">        column_name - the name of column</span>
<span class="sd">        title - the name of slide</span>
<span class="sd">        sldf - dataframe containing values for second set of countries</span>
<span class="sd">        subtitle - the subtitle of slide (smaller font) (default = &quot;&quot;)</span>
<span class="sd">        graph_type - set type of graphs - normal barplot, stacked or grouped (default = None)</span>
<span class="sd">        number_of_series - number of values in one column (bar) for stacked charplots (default = 0)</span>
<span class="sd">        legend - list of legend names (default = None)</span>
<span class="sd">        samples - list of samples which should be colored by different color in normal barplot (default = None)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ndf</span><span class="p">,</span> <span class="n">presentation</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">sldf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">graph_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_series</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span> <span class="o">=</span> <span class="n">ndf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span> <span class="o">=</span> <span class="n">sldf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">presentation</span> <span class="o">=</span> <span class="n">presentation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndf_title</span> <span class="o">=</span> <span class="s2">&quot;Nationally representative sample&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sldf_title</span> <span class="o">=</span> <span class="s2">&quot;Site-level representative sample&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column_name</span> <span class="o">=</span> <span class="n">column_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">=</span> <span class="n">number_of_series</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legend</span> <span class="o">=</span> <span class="n">legend</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subtitle</span> <span class="o">=</span> <span class="n">subtitle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="o">=</span> <span class="n">samples</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span> <span class="o">=</span> <span class="s1">&#39;Century Gothic&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">category_font_size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_label_font_size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">categories_column</span> <span class="o">=</span> <span class="s1">&#39;Site Name&#39;</span>
            
        <span class="c1"># Check type of graph</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">graph_type</span> <span class="o">==</span> <span class="s1">&#39;stacked&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_stacked_barplot</span><span class="p">()</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">graph_type</span> <span class="o">==</span> <span class="s1">&#39;grouped&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_grouped_barplot</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_barplot</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_length_of_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">legend</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return number of letters in legend to adjust the legend font size.&quot;&quot;&quot;</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">legend</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">count</span>

    <span class="k">def</span> <span class="nf">_create_barplot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create normal barplot.&quot;&quot;&quot;</span>

        <span class="n">maximum</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># If graph is in %, set maximum valut to 100. </span>
        <span class="k">if</span> <span class="s1">&#39;%&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">ndf_maximum</span> <span class="o">=</span> <span class="mi">100</span>
            <span class="n">sldf_maximum</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="k">elif</span> <span class="s2">&quot;total number of cases&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">ndf_maximum</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())),</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ndf_maximum</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())),</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">sldf_maximum</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())),</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Add slide to presentation (layout 11 is our custom layout where only title &#39;Agency FB&#39;, color: RGBColor(43, 88, 173)  and size:24 is set)</span>
        <span class="n">slide</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">presentation</span><span class="o">.</span><span class="n">slides</span><span class="o">.</span><span class="n">add_slide</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">presentation</span><span class="o">.</span><span class="n">slide_layouts</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span>
        <span class="c1"># Get title object</span>
        <span class="n">title_placeholders</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">title</span>
        <span class="c1"># Set title</span>
        <span class="n">title_placeholders</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>

        <span class="c1"># If subtitle is not set, then delete placeholder for subtitle in the slide. </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtitle</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">placeholders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">sp</span> <span class="o">=</span> <span class="n">subtitle</span><span class="o">.</span><span class="n">element</span>
            <span class="n">sp</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">placeholders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">subtitle</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtitle</span>

        <span class="c1"># 1st chart (left side) - nationally sample</span>
        <span class="n">chart_data</span> <span class="o">=</span> <span class="n">ChartData</span><span class="p">()</span>
        <span class="n">chart_data</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">categories_column</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

        <span class="k">if</span> <span class="s2">&quot;total number of cases&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
             <span class="c1"># Add chart on slide</span>
            <span class="n">specs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">16.5</span><span class="p">),</span>
            <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span>
            <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">0.7</span><span class="p">),</span>
            <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Add chart on slide</span>
            <span class="n">specs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">16.5</span><span class="p">),</span>
                <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">15.26</span><span class="p">),</span>
                <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
                <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                <span class="p">}</span>

        <span class="n">chart</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span>
            <span class="n">XL_CHART_TYPE</span><span class="o">.</span><span class="n">BAR_CLUSTERED</span><span class="p">,</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">],</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">chart_data</span><span class="p">)</span><span class="o">.</span><span class="n">chart</span>

        <span class="c1"># Get series of chart</span>
        <span class="n">series</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="c1"># If graphs for whole country are generated, set for bar with country with red color</span>
        <span class="c1"># else set to blue color (same color as title uses)</span>
        <span class="k">if</span> <span class="s2">&quot;total number of cases&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">site_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">categories_column</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">points</span><span class="p">):</span>
                <span class="n">fill</span> <span class="o">=</span> <span class="n">point</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span>
                <span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">site_names</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">):</span>
                    <span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">173</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span>
            <span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
            <span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">173</span><span class="p">)</span> 

        <span class="c1"># Get plot </span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Set for each bar same color</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">vary_by_categories</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Show data labels and set font</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">has_data_labels</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">data_labels</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">data_labels</span>
        <span class="n">data_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_label_font_size</span>
        <span class="n">data_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">bold</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">data_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>

        <span class="c1"># Change color of graph title and set color gray</span>
        <span class="k">if</span> <span class="s2">&quot;total number of cases&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">chart_text</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">chart_title</span><span class="o">.</span><span class="n">text_frame</span>
            <span class="n">chart_text</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf_title</span>
            <span class="n">chart_text</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
            <span class="n">chart_text</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">89</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">89</span><span class="p">)</span>

        <span class="c1"># Value for x-axis (change font size, name, and other things)</span>
        <span class="n">value_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">value_axis</span>
        <span class="n">tick_labels</span> <span class="o">=</span> <span class="n">value_axis</span><span class="o">.</span><span class="n">tick_labels</span>
        <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">category_font_size</span>
        <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>

        <span class="c1"># Don&#39;t show major gridlines</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">major_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">OUTSIDE</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">has_major_gridlines</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Set range of axis</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">maximum_scale</span> <span class="o">=</span> <span class="n">ndf_maximum</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">minimum_scale</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Value for y-axis (change font size, name, and other things)</span>
        <span class="n">category_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">category_axis</span>
        <span class="c1"># Delete tick marks</span>
        <span class="n">category_axis</span><span class="o">.</span><span class="n">major_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">NONE</span>
        <span class="n">category_axis</span><span class="o">.</span><span class="n">major_unit</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">category_labels</span> <span class="o">=</span> <span class="n">category_axis</span><span class="o">.</span><span class="n">tick_labels</span>
        <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">category_font_size</span>
        <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>

        <span class="k">if</span> <span class="s2">&quot;total number of cases&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="c1"># 2nd graph (right side) - site-level samples</span>
            <span class="n">chart_data</span> <span class="o">=</span> <span class="n">ChartData</span><span class="p">()</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">categories_column</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

            <span class="c1"># Add chart on slide</span>
            <span class="n">specs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">16.5</span><span class="p">),</span>
                <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">15.26</span><span class="p">),</span>
                <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">17.5</span><span class="p">),</span>
                <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                <span class="p">}</span>

            <span class="n">chart</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span>
                <span class="n">XL_CHART_TYPE</span><span class="o">.</span><span class="n">BAR_CLUSTERED</span><span class="p">,</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">],</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">chart_data</span><span class="p">)</span><span class="o">.</span><span class="n">chart</span>

            <span class="c1"># Get series of chart</span>
            <span class="n">series</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="n">fill</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span>
            <span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
            <span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">173</span><span class="p">)</span> 

            <span class="c1"># Get plot </span>
            <span class="n">plot</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># Set for each bar same color</span>
            <span class="n">plot</span><span class="o">.</span><span class="n">vary_by_categories</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="c1"># Show data labels and set font</span>
            <span class="n">plot</span><span class="o">.</span><span class="n">has_data_labels</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">data_labels</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">data_labels</span>
            <span class="n">data_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_label_font_size</span>
            <span class="n">data_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">bold</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">data_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>

            <span class="c1"># Change color of graph title and set color gray</span>
            <span class="n">chart_text</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">chart_title</span><span class="o">.</span><span class="n">text_frame</span>
            <span class="n">chart_text</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf_title</span>
            <span class="n">chart_text</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
            <span class="n">chart_text</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">89</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">89</span><span class="p">)</span>

            <span class="c1"># Value for x-axis (change font size, name, and other things)</span>
            <span class="n">value_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">value_axis</span>
            <span class="n">tick_labels</span> <span class="o">=</span> <span class="n">value_axis</span><span class="o">.</span><span class="n">tick_labels</span>
            <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">category_font_size</span>
            <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>

            <span class="c1"># Don&#39;t show major gridlines</span>
            <span class="n">value_axis</span><span class="o">.</span><span class="n">major_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">OUTSIDE</span>
            <span class="n">value_axis</span><span class="o">.</span><span class="n">has_major_gridlines</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="c1"># Set range of axis</span>
            <span class="n">value_axis</span><span class="o">.</span><span class="n">maximum_scale</span> <span class="o">=</span> <span class="n">sldf_maximum</span>
            <span class="n">value_axis</span><span class="o">.</span><span class="n">minimum_scale</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># Value for y-axis (change font size, name, and other things)</span>
            <span class="n">category_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">category_axis</span>
            <span class="c1"># Delete tick marks</span>
            <span class="n">category_axis</span><span class="o">.</span><span class="n">major_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">NONE</span>
            <span class="n">category_axis</span><span class="o">.</span><span class="n">major_unit</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">category_labels</span> <span class="o">=</span> <span class="n">category_axis</span><span class="o">.</span><span class="n">tick_labels</span>
            <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">category_font_size</span>
            <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>
    
    <span class="k">def</span> <span class="nf">_create_stacked_barplot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate stacked barplot.&quot;&quot;&quot;</span>

        <span class="c1"># Calculate length of legend (in case that legend is too long, make smaller font size)</span>
        <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_length_of_legend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">)</span>

        <span class="c1"># Get column names of dataframe</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name</span><span class="p">)</span>
        
        <span class="c1"># Add new slide into presentation</span>
        <span class="n">slide</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">presentation</span><span class="o">.</span><span class="n">slides</span><span class="o">.</span><span class="n">add_slide</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">presentation</span><span class="o">.</span><span class="n">slide_layouts</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span>
        <span class="n">title_placeholders</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">title</span>
        <span class="n">title_placeholders</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtitle</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">placeholders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">sp</span> <span class="o">=</span> <span class="n">subtitle</span><span class="o">.</span><span class="n">element</span>
            <span class="n">sp</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">placeholders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">subtitle</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtitle</span>


        <span class="c1"># 1st dataframe (nationally sample)</span>
        <span class="n">chart_data</span> <span class="o">=</span> <span class="n">ChartData</span><span class="p">()</span>
        <span class="n">chart_data</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">categories_column</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="c1"># Add data in each category</span>
        <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">):</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">):</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">):</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">):</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">5</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">7</span><span class="p">):</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">6</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">8</span><span class="p">):</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">7</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

        <span class="c1"># Add chart on slide</span>
        <span class="n">specs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">16.5</span><span class="p">),</span>
            <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">15.26</span><span class="p">),</span>
            <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
            <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="p">}</span>
    
        <span class="n">chart</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span>
            <span class="n">XL_CHART_TYPE</span><span class="o">.</span><span class="n">BAR_STACKED</span><span class="p">,</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">],</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">chart_data</span><span class="p">)</span><span class="o">.</span><span class="n">chart</span>

        <span class="n">series</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># If graphs for whole country are generated, set for bar with country with red color</span>
        <span class="c1"># else set to blue color (same color as title uses)</span>
        <span class="n">fill</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span>
        <span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
        <span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">173</span><span class="p">)</span>   

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">):</span>
            <span class="n">series</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span>
            <span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
            <span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">188</span><span class="p">)</span>  

        <span class="c1"># Value for x-axis (change font size, name, and other things)</span>
        <span class="n">value_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">value_axis</span>
        <span class="n">tick_labels</span> <span class="o">=</span> <span class="n">value_axis</span><span class="o">.</span><span class="n">tick_labels</span>
        <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
        <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>

        <span class="n">value_axis</span><span class="o">.</span><span class="n">major_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">OUTSIDE</span>

        <span class="n">value_axis</span><span class="o">.</span><span class="n">has_major_gridlines</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">major_gridlines</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">dash_style</span> <span class="o">=</span> <span class="n">MSO_LINE</span><span class="o">.</span><span class="n">DASH</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">major_gridlines</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">maximum_scale</span> <span class="o">=</span> <span class="mi">100</span>

        <span class="n">category_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">category_axis</span>
        <span class="n">category_axis</span><span class="o">.</span><span class="n">major_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">NONE</span>
        <span class="n">category_labels</span> <span class="o">=</span> <span class="n">category_axis</span><span class="o">.</span><span class="n">tick_labels</span>
        <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">category_font_size</span>
        <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>
        <span class="n">category_labels</span><span class="o">.</span><span class="n">tickLblSkip</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># 2nd dataframe (nationally sample)</span>
        <span class="c1"># Get column names of dataframe</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name</span><span class="p">)</span>

        <span class="n">chart_data</span> <span class="o">=</span> <span class="n">ChartData</span><span class="p">()</span>
        <span class="n">chart_data</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">categories_column</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="c1"># Add data in each category</span>
        <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">):</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">):</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">):</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">):</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">5</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">7</span><span class="p">):</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">6</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">8</span><span class="p">):</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">7</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

        <span class="c1"># Add chart on slide</span>
        <span class="n">specs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">16.5</span><span class="p">),</span>
            <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">15.26</span><span class="p">),</span>
            <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">17.5</span><span class="p">),</span>
            <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="p">}</span>
    
        <span class="n">chart</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span>
            <span class="n">XL_CHART_TYPE</span><span class="o">.</span><span class="n">BAR_STACKED</span><span class="p">,</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">],</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">chart_data</span><span class="p">)</span><span class="o">.</span><span class="n">chart</span>

        <span class="n">series</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># If graphs for whole country are generated, set for bar with country with red color</span>
        <span class="c1"># else set to blue color (same color as title uses)</span>
        <span class="n">fill</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span>
        <span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
        <span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">173</span><span class="p">)</span>   

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">):</span>
            <span class="n">series</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span>
            <span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
            <span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">188</span><span class="p">)</span>  

        <span class="c1"># Value for x-axis (change font size, name, and other things)</span>
        <span class="n">value_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">value_axis</span>
        <span class="n">tick_labels</span> <span class="o">=</span> <span class="n">value_axis</span><span class="o">.</span><span class="n">tick_labels</span>
        <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
        <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>

        <span class="n">value_axis</span><span class="o">.</span><span class="n">major_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">OUTSIDE</span>

        <span class="n">value_axis</span><span class="o">.</span><span class="n">has_major_gridlines</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">major_gridlines</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">dash_style</span> <span class="o">=</span> <span class="n">MSO_LINE</span><span class="o">.</span><span class="n">DASH</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">major_gridlines</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">maximum_scale</span> <span class="o">=</span> <span class="mi">100</span>

        <span class="n">category_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">category_axis</span>
        <span class="n">category_axis</span><span class="o">.</span><span class="n">major_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">NONE</span>
        <span class="n">category_labels</span> <span class="o">=</span> <span class="n">category_axis</span><span class="o">.</span><span class="n">tick_labels</span>
        <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">category_font_size</span>
        <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>
        <span class="n">category_labels</span><span class="o">.</span><span class="n">tickLblSkip</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Set legend </span>
        <span class="n">chart</span><span class="o">.</span><span class="n">has_legend</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">XL_LEGEND_POSITION</span><span class="o">.</span><span class="n">BOTTOM</span>
        <span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">include_in_layout</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">180</span> <span class="ow">or</span> <span class="s1">&#39;antithrombotics prescribed&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
            <span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_grouped_barplot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate grouped barplot.&quot;&quot;&quot;</span>

        <span class="c1"># Calculate length of legend (in case that legend is too long, make smaller font size)</span>
        <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_length_of_legend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">)</span>

        <span class="c1"># Get column names of dataframe</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name</span><span class="p">)</span>
        
        <span class="c1"># Add new slide into presentation</span>
        <span class="n">slide</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">presentation</span><span class="o">.</span><span class="n">slides</span><span class="o">.</span><span class="n">add_slide</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">presentation</span><span class="o">.</span><span class="n">slide_layouts</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span>
        <span class="n">title_placeholders</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">title</span>
        <span class="n">title_placeholders</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtitle</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">placeholders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">sp</span> <span class="o">=</span> <span class="n">subtitle</span><span class="o">.</span><span class="n">element</span>
            <span class="n">sp</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">placeholders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">subtitle</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtitle</span>

        <span class="c1"># 1st dataframe (nationally sample)</span>
        <span class="n">chart_data</span> <span class="o">=</span> <span class="n">ChartData</span><span class="p">()</span>
        <span class="n">chart_data</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">categories_column</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="c1"># Add data in each category</span>
        <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

        <span class="c1"># Add chart on slide</span>
        <span class="n">specs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">16.5</span><span class="p">),</span>
            <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">15.26</span><span class="p">),</span>
            <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
            <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="p">}</span>
    
        <span class="n">chart</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span>
            <span class="n">XL_CHART_TYPE</span><span class="o">.</span><span class="n">BAR_CLUSTERED</span><span class="p">,</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">],</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">chart_data</span><span class="p">)</span><span class="o">.</span><span class="n">chart</span>

        <span class="n">series</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># If graphs for whole country are generated, set for bar with country with red color</span>
        <span class="c1"># else set to blue color (same color as title uses)</span>
        <span class="n">fill</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span>
        <span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
        <span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">173</span><span class="p">)</span>   

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">):</span>
            <span class="n">series</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span>
            <span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
            <span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">188</span><span class="p">)</span>  

        <span class="c1"># Value for x-axis (change font size, name, and other things)</span>
        <span class="n">value_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">value_axis</span>
        <span class="n">tick_labels</span> <span class="o">=</span> <span class="n">value_axis</span><span class="o">.</span><span class="n">tick_labels</span>
        <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
        <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>

        <span class="n">value_axis</span><span class="o">.</span><span class="n">major_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">OUTSIDE</span>

        <span class="n">value_axis</span><span class="o">.</span><span class="n">has_major_gridlines</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">major_gridlines</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">dash_style</span> <span class="o">=</span> <span class="n">MSO_LINE</span><span class="o">.</span><span class="n">DASH</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">major_gridlines</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">maximum_scale</span> <span class="o">=</span> <span class="mi">100</span>

        <span class="n">category_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">category_axis</span>
        <span class="n">category_axis</span><span class="o">.</span><span class="n">major_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">NONE</span>
        <span class="n">category_labels</span> <span class="o">=</span> <span class="n">category_axis</span><span class="o">.</span><span class="n">tick_labels</span>
        <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">category_font_size</span>
        <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>
        <span class="n">category_labels</span><span class="o">.</span><span class="n">tickLblSkip</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># 2nd dataframe (nationally sample)</span>
        <span class="c1"># Calculate length of legend (in case that legend is too long, make smaller font size)</span>
        <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_length_of_legend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">)</span>

        <span class="c1"># Get column names of dataframe</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_name</span><span class="p">)</span>

        <span class="n">chart_data</span> <span class="o">=</span> <span class="n">ChartData</span><span class="p">()</span>
        <span class="n">chart_data</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">categories_column</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="c1"># Add data in each category</span>
        <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sldf</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

        <span class="c1"># Add chart on slide</span>
        <span class="n">specs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">16.5</span><span class="p">),</span>
            <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">15.26</span><span class="p">),</span>
            <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">17.5</span><span class="p">),</span>
            <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="p">}</span>
    
        <span class="n">chart</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span>
            <span class="n">XL_CHART_TYPE</span><span class="o">.</span><span class="n">BAR_CLUSTERED</span><span class="p">,</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">],</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">chart_data</span><span class="p">)</span><span class="o">.</span><span class="n">chart</span>

        <span class="n">series</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># If graphs for whole country are generated, set for bar with country with red color</span>
        <span class="c1"># else set to blue color (same color as title uses)</span>
        <span class="n">fill</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span>
        <span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
        <span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">173</span><span class="p">)</span>   

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">):</span>
            <span class="n">series</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span>
            <span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
            <span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">188</span><span class="p">)</span>  

        <span class="c1"># Value for x-axis (change font size, name, and other things)</span>
        <span class="n">value_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">value_axis</span>
        <span class="n">tick_labels</span> <span class="o">=</span> <span class="n">value_axis</span><span class="o">.</span><span class="n">tick_labels</span>
        <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
        <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>

        <span class="n">value_axis</span><span class="o">.</span><span class="n">major_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">OUTSIDE</span>

        <span class="n">value_axis</span><span class="o">.</span><span class="n">has_major_gridlines</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">major_gridlines</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">dash_style</span> <span class="o">=</span> <span class="n">MSO_LINE</span><span class="o">.</span><span class="n">DASH</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">major_gridlines</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">value_axis</span><span class="o">.</span><span class="n">maximum_scale</span> <span class="o">=</span> <span class="mi">100</span>

        <span class="n">category_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">category_axis</span>
        <span class="n">category_axis</span><span class="o">.</span><span class="n">major_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">NONE</span>
        <span class="n">category_labels</span> <span class="o">=</span> <span class="n">category_axis</span><span class="o">.</span><span class="n">tick_labels</span>
        <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">category_font_size</span>
        <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>
        <span class="n">category_labels</span><span class="o">.</span><span class="n">tickLblSkip</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Set legend </span>
        <span class="n">chart</span><span class="o">.</span><span class="n">has_legend</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">XL_LEGEND_POSITION</span><span class="o">.</span><span class="n">BOTTOM</span>
        <span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">include_in_layout</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span></div>

<div class="viewcode-block" id="GenerateYearsCompPresentation"><a class="viewcode-back" href="../../source/resqdb.html#resqdb.GenerateComparisonPresentation.GenerateYearsCompPresentation">[docs]</a><span class="k">class</span> <span class="nc">GenerateYearsCompPresentation</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class takes as arguments one dataframe with values for each period in different lines and creates comparison graphs.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        df - dataframe containing data for different times of period in each line</span>
<span class="sd">        name - name of given period (e.g. all)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="c1"># Get absolute path to the database.</span>
        <span class="n">script_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span> <span class="c1">#&lt;-- absolute dir the script is in</span>
        <span class="c1">#filename = &quot;resq.db&quot;</span>
       <span class="c1"># self.abs_db_path = os.path.join(script_dir, &quot;database&quot;, filename)</span>

        <span class="n">master_pptx</span> <span class="o">=</span> <span class="s2">&quot;countries_comparison.pptx&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_dir</span><span class="p">,</span> <span class="s2">&quot;backgrounds&quot;</span><span class="p">,</span> <span class="n">master_pptx</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_generate_graphs</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_generate_graphs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate graphs into presentation (pptx).&quot;&quot;&quot;</span>

        <span class="n">prs</span> <span class="o">=</span> <span class="n">Presentation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>

        <span class="n">first_slide</span> <span class="o">=</span> <span class="n">prs</span><span class="o">.</span><span class="n">slides</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">first_slide</span><span class="o">.</span><span class="n">shapes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">text_frame</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">text_frame</span>

        <span class="n">first_slide_text</span> <span class="o">=</span> <span class="s2">&quot;Data Comparison&quot;</span>
    
        <span class="n">p</span> <span class="o">=</span> <span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">run</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
        <span class="n">run</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">first_slide_text</span>

        <span class="n">font</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">font</span>
        <span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Calibri Light&#39;</span>
        <span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span>
        <span class="n">font</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span><span class="mi">250</span><span class="p">,</span><span class="mi">250</span><span class="p">)</span>

        <span class="c1"># if (self.country_name in [&#39;Ukraine&#39;, &#39;Poland&#39;] and len(df) &gt; 2):</span>
        <span class="c1">#     main_col = &#39;Site ID&#39;</span>
        <span class="c1"># else:</span>
        <span class="n">main_col</span> <span class="o">=</span> <span class="s1">&#39;Site Name&#39;</span>

        <span class="c1"># main_col = &quot;Site Name&quot;</span>
        <span class="n">years</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">main_col</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Temporal trends - </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>

        <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">graph_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Total patients and median age graphst)</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Total Patients&#39;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Total Patients&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median patient age&#39;</span>
        <span class="n">df1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Median patient age&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>
        
        <span class="n">GenerateYearsCompGraphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">df1</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="n">titles</span><span class="p">,</span> <span class="n">graph_types</span><span class="o">=</span><span class="n">graph_types</span><span class="p">)</span>

        <span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">graph_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">### DEPARTMENT TYPE ###</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;neurology&#39;</span><span class="p">,</span> <span class="s1">&#39;neurosurgery&#39;</span><span class="p">,</span> <span class="s1">&#39;anesthesiology resuscitation critical care&#39;</span><span class="p">,</span> <span class="s1">&#39;internal medicine&#39;</span><span class="p">,</span> <span class="s1">&#39;geriatrics&#39;</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Department type (%)&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;stacked&quot;</span><span class="p">)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - neurology&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - neurosurgery&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - anesthesiology/resuscitation/critical care&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - internal medicine&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - geriatrics&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">epartment type - Other&#39;</span><span class="p">]]</span>

        <span class="c1">### HOSPITALIZATION DESTINATION ###</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;stroke unit&#39;</span><span class="p">,</span> <span class="s1">&#39;monitored bed with telemetry&#39;</span><span class="p">,</span> <span class="s1">&#39;standard bed&#39;</span><span class="p">]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Hospitalization type (%)&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;stacked&quot;</span><span class="p">)</span>

        <span class="n">df1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in stroke unit / ICU&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in monitored bed with telemetry&#39;</span><span class="p">,</span> <span class="s1">&#39;% patients hospitalized in standard bed&#39;</span><span class="p">]]</span>
   
        <span class="c1">### REHABILIATION ###</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients assessed for rehabilitation - Yes&#39;</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Assessed for rehabilitation (%)&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="n">GenerateYearsCompGraphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">df1</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="n">titles</span><span class="p">,</span> <span class="n">graph_types</span><span class="o">=</span><span class="n">graph_types</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="n">legends</span><span class="p">)</span>

        <span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">graph_types</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># STROKE TYPE #</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ischemic&#39;</span><span class="p">,</span> <span class="s1">&#39;transient ischemic attack&#39;</span><span class="p">,</span> <span class="s1">&#39;intracerebral hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;subarrachnoid hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;cerebral venous thrombosis&#39;</span><span class="p">,</span> <span class="s1">&#39;undetermined&#39;</span><span class="p">]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Stroke type (%)&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;stacked&quot;</span><span class="p">)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - ischemic stroke&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - transient ischemic attack&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - intracerebral hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - subarrachnoid hemorrhage&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - cerebral venous thrombosis&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% s</span><span class="s1">troke type - undetermined stroke&#39;</span><span class="p">]]</span>

        <span class="c1"># CT/MRI performed #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% CT/MRI - performed&#39;</span>
        <span class="n">df1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CT/MRI (%)&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="c1"># patients recanalized</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients recanalized&#39;</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% patients recanalized&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="n">GenerateYearsCompGraphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">df1</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="n">titles</span><span class="p">,</span> <span class="n">graph_types</span><span class="o">=</span><span class="n">graph_types</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="n">legends</span><span class="p">)</span>

        <span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">graph_types</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># RECANALIZATION PROCEDURES #</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IV tPa&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;IV tPa + another centre for endovascular treatment&#39;</span><span class="p">]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Recanalization procedures (%)&quot;</span><span class="p">)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + endovascular treatment&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - Endovascular treatment alone&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecanalization procedures - IV tPa + referred to another centre for endovascular treatment&#39;</span><span class="p">]]</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;stacked&quot;</span><span class="p">)</span>

        <span class="c1"># MEDIAN DTN #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median DTN (minutes)&#39;</span>
        <span class="n">df1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Median DTN (minutes)&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="c1"># MEDIAN DTN #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;Median DTG (minutes)&#39;</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Median DTG (minutes)&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="n">GenerateYearsCompGraphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">df1</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="n">titles</span><span class="p">,</span> <span class="n">graph_types</span><span class="o">=</span><span class="n">graph_types</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="n">legends</span><span class="p">)</span>

        <span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">graph_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># DYSPHAGIA SCREENING #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Guss test&#39;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GUSS test&#39;</span><span class="p">,</span> <span class="s1">&#39;Other test&#39;</span><span class="p">,</span> <span class="s1">&#39;Another centre&#39;</span><span class="p">]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Dysphagia screening (%)&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;stacked&quot;</span><span class="p">)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Guss test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Other test&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">% d</span><span class="s1">ysphagia screening - Another centre&#39;</span><span class="p">]]</span>

        <span class="c1"># CAROTID ARTERIES IMAGING #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% c</span><span class="s1">arotid arteries imaging - Yes&#39;</span>
        <span class="n">df1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Carotid arteries imaging (%)&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="c1"># % RECOMMENDED TO A CEREBROVASCULAR EXPERT - RECOMMENDED #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">% r</span><span class="s1">ecommended to a cerebrovascular expert - Recommended&#39;</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Recommended to a cerebrovascular </span><span class="se">\n</span><span class="s2">expert (%)&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="n">GenerateYearsCompGraphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">df1</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="n">titles</span><span class="p">,</span> <span class="n">graph_types</span><span class="o">=</span><span class="n">graph_types</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="n">legends</span><span class="p">)</span>

        <span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">graph_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># PRESCRIBED ANTIPLATELETS #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed antiplatelets without aFib&#39;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% patients prescribed antiplatelets without aFib&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="c1"># % PATIENTS PRESCRIBED ANTICOAGULANTS WITH AFIB #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed anticoagulants with aFib&#39;</span>
        <span class="n">df1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% patients prescribed anticoagulants with aFib&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="c1">#  % PATIENTS PRESCRIBED ANTITHROMBOTICS WITH AFIB  #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed antithrombotics with aFib&#39;</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% patients prescribed antithrombotics with aFib&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="c1"># % PATIENTS PRESCRIBED ANTICOAGULANTS WITH AFIB (HOME) #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% afib patients discharged home with anticoagulants&#39;</span>
        <span class="n">df3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% aFib patients discharged home with anticoagulants&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="n">GenerateYearsCompGraphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">df1</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="o">=</span><span class="n">df3</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="n">titles</span><span class="p">,</span> <span class="n">graph_types</span><span class="o">=</span><span class="n">graph_types</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="n">legends</span><span class="p">)</span>

        <span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">graph_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># DISCHARGE WITH STATINS #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% patients prescribed statins - Yes&#39;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% patients prescribed statins&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="c1"># % PATIENTS PRESCRIBED ANTICOAGULANTS WITH AFIB #</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;% prescribed antihypertensives - Yes&#39;</span>
        <span class="n">df1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="n">main_col</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;% patients prescribed antihypertensives&quot;</span><span class="p">)</span>
        <span class="n">graph_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="n">GenerateYearsCompGraphs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">df1</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">presentation</span><span class="o">=</span><span class="n">prs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="n">titles</span><span class="p">,</span> <span class="n">graph_types</span><span class="o">=</span><span class="n">graph_types</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="n">legends</span><span class="p">)</span>

        <span class="c1"># set pptx output name (for cz it&#39;ll be presentation_CZ.pptx)</span>
        <span class="n">working_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="n">pptx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;.pptx&quot;</span>
        <span class="n">presentation_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span> <span class="n">pptx</span><span class="p">))</span>

        <span class="n">prs</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">presentation_path</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenerateYearsCompGraphs"><a class="viewcode-back" href="../../source/resqdb.html#resqdb.GenerateComparisonPresentation.GenerateYearsCompGraphs">[docs]</a><span class="k">class</span> <span class="nc">GenerateYearsCompGraphs</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function generates graphs into given presentation for country per years (e.g. 2016, 2017, 2018).   </span>

<span class="sd">    Arguments:</span>
<span class="sd">        presentation - opened presentation document</span>
<span class="sd">        df - dataframe containing statistics, each period is one line</span>
<span class="sd">        df1 - dataframe containing statistics, each period is one line (used when we want more than one graph on one slide) (default = None)</span>
<span class="sd">        df2 - dataframe containing statistics, each period is one line (used when we want more than two graphs on one slide) (default = None)</span>
<span class="sd">        df3 - dataframe containing statistics, each period is one line (used when we want more than three graphs on one slide) (default = None)</span>
<span class="sd">        title - the title of slide</span>
<span class="sd">        titles - list of graph names (default = None)</span>
<span class="sd">        graph_types - set type of graphs - normal barplot, stacked or grouped (default = None)</span>
<span class="sd">        legends - inner list of legend names (default = None) </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">presentation</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">df1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">graph_types</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="p">[],</span> <span class="n">outcome</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df3</span> <span class="o">=</span> <span class="n">df3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">presentation</span> <span class="o">=</span> <span class="n">presentation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">titles</span> <span class="o">=</span> <span class="n">titles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legends</span> <span class="o">=</span> <span class="n">legends</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_graphs</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph_types</span> <span class="o">=</span> <span class="n">graph_types</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span> <span class="o">=</span> <span class="s1">&#39;Century Gothic&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">category_font_size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_label_font_size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">outcome</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">categories_column</span> <span class="o">=</span> <span class="s1">&#39;Patient Group&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">categories_column</span> <span class="o">=</span> <span class="s1">&#39;Site Name&#39;</span>

        <span class="k">if</span> <span class="n">df1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num_graphs</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">df2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num_graphs</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">df3</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num_graphs</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Add slide to presentation (layout 11 is our custom layout where only title &#39;Agency FB&#39;, color: RGBColor(43, 88, 173)  and size:24 is set)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slide</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">presentation</span><span class="o">.</span><span class="n">slides</span><span class="o">.</span><span class="n">add_slide</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">presentation</span><span class="o">.</span><span class="n">slide_layouts</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span>
        <span class="c1"># Get title object</span>
        <span class="n">title_placeholders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">title</span>
        <span class="c1"># Set title</span>
        <span class="n">title_placeholders</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

        <span class="n">subtitle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slide</span><span class="o">.</span><span class="n">placeholders</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">sp</span> <span class="o">=</span> <span class="n">subtitle</span><span class="o">.</span><span class="n">element</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">colors</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">173</span><span class="p">),</span>
                <span class="s1">&#39;violet&#39;</span><span class="p">:</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">76</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">127</span><span class="p">),</span>
                <span class="s1">&#39;orange&#39;</span><span class="p">:</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">237</span><span class="p">,</span> <span class="mi">145</span><span class="p">,</span> <span class="mi">49</span><span class="p">),</span>
                <span class="s1">&#39;green&#39;</span><span class="p">:</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">146</span><span class="p">,</span> <span class="mi">208</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span>
               <span class="c1"># &#39;dark_blue&#39;: RGBColor(37, 94, 145),</span>
                <span class="s1">&#39;yellow&#39;</span><span class="p">:</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="s1">&#39;grey&#39;</span><span class="p">:</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">165</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">165</span><span class="p">)</span>
            <span class="p">}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_graphs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">outcome</span><span class="p">:</span>
                <span class="c1"># Add chart on slide</span>
                <span class="n">specs</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">16.5</span><span class="p">),</span>
                    <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span>
                    <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
                    <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                <span class="p">}</span> 
            <span class="k">else</span><span class="p">:</span>
                <span class="n">specs</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">16.5</span><span class="p">),</span>
                    <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span>
                    <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">0.7</span><span class="p">),</span>
                    <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_plot</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">titles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">specs</span><span class="o">=</span><span class="n">specs</span><span class="p">,</span> <span class="n">graph_type</span><span class="o">=</span><span class="n">graph_types</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ix</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># If number of graph is equal to 1 (2 graphs on one slide) set specs that each graph will be on one half of slide page</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_graphs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Add chart on slide</span>
            <span class="n">specs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">16.5</span><span class="p">),</span>
                <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">15.26</span><span class="p">),</span>
                <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
                <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="p">}</span> 

            <span class="c1"># Add chart on slide</span>
            <span class="n">specs1</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">16.5</span><span class="p">),</span>
                <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">15.26</span><span class="p">),</span>
                <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">17.5</span><span class="p">),</span>
                <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="p">}</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_create_plot</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">titles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">specs</span><span class="o">=</span><span class="n">specs</span><span class="p">,</span> <span class="n">graph_type</span><span class="o">=</span><span class="n">graph_types</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ix</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_plot</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">titles</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">specs</span><span class="o">=</span><span class="n">specs1</span><span class="p">,</span> <span class="n">graph_type</span><span class="o">=</span><span class="n">graph_types</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ix</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># If number of graph is equal to 2 (3 graphs on one slide) set specs that one graph will be on half of page, and two graphs on second half</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_graphs</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># Add chart on slide</span>
            <span class="n">specs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">16.5</span><span class="p">),</span>
                <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">15.26</span><span class="p">),</span>
                <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
                <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="p">}</span> 
            <span class="c1"># Add chart on slide</span>
            <span class="n">specs1</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">8.25</span><span class="p">),</span>
                <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">15.26</span><span class="p">),</span>
                <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">17.5</span><span class="p">),</span>
                <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="c1"># Add chart on slide</span>
            <span class="n">specs2</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">8.25</span><span class="p">),</span>
                <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">15.26</span><span class="p">),</span>
                <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">17.5</span><span class="p">),</span>
                <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">10.25</span><span class="p">)</span>
            <span class="p">}</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_create_plot</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">titles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">specs</span><span class="o">=</span><span class="n">specs</span><span class="p">,</span> <span class="n">graph_type</span><span class="o">=</span><span class="n">graph_types</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ix</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_plot</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">titles</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">specs</span><span class="o">=</span><span class="n">specs1</span><span class="p">,</span> <span class="n">graph_type</span><span class="o">=</span><span class="n">graph_types</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ix</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_plot</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">titles</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">specs</span><span class="o">=</span><span class="n">specs2</span><span class="p">,</span> <span class="n">graph_type</span><span class="o">=</span><span class="n">graph_types</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ix</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># If number of graph is equal to 3 (4 graphs on one slide) set specs that each graph will be put on quarter of page</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_graphs</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c1"># Add chart on slide</span>
            <span class="n">specs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">8.25</span><span class="p">),</span>
                <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">15.26</span><span class="p">),</span>
                <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
                <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="p">}</span> 
            <span class="n">specs1</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">8.25</span><span class="p">),</span>
                <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">15.26</span><span class="p">),</span>
                <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
                <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">10.25</span><span class="p">)</span>
            <span class="p">}</span> 
            <span class="c1"># Add chart on slide</span>
            <span class="n">specs2</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">8.25</span><span class="p">),</span>
                <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">15.26</span><span class="p">),</span>
                <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">17.5</span><span class="p">),</span>
                <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="c1"># Add chart on slide</span>
            <span class="n">specs3</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">8.25</span><span class="p">),</span>
                <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">15.26</span><span class="p">),</span>
                <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">17.5</span><span class="p">),</span>
                <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">10.25</span><span class="p">)</span>
            <span class="p">}</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_plot</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">titles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">specs</span><span class="o">=</span><span class="n">specs</span><span class="p">,</span> <span class="n">graph_type</span><span class="o">=</span><span class="n">graph_types</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ix</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_plot</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">titles</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">specs</span><span class="o">=</span><span class="n">specs1</span><span class="p">,</span> <span class="n">graph_type</span><span class="o">=</span><span class="n">graph_types</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ix</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_plot</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">titles</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">specs</span><span class="o">=</span><span class="n">specs2</span><span class="p">,</span> <span class="n">graph_type</span><span class="o">=</span><span class="n">graph_types</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ix</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_plot</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df3</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">titles</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">specs</span><span class="o">=</span><span class="n">specs3</span><span class="p">,</span> <span class="n">graph_type</span><span class="o">=</span><span class="n">graph_types</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">ix</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">_set_transparency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transparency</span><span class="p">,</span> <span class="n">elm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set tranparency of element. </span>

<span class="sd">        Args: </span>
<span class="sd">            transparency: transparency in % </span>
<span class="sd">            elm: element to be changed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">transparency</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;196&#39;</span>
        
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">OxmlElement</span><span class="p">(</span><span class="s1">&#39;a:alpha&#39;</span><span class="p">)</span>
        <span class="n">alpha</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
        <span class="n">elm</span><span class="o">.</span><span class="n">srgbClr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">graph_type</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ix</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>   
        <span class="sd">&quot;&quot;&quot;Create normal barplot.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">graph_type</span> <span class="o">==</span> <span class="s2">&quot;normal&quot;</span><span class="p">:</span>
            <span class="c1"># Get column names of dataframe</span>
            <span class="n">column_names</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories_column</span><span class="p">)</span>   

            <span class="c1"># 1st chart (left side) - nationally sample</span>
            <span class="n">chart_data</span> <span class="o">=</span> <span class="n">ChartData</span><span class="p">()</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">categories_column</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

            <span class="n">chart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span>
                <span class="n">XL_CHART_TYPE</span><span class="o">.</span><span class="n">COLUMN_CLUSTERED</span><span class="p">,</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">],</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">chart_data</span><span class="p">)</span><span class="o">.</span><span class="n">chart</span>

            <span class="c1"># Get series of chart</span>
            <span class="n">series</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">series</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
            <span class="n">series</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">]</span>
            <span class="n">series</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
            <span class="n">series</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;orange&#39;</span><span class="p">]</span>
            <span class="n">series</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
            <span class="n">series</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">]</span>
            
            <span class="c1"># Get plot </span>
            <span class="n">plot</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># Set for each bar same color</span>
            <span class="n">plot</span><span class="o">.</span><span class="n">vary_by_categories</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1"># Show data labels and set font</span>
            <span class="n">plot</span><span class="o">.</span><span class="n">has_data_labels</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">data_labels</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">data_labels</span>
            <span class="n">data_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_label_font_size</span>
            <span class="n">data_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">bold</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">data_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>

            <span class="n">chart_text</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">chart_title</span><span class="o">.</span><span class="n">text_frame</span>
            <span class="n">chart_text</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">title</span>
            <span class="n">chart_text</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>
            <span class="n">chart_text</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
            <span class="n">chart_text</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">89</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">89</span><span class="p">)</span>

            <span class="c1"># Value for x-axis (change font size, name, and other things)</span>
            <span class="n">value_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">value_axis</span>
            <span class="n">tick_labels</span> <span class="o">=</span> <span class="n">value_axis</span><span class="o">.</span><span class="n">tick_labels</span>
            <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">category_font_size</span>
            <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>

            <span class="c1"># Don&#39;t show major gridlines</span>
            <span class="c1">#value_axis.major_tick_mark = XL_TICK_MARK.OUTSIDE</span>
            <span class="n">value_axis</span><span class="o">.</span><span class="n">has_major_gridlines</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">value_axis</span><span class="o">.</span><span class="n">major_gridlines</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">217</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">217</span><span class="p">)</span>
            <span class="n">value_axis</span><span class="o">.</span><span class="n">major_gridlines</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="c1"># Set range of axis</span>
            <span class="n">value_axis</span><span class="o">.</span><span class="n">minimum_scale</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">max_value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;%&#39;</span> <span class="ow">in</span> <span class="n">title</span> <span class="ow">and</span> <span class="n">max_value</span> <span class="o">&gt;=</span> <span class="mi">90</span><span class="p">:</span>
                <span class="n">value_axis</span><span class="o">.</span><span class="n">maximum_scale</span> <span class="o">=</span> <span class="mi">100</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value_axis</span><span class="o">.</span><span class="n">maximum_scale</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">max_value</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>
            <span class="n">value_axis</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="c1"># Value for y-axis (change font size, name, and other things)</span>
            <span class="n">category_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">category_axis</span>
            <span class="c1"># Delete tick marks</span>
            <span class="n">category_axis</span><span class="o">.</span><span class="n">major_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">NONE</span>
            <span class="n">category_axis</span><span class="o">.</span><span class="n">major_unit</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">category_labels</span> <span class="o">=</span> <span class="n">category_axis</span><span class="o">.</span><span class="n">tick_labels</span>
            <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">category_font_size</span>
            <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>

        <span class="c1"># Create stacked barplot</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="c1"># Get column names of dataframe</span>
            <span class="n">column_names</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">column_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories_column</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="n">legend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">legends</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
            <span class="n">number_of_series</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>

            <span class="c1"># 1st dataframe (nationally sample)</span>
            <span class="n">chart_data</span> <span class="o">=</span> <span class="n">ChartData</span><span class="p">()</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">categories_column</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="c1"># Add data in each category</span>
            <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="n">legend</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="n">legend</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">):</span>
                <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="n">legend</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">):</span>
                <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="n">legend</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">):</span>
                <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="n">legend</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">):</span>
                <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="n">legend</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">5</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">7</span><span class="p">):</span>
                <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="n">legend</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">6</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">8</span><span class="p">):</span>
                <span class="n">chart_data</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span><span class="n">legend</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">7</span><span class="p">]]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

            <span class="n">chart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span>
                <span class="n">XL_CHART_TYPE</span><span class="o">.</span><span class="n">COLUMN_STACKED</span><span class="p">,</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">],</span> <span class="n">specs</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">chart_data</span><span class="p">)</span><span class="o">.</span><span class="n">chart</span>

            <span class="n">series</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># Get series of chart</span>
            <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
            <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
                <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;orange&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">):</span>
                <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
                <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">):</span>
                <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
                <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;grey&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">):</span>
                <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
                <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;violet&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">number_of_series</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">):</span>
                <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
                <span class="n">chart</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">]</span>

            <span class="c1"># Value for x-axis (change font size, name, and other things)</span>
            <span class="n">value_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">value_axis</span>
            <span class="n">tick_labels</span> <span class="o">=</span> <span class="n">value_axis</span><span class="o">.</span><span class="n">tick_labels</span>
            <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
            <span class="n">tick_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>

            <span class="n">value_axis</span><span class="o">.</span><span class="n">major_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">OUTSIDE</span>

            <span class="c1"># Don&#39;t show major gridlines</span>
            <span class="c1">#value_axis.major_tick_mark = XL_TICK_MARK.OUTSIDE</span>
            <span class="n">value_axis</span><span class="o">.</span><span class="n">has_major_gridlines</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">value_axis</span><span class="o">.</span><span class="n">major_gridlines</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">217</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">217</span><span class="p">)</span>
            <span class="n">value_axis</span><span class="o">.</span><span class="n">major_gridlines</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="c1"># Set range of axis</span>
            <span class="n">value_axis</span><span class="o">.</span><span class="n">minimum_scale</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">value_axis</span><span class="o">.</span><span class="n">maximum_scale</span> <span class="o">=</span> <span class="mi">100</span>
            <span class="n">value_axis</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span>

             <span class="c1"># Set 100% transparency to value axis</span>
            <span class="n">value_axis</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">solidFill</span> <span class="o">=</span> <span class="n">value_axis</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">_xFill</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_transparency</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">solidFill</span><span class="p">)</span>


            <span class="n">category_axis</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">category_axis</span>
            <span class="n">category_axis</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">solidFill</span> <span class="o">=</span> <span class="n">category_axis</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">_xFill</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_transparency</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">solidFill</span><span class="p">)</span>
            
            <span class="n">category_axis</span><span class="o">.</span><span class="n">major_tick_mark</span> <span class="o">=</span> <span class="n">XL_TICK_MARK</span><span class="o">.</span><span class="n">NONE</span>
            <span class="n">category_labels</span> <span class="o">=</span> <span class="n">category_axis</span><span class="o">.</span><span class="n">tick_labels</span>
            <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">category_font_size</span>
            <span class="n">category_labels</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>
            <span class="n">category_labels</span><span class="o">.</span><span class="n">tickLblSkip</span> <span class="o">=</span> <span class="mi">1</span>

            

        
            <span class="c1"># Set legend </span>
            <span class="n">chart</span><span class="o">.</span><span class="n">has_legend</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">XL_LEGEND_POSITION</span><span class="o">.</span><span class="n">BOTTOM</span>
            <span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">include_in_layout</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_name</span>
            <span class="n">chart</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>

            <span class="n">chart_text</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">chart_title</span><span class="o">.</span><span class="n">text_frame</span>
            <span class="n">chart_text</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">title</span>
            <span class="n">chart_text</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
            <span class="n">chart_text</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">89</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">89</span><span class="p">)</span></div>

        


</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">RES-Q package</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Marie Jankujova.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
    </div>

    

    
  </body>
</html>